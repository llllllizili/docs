import{_ as s,c as a,o as n,f as i}from"./app-BfCDUtKQ.js";const l={},e=i(`<h1 id="" tabindex="-1"><a class="header-anchor" href="#"><span></span></a></h1><blockquote><p>RPM（Redhat Package Manager）是用于Redhat、CentOS、Fedora等Linux 分发版（distribution）的常见的软件包管理器。因为它允许分发已编译的软件，所以用户只用一个命令就可以安装软件.</p></blockquote><h2 id="安装" tabindex="-1"><a class="header-anchor" href="#安装"><span>安装</span></a></h2><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>yum install rpm-build</span></span>
<span class="line"><span>yum install rpmdevtools</span></span></code></pre></div><h2 id="使用" tabindex="-1"><a class="header-anchor" href="#使用"><span>使用</span></a></h2><p><code>rpmdev-setuptree</code>命令，可在<code>$HOME</code>下生产一个标注的工作空间<code>rpmbuild</code></p><p>结构如下</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">$</span><span style="color:#98C379;--shiki-dark:#98C379;"> tree</span><span style="color:#98C379;--shiki-dark:#98C379;"> rpmbuild</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rpmbuild</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> BUILD</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> RPMS</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> SOURCES</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">├──</span><span style="color:#98C379;--shiki-dark:#98C379;"> SPECS</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">└──</span><span style="color:#98C379;--shiki-dark:#98C379;"> SRPMS</span></span></code></pre></div><p>如果未安装<code>rpmdevtools</code> 手动创建也是可以的</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mkdir</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> ~/rpmbuild/{BUILD,RPMS,SOURCES,SPECS,SRPMS}\`</span></span></code></pre></div><h2 id="目录" tabindex="-1"><a class="header-anchor" href="#目录"><span>目录</span></a></h2><table><thead><tr><th>目录名</th><th>说明</th><th>macros中的宏名</th></tr></thead><tbody><tr><td>~/rpmbuild/</td><td>rpmbuild文件夹</td><td>%_topdir</td></tr><tr><td>~/rpmbuild/BUILD</td><td>编译rpm包的临时目录</td><td>%_builddir</td></tr><tr><td>~/rpmbuild/BUILDROOT</td><td>编译后生成的软件临时安装目录</td><td>%_buildrootdir</td></tr><tr><td>~/rpmbuild/RPMS</td><td>最终生成的可安装rpm包的所在目录</td><td>%_rpmdir</td></tr><tr><td>~/rpmbuild/SOURCES</td><td>所有源代码和补丁文件的存放目录</td><td>%_sourcedir</td></tr><tr><td>~/rpmbuild/SPECS</td><td>存放SPEC文件的目录(重要)</td><td>%_specdir</td></tr><tr><td>~/rpmbuild/SRPMS</td><td>软件最终的rpm源码格式存放路径(暂时忽略掉，别挂在心上)</td><td>%_srcrpmdir</td></tr></tbody></table><h2 id="流程" tabindex="-1"><a class="header-anchor" href="#流程"><span>流程</span></a></h2><ol><li><p>源代码放在<code>%_sourcedir</code>下,一般是<code>.tar.gz</code>之类,或文件</p></li><li><p>编译,在<code>%_builddir</code>中进行,源码包解压后复制到此目录即可</p></li><li><p>安装,把软件包应该包含的内容（比如二进制文件、配置文件、man文档等）复制到<code>%_buildrootdir</code>中，并按照实际安装后的目录结构组装，比如二进制命令可能会放在<code>/usr/bin</code>下，那么就在<code>%_buildrootdir</code>下也按照同样的目录结构放置</p></li><li><p>配置,安装前,中,后,的一些工作,以及卸载前的工作.</p></li><li><p>检测,软件是否正常运行. 可选</p></li><li><p>生成rpm包,放到<code>%_rpmdir</code>下</p></li></ol><p>以上流程均是通过编写SPEC文件进行操作.</p><table><thead><tr><th>阶段</th><th>读取的目录</th><th>写入的目录</th><th>具体动作</th></tr></thead><tbody><tr><td>%prep</td><td>%_sourcedir</td><td>%_builddir</td><td>读取位于 %_sourcedir 目录的源代码和 patch 。之后，解压源代码至 %_builddir 的子目录并应用所有 patch</td></tr><tr><td>%build</td><td>%_builddir</td><td>%_builddir</td><td>编译位于 %_builddir 构建目录下的文件。通过执行类似 ./configure &amp;&amp; make 的命令实现</td></tr><tr><td>%install</td><td>%_builddir</td><td>%_buildrootdir</td><td>读取位于 %_builddir 构建目录下的文件并将其安装至 %_buildrootdir 目录。这些文件就是用户安装 RPM 后，最终得到的文件。注意一个奇怪的地方: 最终安装目录 不是 构建目录。通过执行类似 make install 的命令实现</td></tr><tr><td>%check</td><td>%_builddir</td><td>%_builddir</td><td>检查软件是否正常运行。通过执行类似 make test 的命令实现。很多软件包都不需要此步。</td></tr><tr><td>bin</td><td>%_buildrootdir</td><td>%_rpmdir</td><td>读取位于 %_buildrootdir 最终安装目录下的文件，以便最终在 %_rpmdir 目录下创建 RPM 包。在该目录下，不同架构的 RPM 包会分别保存至不同子目录， noarch 目录保存适用于所有架构的 RPM 包。这些 RPM 文件就是用户最终安装的 RPM 包。</td></tr><tr><td>src</td><td>%_sourcedir</td><td>%_srcrpmdir</td><td>创建源码 RPM 包（简称 SRPM，以.src.rpm 作为后缀名），并保存至 %_srcrpmdir 目录。SRPM 包通常用于审核和升级软件包。</td></tr></tbody></table><h2 id="spec" tabindex="-1"><a class="header-anchor" href="#spec"><span>SPEC</span></a></h2><p>zabbix agentd rpm包构建参考</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%define</span><span style="color:#98C379;--shiki-dark:#98C379;"> zabbix_user</span><span style="color:#98C379;--shiki-dark:#98C379;"> zabbix</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                  </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#自定义宏，名字为zabbix_user值为zabbix,%{zabbix_user}引用</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Name:</span><span style="color:#98C379;--shiki-dark:#98C379;">   zabbix</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                              </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#软件包的名字，后面可用%{name}引用</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Version:</span><span style="color:#D19A66;--shiki-dark:#D19A66;">    3.0.14</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                           </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#软件的实际版本号，可使用%{version}引用</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Release:</span><span style="color:#98C379;--shiki-dark:#98C379;">    1%{?dist}</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                       </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#发布序列号，标明第几次打包  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Summary:</span><span style="color:#98C379;--shiki-dark:#98C379;">    zabbix_agentd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                   </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#软件包内容概要</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Group:</span><span style="color:#98C379;--shiki-dark:#98C379;">      zabbix</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                          </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#软件包分组</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">License:</span><span style="color:#98C379;--shiki-dark:#98C379;">    GPL</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#授权许可方式</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">URL:</span><span style="color:#98C379;--shiki-dark:#98C379;">        blog.dl1548.com</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#软件的主页</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#源代码包，可以有Source0,Source1等源,对应%install下</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Source0:</span><span style="color:#98C379;--shiki-dark:#98C379;">    zabbix-3.0.14.tar.gz</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Source1:</span><span style="color:#98C379;--shiki-dark:#98C379;">    discover_disk.pl</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Source2:</span><span style="color:#98C379;--shiki-dark:#98C379;">    tcp_conn_status.sh</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Source3:</span><span style="color:#98C379;--shiki-dark:#98C379;">    zbx_parse_iostat_values.sh</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Source4:</span><span style="color:#98C379;--shiki-dark:#98C379;">    tcp-status-params.conf</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Source5:</span><span style="color:#98C379;--shiki-dark:#98C379;">    zbx_parse_iostat_values.conf</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">BuildRequires:</span><span style="color:#98C379;--shiki-dark:#98C379;">      net-tools</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#gcc, gcc-c++            </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#制作rpm包时，所依赖的基本库</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Requires:</span><span style="color:#98C379;--shiki-dark:#98C379;">      net-tools</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#gcc, gcc-c++       </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#安装rpm包时，所依赖的软件包</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#BuildRoot: %{_tmpdir}/%{name}-%{version}-%{release}</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#构建包的临时文件路径.centos5 不写会报错</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%description</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                                </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#定义rpm包的描述信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Zabbix</span><span style="color:#98C379;--shiki-dark:#98C379;"> agentd</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">creata</span><span style="color:#98C379;--shiki-dark:#98C379;"> by</span><span style="color:#98C379;--shiki-dark:#98C379;"> jingkunsystem-lizili</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%pre</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                                        </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#rpm包安装前执行的脚本</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> zabbix</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc/passwd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">/dev/null</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$?</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> !=</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ] </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> useradd</span><span style="color:#98C379;--shiki-dark:#98C379;"> zabbix</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -M</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> /sbin/nologin</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">fi</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[ </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-d</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> /usr/local/zabbix ]||</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -rf</span><span style="color:#98C379;--shiki-dark:#98C379;"> /usr/local/zabbix</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">*</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -rf</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc/zabbix</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">*</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%post</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                                       </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#rpm包安装后执行的脚本</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;/BASEDIR=\\/usr\\/local/c\\BASEDIR=\\/usr\\/local\\/%{name}&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc/init.d/zabbix_agentd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%preun</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                                      </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#rpm卸载前执行的脚本</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/etc/init.d/zabbix_agentd</span><span style="color:#98C379;--shiki-dark:#98C379;"> stop</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%postun</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                                     </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#rpm卸载后执行的脚本</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">userdel</span><span style="color:#98C379;--shiki-dark:#98C379;">  zabbix</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -rf</span><span style="color:#98C379;--shiki-dark:#98C379;"> /usr/local/zabbix</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">*</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%prep</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%setup</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -q</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                                   </span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%build</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                                      </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#定义编译软件包时的操作</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">./configure</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --prefix=/usr/local/%</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">name}</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  --enable-agent</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">make</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j8</span><span style="color:#98C379;--shiki-dark:#98C379;"> %{?_smp_mflags}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%install</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                                    </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#定义安装软件包，使用默认值即可</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">test</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -L</span><span style="color:#98C379;--shiki-dark:#98C379;"> %{buildroot}/usr/local/%{name}</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &amp;&amp; </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -f</span><span style="color:#98C379;--shiki-dark:#98C379;"> %{buildroot}/usr/local/%{name}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">install</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> %{buildroot}/etc/profile.d</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">install</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> %{buildroot}/etc/init.d</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">make</span><span style="color:#98C379;--shiki-dark:#98C379;"> install</span><span style="color:#98C379;--shiki-dark:#98C379;"> DESTDIR=%{buildroot}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#其他脚本</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">install</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -D</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -m</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0755</span><span style="color:#98C379;--shiki-dark:#98C379;"> %{SOURCE1}</span><span style="color:#98C379;--shiki-dark:#98C379;">        %{buildroot}/usr/local/%{name}/lib/discover_disk.pl</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">install</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -D</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -m</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0755</span><span style="color:#98C379;--shiki-dark:#98C379;"> %{SOURCE2}</span><span style="color:#98C379;--shiki-dark:#98C379;">        %{buildroot}/usr/local/%{name}/lib/tcp_conn_status.sh</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">install</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -D</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -m</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0755</span><span style="color:#98C379;--shiki-dark:#98C379;"> %{SOURCE3}</span><span style="color:#98C379;--shiki-dark:#98C379;">        %{buildroot}/usr/local/%{name}/lib/zbx_parse_iostat_values.sh</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#其他配置文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">install</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -D</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -m</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0755</span><span style="color:#98C379;--shiki-dark:#98C379;"> %{SOURCE4}</span><span style="color:#98C379;--shiki-dark:#98C379;">        %{buildroot}/usr/local/%{name}/etc/zabbix_agentd.conf.d/tcp-status-params.conf</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">install</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -D</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -m</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0755</span><span style="color:#98C379;--shiki-dark:#98C379;"> %{SOURCE5}</span><span style="color:#98C379;--shiki-dark:#98C379;">        %{buildroot}/usr/local/%{name}/etc/zabbix_agentd.conf.d/zbx_parse_iostat_values.conf</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;export PATH=/etc/zabbix/bin:/etc/zabbix/sbin:$PATH&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt;&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">%{buildroot}/etc/profile.d/%{name}.sh</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cp</span><span style="color:#98C379;--shiki-dark:#98C379;"> %{_builddir}/%{name}-%{version}/misc/init.d/fedora/core/zabbix_agentd</span><span style="color:#98C379;--shiki-dark:#98C379;">       %{buildroot}/etc/init.d/zabbix_agentd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%files</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%defattr</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (-,root,root,0755)                                      </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#定义rpm包安装时创建的相关目录及文件</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#在该选项中%defattr (-,root,root)一定要注意。它是指定安装文件的属性，分别是(mode,owner,group)，-表示默认值，对文本文件是0644，可执行文件是0755。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/usr/local/%</span><span style="color:#98C379;--shiki-dark:#98C379;">{name}</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/*</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/usr/local/zabbix/lib/*</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/usr/local/zabbix/etc/zabbix_agentd.conf.d/*</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/etc/init.d/zabbix_agentd</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/etc/profile.d/%</span><span style="color:#98C379;--shiki-dark:#98C379;">{name}</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">.sh</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%changelog</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                                  </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#主要用于软件的变更日志。该选项可有可无</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%clean</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -rf</span><span style="color:#98C379;--shiki-dark:#98C379;"> %{buildroot}</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                         </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#清理临时文件</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="打包" tabindex="-1"><a class="header-anchor" href="#打包"><span>打包</span></a></h2><p>在<code>SPECS</code>文件夹下执行 <code>rpmbuild -bb xxx.spec</code> 即可</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-ba</span><span style="color:#98C379;--shiki-dark:#98C379;"> 既生成src.rpm又生成二进制rpm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-bs</span><span style="color:#98C379;--shiki-dark:#98C379;"> 只生成src的rpm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-bb</span><span style="color:#98C379;--shiki-dark:#98C379;"> 只生二进制的rpm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-bp</span><span style="color:#98C379;--shiki-dark:#98C379;"> 执行到pre</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-bc</span><span style="color:#98C379;--shiki-dark:#98C379;"> 执行到</span><span style="color:#98C379;--shiki-dark:#98C379;"> build段</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-bi</span><span style="color:#98C379;--shiki-dark:#98C379;"> 执行install段</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-bl</span><span style="color:#98C379;--shiki-dark:#98C379;"> 检测有文件没包含</span></span></code></pre></div><p>可以先<code>rpmbuild -bp</code>,再<code>-bc</code> 再<code>-bi</code>如果没问题<code>rpmbuild -bb/ba</code>生成二进制包或两个都生成</p><p>脚本参考(主要针对centos7 内核)</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#/usr/bin/bash</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#ip= ip addr |grep inet |egrep -v &quot;inet6|127.0.0.1&quot; |awk &#39;{print $2}&#39; |awk -F &quot;/&quot; &#39;{print $1}&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># get server ip</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\\n NOTICE! Check the package net-tools is installed \\n &quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">read</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;">  &quot;zabbix server ip：&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> zabbix_server</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">!</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$zabbix_server</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ]; </span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;you have not input server ip, exit&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    exit</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># get agent ip</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">read</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;">  &quot;local ip: &quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> local_ip</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">!</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$local_ip</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ]; </span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;you have not input local ip, exit&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    exit</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;start to install...&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sleep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#version centos7</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#cat /etc/*release | egrep -i &quot;centos|rhel|red hat|redhat&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;check os version...&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sleep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#version centos7</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc/</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">*</span><span style="color:#98C379;--shiki-dark:#98C379;">release</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -q</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;centos\\|rhel\\|red hat\\|redhat&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [[ </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$?</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -eq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ]];</span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc/</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">*</span><span style="color:#98C379;--shiki-dark:#98C379;">release</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -q</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;7\\.&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [[ </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$?</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -eq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ]];</span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        sleep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        rpm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -ivh</span><span style="color:#98C379;--shiki-dark:#98C379;"> zabbix-3.0.14-1.el7.centos.x86_64.rpm</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;modify the agentd configuration&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        sleep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;/^Server=/c\\Server=\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">zabbix_server</span><span style="color:#98C379;--shiki-dark:#98C379;">}&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> /usr/local/zabbix/etc/zabbix_agentd.conf</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;/^ServerActive=/c\\ServerActive=\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">zabbix_server</span><span style="color:#98C379;--shiki-dark:#98C379;">}&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> /usr/local/zabbix/etc/zabbix_agentd.conf</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;/^Hostname=/c\\Hostname=\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">local_ip</span><span style="color:#98C379;--shiki-dark:#98C379;">}&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> /usr/local/zabbix/etc/zabbix_agentd.conf</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;/Timeout=3/c\\Timeout=30&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> /usr/local/zabbix/etc/zabbix_agentd.conf</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;260i\\Include=/usr/local/zabbix/etc/zabbix_agentd.conf.d/*.conf&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> /usr/local/zabbix/etc/zabbix_agentd.conf</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        systemctl</span><span style="color:#98C379;--shiki-dark:#98C379;"> daemon-reload</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        /etc/init.d/zabbix_agentd</span><span style="color:#98C379;--shiki-dark:#98C379;"> start</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        chkconfig</span><span style="color:#98C379;--shiki-dark:#98C379;"> zabbix_agentd</span><span style="color:#98C379;--shiki-dark:#98C379;"> on</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;SUCCESSFUL !&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        exit</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    fi</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">fi</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,25),r=[e];function p(o,d){return n(),a("div",null,r)}const c=s(l,[["render",p],["__file","package-rpm.html.vue"]]),k=JSON.parse(`{"path":"/ops/linux/package-rpm.html","title":"rpm包制作","lang":"zh-CN","frontmatter":{"article":true,"title":"rpm包制作","order":99,"category":["linux"],"tag":["rpm"],"index":true,"description":"RPM（Redhat Package Manager）是用于Redhat、CentOS、Fedora等Linux 分发版（distribution）的常见的软件包管理器。因为它允许分发已编译的软件，所以用户只用一个命令就可以安装软件. 安装 使用 rpmdev-setuptree命令，可在$HOME下生产一个标注的工作空间rpmbuild 结构如下 如...","head":[["meta",{"property":"og:url","content":"https://docs.lizili.online/ops/linux/package-rpm.html"}],["meta",{"property":"og:site_name","content":"lzz's Blog"}],["meta",{"property":"og:title","content":"rpm包制作"}],["meta",{"property":"og:description","content":"RPM（Redhat Package Manager）是用于Redhat、CentOS、Fedora等Linux 分发版（distribution）的常见的软件包管理器。因为它允许分发已编译的软件，所以用户只用一个命令就可以安装软件. 安装 使用 rpmdev-setuptree命令，可在$HOME下生产一个标注的工作空间rpmbuild 结构如下 如..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-03-04T03:48:53.000Z"}],["meta",{"property":"article:author","content":"z"}],["meta",{"property":"article:tag","content":"rpm"}],["meta",{"property":"article:modified_time","content":"2024-03-04T03:48:53.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"rpm包制作\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-03-04T03:48:53.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"z\\",\\"url\\":\\"https://docs.lizili.online\\"}]}"]]},"headers":[{"level":2,"title":"安装","slug":"安装","link":"#安装","children":[]},{"level":2,"title":"使用","slug":"使用","link":"#使用","children":[]},{"level":2,"title":"目录","slug":"目录","link":"#目录","children":[]},{"level":2,"title":"流程","slug":"流程","link":"#流程","children":[]},{"level":2,"title":"SPEC","slug":"spec","link":"#spec","children":[]},{"level":2,"title":"打包","slug":"打包","link":"#打包","children":[]}],"git":{"createdTime":1689954353000,"updatedTime":1709524133000,"contributors":[{"name":"lizili","email":"cn.zili.lee@outlook.com","commits":2}]},"readingTime":{"minutes":5.35,"words":1604},"filePathRelative":"ops/linux/package-rpm.md","localizedDate":"2023年7月21日","excerpt":"\\n<blockquote>\\n<p>RPM（Redhat Package Manager）是用于Redhat、CentOS、Fedora等Linux 分发版（distribution）的常见的软件包管理器。因为它允许分发已编译的软件，所以用户只用一个命令就可以安装软件.</p>\\n</blockquote>\\n<h2>安装</h2>\\n<div class=\\"language-\\" data-ext=\\"\\" data-title=\\"\\"><pre class=\\"shiki shiki-themes one-dark-pro one-dark-pro vp-code\\" style=\\"background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf\\" tabindex=\\"0\\"><code><span class=\\"line\\"><span>yum install rpm-build</span></span>\\n<span class=\\"line\\"><span>yum install rpmdevtools</span></span></code></pre>\\n</div>","autoDesc":true}`);export{c as comp,k as data};

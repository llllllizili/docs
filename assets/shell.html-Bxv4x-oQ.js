import{_ as a,c as i,a as n,b as s,h as l,f as e,o as p}from"./app-BfCDUtKQ.js";const r={},o=s("div",{class:"hint-container info"},[s("p",{class:"hint-container-title"},"🔔"),s("p",null,[l("个人在线查询使用，"),s("a",{href:"https://github.com/liquanzhou/ops_doc",target:"_blank",rel:"noopener noreferrer"},"原文地址")])],-1),t=e(`<h1 id="" tabindex="-1"><a class="header-anchor" href="#"><span></span></a></h1><h2 id="文件" tabindex="-1"><a class="header-anchor" href="#文件"><span>文件</span></a></h2><h3 id="基础命令" tabindex="-1"><a class="header-anchor" href="#基础命令"><span>基础命令</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    ls</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -rtl</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 按时间倒叙列出所有目录和文件 ll -rt</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    touch</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 创建空白文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    rm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -rf</span><span style="color:#98C379;--shiki-dark:#98C379;"> 目录名</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 不提示删除非空目录(-r:递归删除 -f强制)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    dos2unix</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # windows文本转linux文本</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    unix2dos</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # linux文本转windows文本</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    enca</span><span style="color:#98C379;--shiki-dark:#98C379;"> filename</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 查看编码  安装 yum install -y enca</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    md5sum</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 查看md5值</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    ln</span><span style="color:#98C379;--shiki-dark:#98C379;"> 源文件</span><span style="color:#98C379;--shiki-dark:#98C379;"> 目标文件</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 硬链接</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    ln</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> 源文件</span><span style="color:#98C379;--shiki-dark:#98C379;"> 目标文件</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 符号连接</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    readlink</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -f</span><span style="color:#98C379;--shiki-dark:#98C379;"> /data</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 查看连接真实目录</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">nl</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">less</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 查看上下翻页且显示行号  q退出</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    head</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # 查看文件开头内容</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    head</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -c</span><span style="color:#98C379;--shiki-dark:#98C379;"> 10m</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 截取文件中10M内容</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    split</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -C</span><span style="color:#98C379;--shiki-dark:#98C379;"> 10M</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 将文件切割大小为10M -C按行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    tail</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -f</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 查看结尾 监视日志文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    tail</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -F</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 监视日志并重试, 针对文件被mv的情况可以持续读取</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # 检查文件类型</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    umask</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 更改默认权限</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    uniq</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # 删除重复的行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    uniq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -c</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 重复的行出现次数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    uniq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -u</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 只显示不重复行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    paste</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#98C379;--shiki-dark:#98C379;"> b</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 将两个文件合并用tab键分隔开</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    paste</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;+&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#98C379;--shiki-dark:#98C379;"> b</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 将两个文件合并指定&#39;+&#39;符号隔开</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    paste</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 将多行数据合并到一行用tab键隔开</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    chattr</span><span style="color:#98C379;--shiki-dark:#98C379;"> +i</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc/passwd</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 不得任意改变文件或目录 -i去掉锁 -R递归</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    more</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # 向下分面器</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    locate</span><span style="color:#98C379;--shiki-dark:#98C379;"> 字符串</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 搜索</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    wc</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 查看行数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    cp</span><span style="color:#98C379;--shiki-dark:#98C379;"> filename{,.bak}</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 快速备份一个文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\cp</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#98C379;--shiki-dark:#98C379;"> b</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 拷贝不提示 既不使用别名 cp -i</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    rev</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     # 将行中的字符逆序排列</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    comm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -12</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 行和行比较匹配</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;10.45aa&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cksum</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 字符串转数字编码，可做校验，也可用于文件校验</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    iconv</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -f</span><span style="color:#98C379;--shiki-dark:#98C379;"> gbk</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> utf8</span><span style="color:#98C379;--shiki-dark:#98C379;"> 原.txt</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">新.txt</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 转换编码</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    xxd</span><span style="color:#98C379;--shiki-dark:#98C379;"> /boot/grub/stage1</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 16进制查看</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    hexdump</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -C</span><span style="color:#98C379;--shiki-dark:#98C379;"> /boot/grub/stage1</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 16进制查看</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    rename</span><span style="color:#98C379;--shiki-dark:#98C379;"> 原模式</span><span style="color:#98C379;--shiki-dark:#98C379;"> 目标模式</span><span style="color:#98C379;--shiki-dark:#98C379;"> 文件</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 重命名 可正则</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    watch</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;df; ls -FlAt /path&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 实时某个目录下查看最新改动过的文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    cp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -v</span><span style="color:#98C379;--shiki-dark:#98C379;">  /dev/dvd</span><span style="color:#98C379;--shiki-dark:#98C379;">  /rhel4.6.iso9660</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 制作镜像</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    diff</span><span style="color:#98C379;--shiki-dark:#98C379;"> suzu.c</span><span style="color:#98C379;--shiki-dark:#98C379;"> suzu2.c</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  &gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">sz.patch</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 制作补丁</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    patch</span><span style="color:#98C379;--shiki-dark:#98C379;"> suzu.c</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt; </span><span style="color:#98C379;--shiki-dark:#98C379;">sz.patch</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 安装补丁</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="sort排序" tabindex="-1"><a class="header-anchor" href="#sort排序"><span>sort排序</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -t</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 指定排序时所用的栏位分隔字符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 依照数值的大小排序</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -r</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 以相反的顺序来排序</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -f</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 排序时，将小写字母视为大写字母</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -d</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 排序时，处理英文字母、数字及空格字符外，忽略其他的字符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -c</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 检查文件是否已经按照顺序排序</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -b</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 忽略每行前面开始处的空格字符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -M</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 前面3个字母依照月份的缩写进行排序</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -k</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 指定域</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -m</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 将几个排序好的文件进行合并</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -T</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 指定临时文件目录,默认在/tmp</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    +</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;起始栏位&gt;-&lt;结束栏位&gt;   </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 以指定的栏位来排序，范围由起始栏位到结束栏位的前一栏位。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -o</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 将排序后的结果存入指定的文</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    sort</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 按数字排序</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    sort</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -nr</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 按数字倒叙</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    sort</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -u</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 过滤重复行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    sort</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -m</span><span style="color:#98C379;--shiki-dark:#98C379;"> a.txt</span><span style="color:#98C379;--shiki-dark:#98C379;"> c.txt</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 将两个文件内容整合到一起</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    sort</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39; &#39;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -k</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -k</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#98C379;--shiki-dark:#98C379;"> a.txt</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 第二域相同，将从第三域进行升降处理</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    sort</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;:&#39;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -k</span><span style="color:#98C379;--shiki-dark:#98C379;"> 3r</span><span style="color:#98C379;--shiki-dark:#98C379;"> a.txt</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 以:为分割域的第三域进行倒叙排列</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    sort</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -k</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1.3</span><span style="color:#98C379;--shiki-dark:#98C379;"> a.txt</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 从第三个字母起进行排序</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    sort</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot; &quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -k</span><span style="color:#98C379;--shiki-dark:#98C379;"> 2n</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -u</span><span style="color:#98C379;--shiki-dark:#98C379;">  a.txt</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 以第二域进行排序，如果遇到重复的，就删除</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="find查找" tabindex="-1"><a class="header-anchor" href="#find查找"><span>find查找</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # linux文件无创建时间</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # Access 使用时间</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # Modify 内容修改时间</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # Change 状态改变时间(权限、属主)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 时间默认以24小时为单位,当前时间到向前24小时为0天,向前48-72小时为2天</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # -and 且 匹配两个条件 参数可以确定时间范围 -mtime +2 -and -mtime -4</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # -or 或 匹配任意一个条件</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    find</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -name</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;*http*&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 按文件名查找</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    find</span><span style="color:#98C379;--shiki-dark:#98C379;"> .</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -type</span><span style="color:#98C379;--shiki-dark:#98C379;"> f</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 查找某一类型文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    find</span><span style="color:#98C379;--shiki-dark:#98C379;"> /</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -perm</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 按照文件权限查找</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    find</span><span style="color:#98C379;--shiki-dark:#98C379;"> /</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -user</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 按照文件属主查找</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    find</span><span style="color:#98C379;--shiki-dark:#98C379;"> /</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -group</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 按照文件所属的组来查找文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    find</span><span style="color:#98C379;--shiki-dark:#98C379;"> /</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -atime</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 文件使用时间在N天以内</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    find</span><span style="color:#98C379;--shiki-dark:#98C379;"> /</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -atime</span><span style="color:#98C379;--shiki-dark:#98C379;"> +n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 文件使用时间在N天以前</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    find</span><span style="color:#98C379;--shiki-dark:#98C379;"> /</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -mtime</span><span style="color:#98C379;--shiki-dark:#98C379;"> +n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 文件内容改变时间在N天以前</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    find</span><span style="color:#98C379;--shiki-dark:#98C379;"> /</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -ctime</span><span style="color:#98C379;--shiki-dark:#98C379;"> +n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 文件状态改变时间在N天前</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    find</span><span style="color:#98C379;--shiki-dark:#98C379;"> /</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -mmin</span><span style="color:#98C379;--shiki-dark:#98C379;"> +30</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 按分钟查找内容改变</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    find</span><span style="color:#98C379;--shiki-dark:#98C379;"> /</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -size</span><span style="color:#98C379;--shiki-dark:#98C379;"> +1000000c</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -print</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                           # 查找文件长度大于1M字节的文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    find</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -name</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;*passwd*&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -exec</span><span style="color:#98C379;--shiki-dark:#98C379;"> grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;xuesong&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> {}</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> \\;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 按名字查找文件传递给-exec后命令</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    find</span><span style="color:#98C379;--shiki-dark:#98C379;"> .</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -name</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;t*&#39;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -exec</span><span style="color:#98C379;--shiki-dark:#98C379;"> basename</span><span style="color:#98C379;--shiki-dark:#98C379;"> {}</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> \\;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 查找文件名,不取路径</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    find</span><span style="color:#98C379;--shiki-dark:#98C379;"> .</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -type</span><span style="color:#98C379;--shiki-dark:#98C379;"> f</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -name</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;err*&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -exec</span><span style="color:#98C379;--shiki-dark:#98C379;">  rename</span><span style="color:#98C379;--shiki-dark:#98C379;"> err</span><span style="color:#98C379;--shiki-dark:#98C379;"> ERR</span><span style="color:#98C379;--shiki-dark:#98C379;"> {}</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> \\;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 批量改名(查找err 替换为 ERR {}文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    find</span><span style="color:#98C379;--shiki-dark:#98C379;"> 路径</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -name</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> *</span><span style="color:#98C379;--shiki-dark:#98C379;">name1</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">*</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -or</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -name</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> *</span><span style="color:#98C379;--shiki-dark:#98C379;">name2</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">*</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 查找任意一个关键字</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="vim编辑" tabindex="-1"><a class="header-anchor" href="#vim编辑"><span>vim编辑</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    gconf-editor</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 配置编辑器</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    /etc/vimrc</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 配置文件路径</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    vim</span><span style="color:#98C379;--shiki-dark:#98C379;"> +24</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 打开文件定位到指定行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    vim</span><span style="color:#98C379;--shiki-dark:#98C379;"> file1</span><span style="color:#98C379;--shiki-dark:#98C379;"> file2</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 打开多个文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    vim</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -O2</span><span style="color:#98C379;--shiki-dark:#98C379;"> file1</span><span style="color:#98C379;--shiki-dark:#98C379;"> file2</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 垂直分屏</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    vim</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -on</span><span style="color:#98C379;--shiki-dark:#98C379;"> file1</span><span style="color:#98C379;--shiki-dark:#98C379;"> file2</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 水平分屏</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    Ctrl+</span><span style="color:#98C379;--shiki-dark:#98C379;"> U</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 向前翻页</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    Ctrl+</span><span style="color:#98C379;--shiki-dark:#98C379;"> D</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 向后翻页</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    Ctrl+ww</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 在窗口间切换</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    Ctrl+w</span><span style="color:#98C379;--shiki-dark:#98C379;"> +or-or=</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 增减高度</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    :sp</span><span style="color:#98C379;--shiki-dark:#98C379;"> filename</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 上下分割打开新文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    :vs</span><span style="color:#98C379;--shiki-dark:#98C379;"> filename</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 左右分割打开新文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    :set</span><span style="color:#98C379;--shiki-dark:#98C379;"> nu</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 打开行号</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    :set</span><span style="color:#98C379;--shiki-dark:#98C379;"> nonu</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 取消行号</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    :nohl</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 取消高亮</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    :set</span><span style="color:#98C379;--shiki-dark:#98C379;"> paste</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 取消缩进</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    :set</span><span style="color:#98C379;--shiki-dark:#98C379;"> autoindent</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 设置自动缩进</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    :set</span><span style="color:#98C379;--shiki-dark:#98C379;"> ff</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 查看文本格式</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    :set</span><span style="color:#98C379;--shiki-dark:#98C379;"> binary</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 改为unix格式</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    :</span><span style="color:#98C379;--shiki-dark:#98C379;">%s/字符1/字符2/g</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 全部替换</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    :200</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 跳转到200  1 文件头</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    G</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 跳到行尾</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    dd</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     # 删除当前行 并复制 可直接p粘贴</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    11111dd</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 删除11111行，可用来清空文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    r</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 替换单个字符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    R</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 替换多个字符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    u</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 撤销上次操作</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    *</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 全文匹配当前光标所在字符串</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    $</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 行尾</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    0</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 行首</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    X</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 文档加密</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    v</span><span style="color:#98C379;--shiki-dark:#98C379;"> =</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # 自动格式化代码</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    Ctrl+v</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 可视模式</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    Ctrl+v</span><span style="color:#98C379;--shiki-dark:#98C379;"> I</span><span style="color:#98C379;--shiki-dark:#98C379;"> ESC</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 多行操作</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    Ctrl+v</span><span style="color:#98C379;--shiki-dark:#98C379;"> s</span><span style="color:#98C379;--shiki-dark:#98C379;"> ESC</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 批量取消注释</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="归档压缩" tabindex="-1"><a class="header-anchor" href="#归档压缩"><span>归档压缩</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    tar</span><span style="color:#98C379;--shiki-dark:#98C379;"> zxvpf</span><span style="color:#98C379;--shiki-dark:#98C379;"> gz.tar.gz</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -C</span><span style="color:#98C379;--shiki-dark:#98C379;"> 放到指定目录</span><span style="color:#98C379;--shiki-dark:#98C379;"> 包中的目录</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 解包tar.gz 不指定目录则全解压</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    tar</span><span style="color:#98C379;--shiki-dark:#98C379;"> zcvpf</span><span style="color:#98C379;--shiki-dark:#98C379;"> /</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$path</span><span style="color:#98C379;--shiki-dark:#98C379;">/gz.tar.gz</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> *</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 打包gz 注意*最好用相对路径</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    tar</span><span style="color:#98C379;--shiki-dark:#98C379;"> zcf</span><span style="color:#98C379;--shiki-dark:#98C379;"> /</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$path</span><span style="color:#98C379;--shiki-dark:#98C379;">/gz.tar.gz</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> *</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 打包正确不提示</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    tar</span><span style="color:#98C379;--shiki-dark:#98C379;"> ztvpf</span><span style="color:#98C379;--shiki-dark:#98C379;"> gz.tar.gz</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 查看gz</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    tar</span><span style="color:#98C379;--shiki-dark:#98C379;"> xvf</span><span style="color:#98C379;--shiki-dark:#98C379;"> 1.tar</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -C</span><span style="color:#98C379;--shiki-dark:#98C379;"> 目录</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 解包tar</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    tar</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -cvf</span><span style="color:#98C379;--shiki-dark:#98C379;"> 1.tar</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> *</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 打包tar</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    tar</span><span style="color:#98C379;--shiki-dark:#98C379;"> tvf</span><span style="color:#98C379;--shiki-dark:#98C379;"> 1.tar</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 查看tar</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    tar</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -rvf</span><span style="color:#98C379;--shiki-dark:#98C379;"> 1.tar</span><span style="color:#98C379;--shiki-dark:#98C379;"> 文件名</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 给tar追加文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    tar</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --exclude=/home/dmtsai</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --exclude=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">*</span><span style="color:#D19A66;--shiki-dark:#D19A66;">.tar</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -zcvf</span><span style="color:#98C379;--shiki-dark:#98C379;"> myfile.tar.gz</span><span style="color:#98C379;--shiki-dark:#98C379;"> /home/</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">*</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 打包/home, /etc ，但排除 /home/dmtsai</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    tar</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -N</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;2005/06/01&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -zcvf</span><span style="color:#98C379;--shiki-dark:#98C379;"> home.tar.gz</span><span style="color:#98C379;--shiki-dark:#98C379;"> /home</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 在 /home 当中，比 2005/06/01 新的文件才备份</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    tar</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -zcvfh</span><span style="color:#98C379;--shiki-dark:#98C379;"> home.tar.gz</span><span style="color:#98C379;--shiki-dark:#98C379;"> /home</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     # 打包目录中包括连接目录</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    tar</span><span style="color:#98C379;--shiki-dark:#98C379;"> zcf</span><span style="color:#98C379;--shiki-dark:#98C379;"> -</span><span style="color:#98C379;--shiki-dark:#98C379;"> ./</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ssh</span><span style="color:#98C379;--shiki-dark:#98C379;"> root@IP</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;tar zxf - -C /xxxx&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 一边压缩一边解压</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    zgrep</span><span style="color:#98C379;--shiki-dark:#98C379;"> 字符</span><span style="color:#98C379;--shiki-dark:#98C379;"> 1.gz</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 查看压缩包中文件字符行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    bzip2</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  -dv</span><span style="color:#98C379;--shiki-dark:#98C379;"> 1.tar.bz2</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 解压bzip2</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    bzip2</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -v</span><span style="color:#98C379;--shiki-dark:#98C379;"> 1.tar</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # bzip2压缩</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    bzcat</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 查看bzip2</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    gzip</span><span style="color:#98C379;--shiki-dark:#98C379;"> A</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 直接压缩文件 # 压缩后源文件消失</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    gunzip</span><span style="color:#98C379;--shiki-dark:#98C379;"> A.gz</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 直接解压文件 # 解压后源文件消失</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    gzip</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -dv</span><span style="color:#98C379;--shiki-dark:#98C379;"> 1.tar.gz</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 解压gzip到tar</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    gzip</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -v</span><span style="color:#98C379;--shiki-dark:#98C379;"> 1.tar</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 压缩tar到gz</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    unzip</span><span style="color:#98C379;--shiki-dark:#98C379;"> zip.zip</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 解压zip</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    zip</span><span style="color:#98C379;--shiki-dark:#98C379;"> zip.zip</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> *</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 压缩zip</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # rar3.6下载:  http://www.rarsoft.com/rar/rarlinux-3.6.0.tar.gz</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    rar</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#98C379;--shiki-dark:#98C379;"> rar.rar</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> *</span><span style="color:#98C379;--shiki-dark:#98C379;">.jpg</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 压缩文件为rar包</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    unrar</span><span style="color:#98C379;--shiki-dark:#98C379;"> x</span><span style="color:#98C379;--shiki-dark:#98C379;"> rar.rar</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 解压rar包</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    7z</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#98C379;--shiki-dark:#98C379;"> 7z.7z</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> *</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 7z压缩</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    7z</span><span style="color:#98C379;--shiki-dark:#98C379;"> e</span><span style="color:#98C379;--shiki-dark:#98C379;"> 7z.7z</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 7z解压</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="文件acl控制" tabindex="-1"><a class="header-anchor" href="#文件acl控制"><span>文件ACL控制</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getfacl</span><span style="color:#98C379;--shiki-dark:#98C379;"> 1.test</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 查看文件ACL权限</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setfacl</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -R</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -m</span><span style="color:#98C379;--shiki-dark:#98C379;"> u:xuesong:rw-</span><span style="color:#98C379;--shiki-dark:#98C379;"> 1.test</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 对文件增加用户的读写权限 -R 递归</span></span></code></pre></div><h3 id="git操作" tabindex="-1"><a class="header-anchor" href="#git操作"><span>git操作</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 编译安装git-1.8.4.4</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">./configure</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --with-curl</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --with-expat</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">make</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">make</span><span style="color:#98C379;--shiki-dark:#98C379;"> install</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> clone</span><span style="color:#98C379;--shiki-dark:#98C379;"> git@10.10.10.10:gittest.git</span><span style="color:#98C379;--shiki-dark:#98C379;">  ./gittest/</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 克隆项目到指定目录</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> status</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                         # Show the working tree(工作树) status</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> log</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --stat</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                # 查看最后一次日志文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> branch</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                      # 列出远程跟踪分支(remote-tracking branches)和本地分支</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> checkout</span><span style="color:#98C379;--shiki-dark:#98C379;"> developing</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                            # 切换到developing分支</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> checkout</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -b</span><span style="color:#98C379;--shiki-dark:#98C379;"> release</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                            # 切换分支没有从当前分支创建</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> checkout</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -b</span><span style="color:#98C379;--shiki-dark:#98C379;"> release</span><span style="color:#98C379;--shiki-dark:#98C379;"> origin/master</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 从远程分支创建本地镜像分支</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> push</span><span style="color:#98C379;--shiki-dark:#98C379;"> origin</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --delete</span><span style="color:#98C379;--shiki-dark:#98C379;"> release</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 从远端删除分区，服务端有可能设置保护不允许删除</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> push</span><span style="color:#98C379;--shiki-dark:#98C379;"> origin</span><span style="color:#98C379;--shiki-dark:#98C379;"> release</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                            # 把本地分支提交到远程</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> pull</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                           # 更新项目 需要cd到项目目录中</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> fetch</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                          # 抓取远端代码但不合并到当前</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> reset</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --hard</span><span style="color:#98C379;--shiki-dark:#98C379;"> origin/master</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     # 和远端同步分支</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> add</span><span style="color:#98C379;--shiki-dark:#98C379;"> .</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                          # 更新所有文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> commit</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -m</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;gittest up&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                         # 提交操作并添加备注</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> push</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                           # 正式提交到远程git服务器</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> push</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [-u </span><span style="color:#98C379;--shiki-dark:#98C379;">origin</span><span style="color:#98C379;--shiki-dark:#98C379;"> master]</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 正式提交到远程git服务器(master分支)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> tag</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [-a] dev-v-0.11.54 [-m </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;fix #67&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">]          </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建tag,名为dev-v-0.11.54,备注fix #67</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> tag</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#98C379;--shiki-dark:#98C379;"> dev-v-0.11.54</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                           # 查看tag(dev-v-0.11.5)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> push</span><span style="color:#98C379;--shiki-dark:#98C379;"> origin</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --tags</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                             # 提交tag</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> reset</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --hard</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                   # 本地恢复整个项目</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> rm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -r</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --cached</span><span style="color:#98C379;--shiki-dark:#98C379;">  ./img</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # -n执行命令时,不会删除任何文件,而是展示此命令要删除的文件列表预览</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> rm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -r</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --cached</span><span style="color:#98C379;--shiki-dark:#98C379;">  ./img</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                          # 执行删除命令 需要commit和push让远程生效</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> init</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --bare</span><span style="color:#98C379;--shiki-dark:#98C379;"> smc-content-check.git</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 初始化新git项目  需要手动创建此目录并给git用户权限 chown -R git:git smc-content-check.git</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> config</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --global</span><span style="color:#98C379;--shiki-dark:#98C379;"> credential.helper</span><span style="color:#98C379;--shiki-dark:#98C379;"> store</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 记住密码</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> config</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [--global] user.name </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;your name&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 设置你的用户名, 希望在一个特定的项目中使用不同的用户或e-mail地址, 不要--global选项</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> config</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [--global] user.email </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;your email&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 设置你的e-mail地址, 每次Git提交都会使用该信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> config</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [--global] user.name                    </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看用户名</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> config</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [--global] user.email                   </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看用户e-mail</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> config</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --global</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --edit</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                         # 编辑~/.gitconfig(User-specific)配置文件, 值优先级高于/etc/gitconfig(System-wide)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> config</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --edit</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                  # 编辑.git/config(Repository specific)配置文件, 值优先级高于~/.gitconfig</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> cherry-pick</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  &lt;</span><span style="color:#98C379;--shiki-dark:#98C379;">commit</span><span style="color:#98C379;--shiki-dark:#98C379;"> i</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">d&gt;                       </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 用于把另一个本地分支的commit修改应用到当前分支 需要push到远程</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> log</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --pretty=format:</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;%h: %s&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> 9378b62..HEAD</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 查看指定范围更新操作 commit id</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">从远端拉一份新的</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># You have not concluded your merge (MERGE_HEAD exists)  git拉取失败</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> fetch</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --hard</span><span style="color:#98C379;--shiki-dark:#98C379;"> origin/master</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">git</span><span style="color:#98C379;--shiki-dark:#98C379;"> reset</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --hard</span><span style="color:#98C379;--shiki-dark:#98C379;"> origin/master</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="rm删除文件恢复" tabindex="-1"><a class="header-anchor" href="#rm删除文件恢复"><span>rm删除文件恢复</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># debugfs针对 ext2   # ext3grep针对 ext3   # extundelete针对 ext4</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">df</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -T</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 首先查看磁盘分区格式</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">umount</span><span style="color:#98C379;--shiki-dark:#98C379;"> /data/</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 卸载挂载,数据丢失请首先卸载挂载,或重新挂载只读</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ext3grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sdb1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --ls</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --inode</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 记录信息继续查找目录下文件inode信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ext3grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sdb1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --ls</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --inode</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 131081</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 此处是inode</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ext3grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sdb1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --restore-inode</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 49153</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 记录下inode信息开始恢复目录</span></span></code></pre></div><h2 id="软件" tabindex="-1"><a class="header-anchor" href="#软件"><span>软件</span></a></h2><h3 id="rpm" tabindex="-1"><a class="header-anchor" href="#rpm"><span>rpm</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rpm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -ivh</span><span style="color:#98C379;--shiki-dark:#98C379;"> lynx</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # rpm安装</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rpm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> lynx</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 卸载包</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rpm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> lynx</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --nodeps</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 强制卸载</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rpm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -qa</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 查看所有安装的rpm包</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rpm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -qa</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> lynx</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 查找包是否安装</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rpm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -ql</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 软件包路径</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rpm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -Uvh</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 升级包</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rpm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --test</span><span style="color:#98C379;--shiki-dark:#98C379;"> lynx</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 测试</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rpm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -qc</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 软件包配置文档</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rpm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --import</span><span style="color:#98C379;--shiki-dark:#98C379;">  /etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-6</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 导入rpm的签名信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rpm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --initdb</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 初始化rpm 数据库</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rpm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --rebuilddb</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 重建rpm数据库  在rpm和yum无响应的情况使用 先 rm -f /var/lib/rpm/__db.00* 在重建</span></span></code></pre></div><h3 id="yum" tabindex="-1"><a class="header-anchor" href="#yum"><span>yum</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">yum</span><span style="color:#98C379;--shiki-dark:#98C379;"> list</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 所有软件列表</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">yum</span><span style="color:#98C379;--shiki-dark:#98C379;"> install</span><span style="color:#98C379;--shiki-dark:#98C379;"> 包名</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 安装包和依赖包</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">yum</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -y</span><span style="color:#98C379;--shiki-dark:#98C379;"> update</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 升级所有包版本,依赖关系，系统版本内核都升级</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">yum</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -y</span><span style="color:#98C379;--shiki-dark:#98C379;"> update</span><span style="color:#98C379;--shiki-dark:#98C379;"> 软件包名</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 升级指定的软件包</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">yum</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -y</span><span style="color:#98C379;--shiki-dark:#98C379;"> upgrade</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 不改变软件设置更新软件，系统版本升级，内核不改变</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">yum</span><span style="color:#98C379;--shiki-dark:#98C379;"> search</span><span style="color:#98C379;--shiki-dark:#98C379;"> mail</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # yum搜索相关包</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">yum</span><span style="color:#98C379;--shiki-dark:#98C379;"> grouplist</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 软件包组</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">yum</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -y</span><span style="color:#98C379;--shiki-dark:#98C379;"> groupinstall</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Virtualization&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 安装软件包组</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">repoquery</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -ql</span><span style="color:#98C379;--shiki-dark:#98C379;"> gstreamer</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 不安装软件查看包含文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">yum</span><span style="color:#98C379;--shiki-dark:#98C379;"> clean</span><span style="color:#98C379;--shiki-dark:#98C379;"> all</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 清除var下缓存</span></span></code></pre></div><h3 id="编译" tabindex="-1"><a class="header-anchor" href="#编译"><span>编译</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">源码安装</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    ./configure</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --help</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 查看所有编译参数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    ./configure</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  --prefix=/usr/local/</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 配置参数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    make</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                 # 编译</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # make -j 8                          # 多线程编译,速度较快,但有些软件不支持</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    make</span><span style="color:#98C379;--shiki-dark:#98C379;"> install</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                         # 安装包</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    make</span><span style="color:#98C379;--shiki-dark:#98C379;"> clean</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                           # 清除编译结果</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">perl程序编译</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    perl</span><span style="color:#98C379;--shiki-dark:#98C379;"> Makefile.PL</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    make</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    make</span><span style="color:#98C379;--shiki-dark:#98C379;"> test</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    make</span><span style="color:#98C379;--shiki-dark:#98C379;"> install</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">python程序编译</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    python</span><span style="color:#98C379;--shiki-dark:#98C379;"> file.py</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 源码包编译安装</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    python</span><span style="color:#98C379;--shiki-dark:#98C379;"> setup.py</span><span style="color:#98C379;--shiki-dark:#98C379;"> build</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    python</span><span style="color:#98C379;--shiki-dark:#98C379;"> setup.py</span><span style="color:#98C379;--shiki-dark:#98C379;"> install</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">编译c程序</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    gcc</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -g</span><span style="color:#98C379;--shiki-dark:#98C379;"> hello.c</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -o</span><span style="color:#98C379;--shiki-dark:#98C379;"> hello</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="系统" tabindex="-1"><a class="header-anchor" href="#系统"><span>系统</span></a></h2><h3 id="基础命令-1" tabindex="-1"><a class="header-anchor" href="#基础命令-1"><span>基础命令</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">wall</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        　  　                            # 给其它用户发消息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">whereis</span><span style="color:#98C379;--shiki-dark:#98C379;"> ls</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                    # 查找命令的目录</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">which</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                         # 查看当前要执行的命令所在的路径</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">clear</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                         # 清空整个屏幕</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">reset</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                         # 重新初始化屏幕</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cal</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                           # 显示月历</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 123456</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">md5sum</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # md5加密</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mkpasswd</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                      # 随机生成密码   -l位数系统org: public ntp time server for everyone(http://www.pool.ntp.org/zh/)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tzselect</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                      # 选择时区 #+8=(5 9 1 1) # (TZ=&#39;Asia/Shanghai&#39;; export TZ)括号内写入 /etc/profile</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/sbin/hwclock</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -w</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                              # 时间保存到硬件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/etc/shadow</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                   # 账户影子文件</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">LANG</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">en</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                       # 修改语言</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">vim</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc/sysconfig/i18n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 修改编码  LANG=&quot;en_US.UTF-8&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">export</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> LC_ALL</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">C</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                               # 强制字符集</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">vi</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc/hosts</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                 # 查询静态主机名</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">alias</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                         # 别名</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">watch</span><span style="color:#98C379;--shiki-dark:#98C379;"> uptime</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                  # 监测命令动态刷新 监视</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ipcs</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                       # 查看Linux系统当前单个共享内存段的最大值</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ldconfig</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                      # 动态链接库管理命令</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ldd</span><span style="color:#98C379;--shiki-dark:#98C379;"> \`</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">which</span><span style="color:#98C379;--shiki-dark:#98C379;"> cmd\`</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                               # 查看命令的依赖库</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dist-upgrade</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                  # 会改变配置文件,改变旧的依赖关系，改变系统版本</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/boot/grub/grub.conf</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                          # grub启动项配置</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ps</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -mfL</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt;</span><span style="color:#98C379;--shiki-dark:#98C379;">PI</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">D&gt;                                 </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看指定进程启动的线程 线程数受 max user processes 限制</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ps</span><span style="color:#98C379;--shiki-dark:#98C379;"> uxm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">wc</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                 # 查看当前用户占用的进程数 [包括线程]  max user processes</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">top</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;">  PID</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -H</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                # 查看指定PID进程及线程</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lsof</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">wc</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                   # 查看当前文件句柄数使用数量  open files</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lsof</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> /lib</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                               # 查看加载库文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sysctl</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                     # 查看当前所有系统内核参数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sysctl</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                     # 修改内核参数/etc/sysctl.conf，让/etc/rc.d/rc.sysinit读取生效</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">strace</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> pid</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                 # 跟踪系统调用</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ps</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -eo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;%p %C  %z  %a&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sort</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -k3</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 把进程按内存使用大小排序</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">strace</span><span style="color:#98C379;--shiki-dark:#98C379;"> uptime</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 2&gt;&amp;1|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> open</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 查看命令打开的相关文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> Hugepagesize</span><span style="color:#98C379;--shiki-dark:#98C379;"> /proc/meminfo</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 内存分页大小</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mkpasswd</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 8</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  -C</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -c</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 4</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 随机生成指定类型密码</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">/proc/sys/net/ipv4/tcp_syncookies</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 使TCP SYN Cookie 保护生效  # &quot;SYN Attack&quot;是一种拒绝服务的攻击方式</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> Swap</span><span style="color:#98C379;--shiki-dark:#98C379;">  /proc/25151/smaps</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{a+=$2}END{print a}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 查询某pid使用的swap大小</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redir</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --lport=33060</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --caddr=10.10.10.78</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --cport=3306</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 端口映射 yum安装 用supervisor守护</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="开机启动脚本顺序" tabindex="-1"><a class="header-anchor" href="#开机启动脚本顺序"><span>开机启动脚本顺序</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/etc/profile</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/etc/profile.d/*.sh</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">~/bash_profile</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">~/.bashrc</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/etc/bashrc</span></span></code></pre></div><h3 id="进程管理" tabindex="-1"><a class="header-anchor" href="#进程管理"><span>进程管理</span></a></h3><h4 id="常用" tabindex="-1"><a class="header-anchor" href="#常用"><span>常用</span></a></h4><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ps</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -eaf</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 查看所有进程</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">kill</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -9</span><span style="color:#98C379;--shiki-dark:#98C379;"> PID</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 强制终止某个PID进程</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">kill</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -15</span><span style="color:#98C379;--shiki-dark:#98C379;"> PID</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 安全退出 需程序内部处理信号</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cmd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &amp;                 </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 命令后台运行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">nohup</span><span style="color:#98C379;--shiki-dark:#98C379;"> cmd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &amp;           </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 后台运行不受shell退出影响</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ctrl+z</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 将前台放入后台(暂停)</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">jobs</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 查看后台运行程序</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">bg</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 启动后台暂停进程</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">fg</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 调回后台进程</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">pstree</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 进程树</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">vmstat</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 9</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 每隔一秒报告系统性能信息9次</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sar</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 查看cpu等状态</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lsof</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 显示打开指定文件的所有进程</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lsof</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i:32768</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 查看端口的进程</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">renice</span><span style="color:#98C379;--shiki-dark:#98C379;"> +1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 180</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 把180号进程的优先级加1</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">exec</span><span style="color:#98C379;--shiki-dark:#98C379;"> sh</span><span style="color:#98C379;--shiki-dark:#98C379;"> a.sh</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 子进程替换原来程序的pid， 避免supervisor无法强制杀死进程</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="top" tabindex="-1"><a class="header-anchor" href="#top"><span>top</span></a></h4><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">前五行是系统整体的统计信息。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">第一行:</span><span style="color:#98C379;--shiki-dark:#98C379;"> 任务队列信息，同</span><span style="color:#98C379;--shiki-dark:#98C379;"> uptime</span><span style="color:#98C379;--shiki-dark:#98C379;"> 命令的执行结果。内容如下：</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    01:06:48</span><span style="color:#98C379;--shiki-dark:#98C379;"> 当前时间</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    up</span><span style="color:#98C379;--shiki-dark:#98C379;"> 1:22</span><span style="color:#98C379;--shiki-dark:#98C379;"> 系统运行时间，格式为时:分</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    1</span><span style="color:#98C379;--shiki-dark:#98C379;"> user</span><span style="color:#98C379;--shiki-dark:#98C379;"> 当前登录用户数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    load</span><span style="color:#98C379;--shiki-dark:#98C379;"> average:</span><span style="color:#98C379;--shiki-dark:#98C379;"> 0.06,</span><span style="color:#98C379;--shiki-dark:#98C379;"> 0.60,</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0.48</span><span style="color:#98C379;--shiki-dark:#98C379;"> 系统负载，即任务队列的平均长度。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    三个数值分别为</span><span style="color:#98C379;--shiki-dark:#98C379;"> 1分钟、5分钟、15分钟前到现在的平均值。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">第二、三行:为进程和CPU的信息。当有多个CPU时，这些内容可能会超过两行。内容如下：</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    Tasks:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 29</span><span style="color:#98C379;--shiki-dark:#98C379;"> total</span><span style="color:#98C379;--shiki-dark:#98C379;"> 进程总数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    1</span><span style="color:#98C379;--shiki-dark:#98C379;"> running</span><span style="color:#98C379;--shiki-dark:#98C379;"> 正在运行的进程数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    28</span><span style="color:#98C379;--shiki-dark:#98C379;"> sleeping</span><span style="color:#98C379;--shiki-dark:#98C379;"> 睡眠的进程数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    0</span><span style="color:#98C379;--shiki-dark:#98C379;"> stopped</span><span style="color:#98C379;--shiki-dark:#98C379;"> 停止的进程数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    0</span><span style="color:#98C379;--shiki-dark:#98C379;"> zombie</span><span style="color:#98C379;--shiki-dark:#98C379;"> 僵尸进程数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    Cpu(s</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">): 0.3% us 用户空间占用CPU百分比</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    1.0%</span><span style="color:#98C379;--shiki-dark:#98C379;"> sy</span><span style="color:#98C379;--shiki-dark:#98C379;"> 内核空间占用CPU百分比</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    0.0%</span><span style="color:#98C379;--shiki-dark:#98C379;"> ni</span><span style="color:#98C379;--shiki-dark:#98C379;"> 用户进程空间内改变过优先级的进程占用CPU百分比</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    98.7%</span><span style="color:#98C379;--shiki-dark:#98C379;"> id</span><span style="color:#98C379;--shiki-dark:#98C379;"> 空闲CPU百分比</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    0.0%</span><span style="color:#98C379;--shiki-dark:#98C379;"> wa</span><span style="color:#98C379;--shiki-dark:#98C379;"> 等待输入输出的CPU时间百分比</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    0.0%</span><span style="color:#98C379;--shiki-dark:#98C379;"> hi</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    0.0%</span><span style="color:#98C379;--shiki-dark:#98C379;"> si</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">第四、五行:为内存信息。内容如下：</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    Mem:</span><span style="color:#98C379;--shiki-dark:#98C379;"> 191272k</span><span style="color:#98C379;--shiki-dark:#98C379;"> total</span><span style="color:#98C379;--shiki-dark:#98C379;"> 物理内存总量</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    173656k</span><span style="color:#98C379;--shiki-dark:#98C379;"> used</span><span style="color:#98C379;--shiki-dark:#98C379;"> 使用的物理内存总量</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    17616k</span><span style="color:#98C379;--shiki-dark:#98C379;"> free</span><span style="color:#98C379;--shiki-dark:#98C379;"> 空闲内存总量</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    22052k</span><span style="color:#98C379;--shiki-dark:#98C379;"> buffers</span><span style="color:#98C379;--shiki-dark:#98C379;"> 用作内核缓存的内存量</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    Swap:</span><span style="color:#98C379;--shiki-dark:#98C379;"> 192772k</span><span style="color:#98C379;--shiki-dark:#98C379;"> total</span><span style="color:#98C379;--shiki-dark:#98C379;"> 交换区总量</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    0k</span><span style="color:#98C379;--shiki-dark:#98C379;"> used</span><span style="color:#98C379;--shiki-dark:#98C379;"> 使用的交换区总量</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    192772k</span><span style="color:#98C379;--shiki-dark:#98C379;"> free</span><span style="color:#98C379;--shiki-dark:#98C379;"> 空闲交换区总量</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    123988k</span><span style="color:#98C379;--shiki-dark:#98C379;"> cached</span><span style="color:#98C379;--shiki-dark:#98C379;"> 缓冲的交换区总量。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    内存中的内容被换出到交换区，而后又被换入到内存，但使用过的交换区尚未被覆盖，</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    该数值即为这些内容已存在于内存中的交换区的大小。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    相应的内存再次被换出时可不必再对交换区写入。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">进程信息区,各列的含义如下:</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 显示各个进程的详细信息</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">序号</span><span style="color:#98C379;--shiki-dark:#98C379;"> 列名</span><span style="color:#98C379;--shiki-dark:#98C379;">    含义</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">a</span><span style="color:#98C379;--shiki-dark:#98C379;">   PID</span><span style="color:#98C379;--shiki-dark:#98C379;">      进程id</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">b</span><span style="color:#98C379;--shiki-dark:#98C379;">   PPID</span><span style="color:#98C379;--shiki-dark:#98C379;">     父进程id</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">c</span><span style="color:#98C379;--shiki-dark:#98C379;">   RUSER</span><span style="color:#98C379;--shiki-dark:#98C379;">    Real</span><span style="color:#98C379;--shiki-dark:#98C379;"> user</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">d</span><span style="color:#98C379;--shiki-dark:#98C379;">   UID</span><span style="color:#98C379;--shiki-dark:#98C379;">      进程所有者的用户id</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">e</span><span style="color:#98C379;--shiki-dark:#98C379;">   USER</span><span style="color:#98C379;--shiki-dark:#98C379;">     进程所有者的用户名</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">f</span><span style="color:#98C379;--shiki-dark:#98C379;">   GROUP</span><span style="color:#98C379;--shiki-dark:#98C379;">    进程所有者的组名</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">g</span><span style="color:#98C379;--shiki-dark:#98C379;">   TTY</span><span style="color:#98C379;--shiki-dark:#98C379;">      启动进程的终端名。不是从终端启动的进程则显示为</span><span style="color:#98C379;--shiki-dark:#98C379;"> ?</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">h</span><span style="color:#98C379;--shiki-dark:#98C379;">   PR</span><span style="color:#98C379;--shiki-dark:#98C379;">       优先级</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">i</span><span style="color:#98C379;--shiki-dark:#98C379;">   NI</span><span style="color:#98C379;--shiki-dark:#98C379;">       nice值。负值表示高优先级，正值表示低优先级</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">j</span><span style="color:#98C379;--shiki-dark:#98C379;">   P</span><span style="color:#98C379;--shiki-dark:#98C379;">        最后使用的CPU，仅在多CPU环境下有意义</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">k</span><span style="color:#98C379;--shiki-dark:#98C379;">   %CPU</span><span style="color:#98C379;--shiki-dark:#98C379;">     上次更新到现在的CPU时间占用百分比</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">l</span><span style="color:#98C379;--shiki-dark:#98C379;">   TIME</span><span style="color:#98C379;--shiki-dark:#98C379;">     进程使用的CPU时间总计，单位秒</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">m</span><span style="color:#98C379;--shiki-dark:#98C379;">   TIME+</span><span style="color:#98C379;--shiki-dark:#98C379;">    进程使用的CPU时间总计，单位1/100秒</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">n</span><span style="color:#98C379;--shiki-dark:#98C379;">   %MEM</span><span style="color:#98C379;--shiki-dark:#98C379;">     进程使用的物理内存百分比</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">o</span><span style="color:#98C379;--shiki-dark:#98C379;">   VIRT</span><span style="color:#98C379;--shiki-dark:#98C379;">     进程使用的虚拟内存总量，单位kb。VIRT=SWAP+RES</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">p</span><span style="color:#98C379;--shiki-dark:#98C379;">   SWAP</span><span style="color:#98C379;--shiki-dark:#98C379;">     进程使用的虚拟内存中，被换出的大小，单位kb。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">q</span><span style="color:#98C379;--shiki-dark:#98C379;">   RES</span><span style="color:#98C379;--shiki-dark:#98C379;">      进程使用的、未被换出的物理内存大小，单位kb。RES=CODE+DATA</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">r</span><span style="color:#98C379;--shiki-dark:#98C379;">   CODE</span><span style="color:#98C379;--shiki-dark:#98C379;">     可执行代码占用的物理内存大小，单位kb</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">s</span><span style="color:#98C379;--shiki-dark:#98C379;">   DATA</span><span style="color:#98C379;--shiki-dark:#98C379;">     可执行代码以外的部分</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">数据段+栈</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#98C379;--shiki-dark:#98C379;">占用的物理内存大小，单位kb</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">t</span><span style="color:#98C379;--shiki-dark:#98C379;">   SHR</span><span style="color:#98C379;--shiki-dark:#98C379;">      共享内存大小，单位kb</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">u</span><span style="color:#98C379;--shiki-dark:#98C379;">   nFLT</span><span style="color:#98C379;--shiki-dark:#98C379;">     页面错误次数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">v</span><span style="color:#98C379;--shiki-dark:#98C379;">   nDRT</span><span style="color:#98C379;--shiki-dark:#98C379;">     最后一次写入到现在，被修改过的页面数。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">w</span><span style="color:#98C379;--shiki-dark:#98C379;">   S</span><span style="color:#98C379;--shiki-dark:#98C379;">        进程状态。</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    D</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">不可中断的睡眠状态</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    R</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">运行</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    S</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">睡眠</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    T</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">跟踪/停止</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    Z</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">僵尸进程</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 父进程在但并不等待子进程</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">x</span><span style="color:#98C379;--shiki-dark:#98C379;">   COMMAND</span><span style="color:#98C379;--shiki-dark:#98C379;">  命令名/命令行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">y</span><span style="color:#98C379;--shiki-dark:#98C379;">   WCHAN</span><span style="color:#98C379;--shiki-dark:#98C379;">    若该进程在睡眠，则显示睡眠中的系统函数名</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">z</span><span style="color:#98C379;--shiki-dark:#98C379;">   Flags</span><span style="color:#98C379;--shiki-dark:#98C379;">    任务标志，参考</span><span style="color:#98C379;--shiki-dark:#98C379;"> sched.h</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ps" tabindex="-1"><a class="header-anchor" href="#ps"><span>ps</span></a></h4><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ps</span><span style="color:#98C379;--shiki-dark:#98C379;"> aux</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -v</span><span style="color:#98C379;--shiki-dark:#98C379;"> USER</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sort</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -nk</span><span style="color:#98C379;--shiki-dark:#98C379;"> +4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tail</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 显示消耗内存最多的10个运行中的进程，以内存使用量排序.cpu +3</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%CPU</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 进程的cpu占用率</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%MEM</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 进程的内存占用率</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">VSZ</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 进程虚拟大小,单位K(即总占用内存大小,包括真实内存和虚拟内存)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">RSS</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 进程使用的驻留集大小即实际物理内存大小</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">START</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 进程启动时间和日期</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">占用的虚拟内存大小</span><span style="color:#98C379;--shiki-dark:#98C379;"> =</span><span style="color:#98C379;--shiki-dark:#98C379;"> VSZ</span><span style="color:#98C379;--shiki-dark:#98C379;"> -</span><span style="color:#98C379;--shiki-dark:#98C379;"> RSS</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ps</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -eo</span><span style="color:#98C379;--shiki-dark:#98C379;"> pid,lstart,etime,args</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 查看进程启动时间</span></span></code></pre></div><h4 id="列出占用sawp的进程" tabindex="-1"><a class="header-anchor" href="#列出占用sawp的进程"><span>列出占用sawp的进程</span></a></h4><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;PID\\t\\tSwap\\t\\tProc_Name&quot;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 拿出/proc目录下所有以数字为名的目录（进程名是数字才是进程，其他如sys,net等存放的是其他信息）</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> pid</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span><span style="color:#98C379;--shiki-dark:#98C379;"> \`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ls</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#98C379;--shiki-dark:#98C379;"> /proc </span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> ^d </span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{ print $9 }&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -v</span><span style="color:#98C379;--shiki-dark:#98C379;"> [^0-9]\`</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 让进程释放swap的方法只有一个：就是重启该进程。或者等其自动释放。放</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 如果进程会自动释放，那么我们就不会写脚本来找他了，找他都是因为他没有自动释放。</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 所以我们要列出占用swap并需要重启的进程，但是init这个进程是系统里所有进程的祖先进程</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 重启init进程意味着重启系统，这是万万不可以的，所以就不必检测他了，以免对系统造成影响。</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$pid</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -eq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ];</span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> continue;</span><span style="color:#C678DD;--shiki-dark:#C678DD;">fi</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -q</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Swap&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> /proc/</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$pid</span><span style="color:#98C379;--shiki-dark:#98C379;">/smaps</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 2&gt;</span><span style="color:#98C379;--shiki-dark:#98C379;">/dev/null</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$?</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -eq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ];</span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        swap</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">$(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> Swap</span><span style="color:#98C379;--shiki-dark:#98C379;"> /proc/</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$pid</span><span style="color:#98C379;--shiki-dark:#98C379;">/smaps</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">gawk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{ sum+=$2;} END{ print sum }&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        proc_name</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">$(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ps</span><span style="color:#98C379;--shiki-dark:#98C379;"> aux</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -w</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$pid</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -v</span><span style="color:#98C379;--shiki-dark:#98C379;"> grep</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{ for(i=11;i&lt;=NF;i++){ printf(&quot;%s &quot;,$i); }}&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$swap</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -gt</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ];</span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            echo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">pid</span><span style="color:#98C379;--shiki-dark:#98C379;">}\\t\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">swap</span><span style="color:#98C379;--shiki-dark:#98C379;">}\\t\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">proc_name</span><span style="color:#98C379;--shiki-dark:#98C379;">}&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        fi</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    fi</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sort</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -k2</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -F</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;\\t&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    pid[NR]=$1;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    size[NR]=$2;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    name[NR]=$3;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">}</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">END{</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    for(id=1;id&lt;=length(pid);id++)</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        if(size[id]&lt;1024)</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            printf(&quot;%-10s\\t%15sKB\\t%s\\n&quot;,pid[id],size[id],name[id]);</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        else if(size[id]&lt;1048576)</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            printf(&quot;%-10s\\t%15.2fMB\\t%s\\n&quot;,pid[id],size[id]/1024,name[id]);</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        else</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            printf(&quot;%-10s\\t%15.2fGB\\t%s\\n&quot;,pid[id],size[id]/1048576,name[id]);</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">}&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="系统信号" tabindex="-1"><a class="header-anchor" href="#系统信号"><span>系统信号</span></a></h4><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">kill</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # 查看linux提供的信号</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">trap</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;echo aaa&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  2</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 15</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # shell使用 trap 捕捉退出信号</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 发送信号一般有两种原因:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#   1(被动式)  内核检测到一个系统事件.例如子进程退出会像父进程发送SIGCHLD信号.键盘按下control+c会发送SIGINT信号</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#   2(主动式)  通过系统调用kill来向指定进程发送信号</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 进程结束信号 SIGTERM 和 SIGKILL 的区别:  SIGTERM 比较友好，进程能捕捉这个信号，根据您的需要来关闭程序。在关闭程序之前，您可以结束打开的记录文件和完成正在做的任务。在某些情况下，假如进程正在进行作业而且不能中断，那么进程可以忽略这个SIGTERM信号。</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 如果一个进程收到一个SIGUSR1信号，然后执行信号绑定函数，第二个SIGUSR2信号又来了，第一个信号没有被处理完毕的话，第二个信号就会丢弃。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGHUP</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  1</span><span style="color:#98C379;--shiki-dark:#98C379;">          A</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 终端挂起或者控制进程终止</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGINT</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  2</span><span style="color:#98C379;--shiki-dark:#98C379;">          A</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 键盘终端进程(如control+c)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGQUIT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#98C379;--shiki-dark:#98C379;">          C</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 键盘的退出键被按下</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGILL</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  4</span><span style="color:#98C379;--shiki-dark:#98C379;">          C</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 非法指令</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGABRT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6</span><span style="color:#98C379;--shiki-dark:#98C379;">          C</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 由abort(3)发出的退出指令</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGFPE</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  8</span><span style="color:#98C379;--shiki-dark:#98C379;">          C</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 浮点异常</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGKILL</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 9</span><span style="color:#98C379;--shiki-dark:#98C379;">          AEF</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # Kill信号  立刻停止</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGSEGV</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 11</span><span style="color:#98C379;--shiki-dark:#98C379;">         C</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 无效的内存引用</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGPIPE</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 13</span><span style="color:#98C379;--shiki-dark:#98C379;">         A</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 管道破裂: 写一个没有读端口的管道</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGALRM</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 14</span><span style="color:#98C379;--shiki-dark:#98C379;">         A</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 闹钟信号 由alarm(2)发出的信号</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGTERM</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 15</span><span style="color:#98C379;--shiki-dark:#98C379;">         A</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 终止信号,可让程序安全退出 kill -15</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGUSR1</span><span style="color:#98C379;--shiki-dark:#98C379;"> 30,10,16</span><span style="color:#98C379;--shiki-dark:#98C379;">   A</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 用户自定义信号1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGUSR2</span><span style="color:#98C379;--shiki-dark:#98C379;"> 31,12,17</span><span style="color:#98C379;--shiki-dark:#98C379;">   A</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 用户自定义信号2</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGCHLD</span><span style="color:#98C379;--shiki-dark:#98C379;"> 20,17,18</span><span style="color:#98C379;--shiki-dark:#98C379;">   B</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 子进程结束自动向父进程发送SIGCHLD信号</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGCONT</span><span style="color:#98C379;--shiki-dark:#98C379;"> 19,18,25</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 进程继续（曾被停止的进程）</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGSTOP</span><span style="color:#98C379;--shiki-dark:#98C379;"> 17,19,23</span><span style="color:#98C379;--shiki-dark:#98C379;">   DEF</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 终止进程</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGTSTP</span><span style="color:#98C379;--shiki-dark:#98C379;"> 18,20,24</span><span style="color:#98C379;--shiki-dark:#98C379;">   D</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 控制终端（tty）上按下停止键</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGTTIN</span><span style="color:#98C379;--shiki-dark:#98C379;"> 21,21,26</span><span style="color:#98C379;--shiki-dark:#98C379;">   D</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 后台进程企图从控制终端读</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SIGTTOU</span><span style="color:#98C379;--shiki-dark:#98C379;"> 22,22,27</span><span style="color:#98C379;--shiki-dark:#98C379;">   D</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 后台进程企图从控制终端写</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">缺省处理动作一项中的字母含义如下:</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    A</span><span style="color:#98C379;--shiki-dark:#98C379;">  缺省的动作是终止进程</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    B</span><span style="color:#98C379;--shiki-dark:#98C379;">  缺省的动作是忽略此信号，将该信号丢弃，不做处理</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    C</span><span style="color:#98C379;--shiki-dark:#98C379;">  缺省的动作是终止进程并进行内核映像转储</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dump</span><span style="color:#98C379;--shiki-dark:#98C379;"> core</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#98C379;--shiki-dark:#98C379;">,内核映像转储是指将进程数据在内存的映像和进程在内核结构中的部分内容以一定格式转储到文件系统，并且进程退出执行，这样做的好处是为程序员提供了方便，使得他们可以得到进程当时执行时的数据值，允许他们确定转储的原因，并且可以调试他们的程序。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    D</span><span style="color:#98C379;--shiki-dark:#98C379;">  缺省的动作是停止进程，进入停止状况以后还能重新进行下去，一般是在调试的过程中（例如ptrace系统调用）</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    E</span><span style="color:#98C379;--shiki-dark:#98C379;">  信号不能被捕获</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    F</span><span style="color:#98C379;--shiki-dark:#98C379;">  信号不能被忽略</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="系统性能状态" tabindex="-1"><a class="header-anchor" href="#系统性能状态"><span>系统性能状态</span></a></h4><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">vmstat</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 9</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">r</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 等待执行的任务数。当这个值超过了cpu线程数，就会出现cpu瓶颈。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">b</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 等待IO的进程数量,表示阻塞的进程。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">swpd</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 虚拟内存已使用的大小，如大于0，表示机器物理内存不足，如不是程序内存泄露，那么该升级内存。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">free</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 空闲的物理内存的大小</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">buff</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 已用的buff大小，对块设备的读写进行缓冲</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cache</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # cache直接用来记忆我们打开的文件,给文件做缓冲，(把空闲的物理内存的一部分拿来做文件和目录的缓存，是为了提高 程序执行的性能，当程序使用内存时，buffer/cached会很快地被使用。)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">inact</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 非活跃内存大小，即被标明可回收的内存，区别于free和active -a选项时显示</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">active</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 活跃的内存大小 -a选项时显示</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">si</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 每秒从磁盘读入虚拟内存的大小，如果这个值大于0，表示物理内存不够用或者内存泄露，要查找耗内存进程解决掉。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">so</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 每秒虚拟内存写入磁盘的大小，如果这个值大于0，同上。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">bi</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 块设备每秒接收的块数量，这里的块设备是指系统上所有的磁盘和其他块设备，默认块大小是1024byte</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">bo</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 块设备每秒发送的块数量，例如读取文件，bo就要大于0。bi和bo一般都要接近0，不然就是IO过于频繁，需要调整。</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">in   </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 每秒CPU的中断次数，包括时间中断。in和cs这两个值越大，会看到由内核消耗的cpu时间会越多</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cs</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 每秒上下文切换次数，例如我们调用系统函数，就要进行上下文切换，线程的切换，也要进程上下文切换，这个值要越小越好，太大了，要考虑调低线程或者进程的数目,例如在apache和nginx这种web服务器中，我们一般做性能测试时会进行几千并发甚至几万并发的测试，选择web服务器的进程可以由进程或者线程的峰值一直下调，压测，直到cs到一个比较小的值，这个进程和线程数就是比较合适的值了。系统调用也是，每次调用系统函数，我们的代码就会进入内核空间，导致上下文切换，这个是很耗资源，也要尽量避免频繁调用系统函数。上下文切换次数过多表示你的CPU大部分浪费在上下文切换，导致CPU干正经事的时间少了，CPU没有充分利用。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">us</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 用户进程执行消耗cpu时间(user time)  us的值比较高时，说明用户进程消耗的cpu时间多，但是如果长期超过50%的使用，那么我们就该考虑优化程序算法或其他措施</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sy</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 系统CPU时间，如果太高，表示系统调用时间长，例如是IO操作频繁。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">id</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 空闲 CPU时间，一般来说，id + us + sy = 100,一般认为id是空闲CPU使用率，us是用户CPU使用率，sy是系统CPU使用率。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">wt</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 等待IOCPU时间。Wa过高时，说明io等待比较严重，这可能是由于磁盘大量随机访问造成的，也有可能是磁盘的带宽出现瓶颈。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">如果</span><span style="color:#98C379;--shiki-dark:#98C379;"> r</span><span style="color:#98C379;--shiki-dark:#98C379;"> 经常大于4，且id经常少于40，表示cpu的负荷很重。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">如果</span><span style="color:#98C379;--shiki-dark:#98C379;"> pi</span><span style="color:#98C379;--shiki-dark:#98C379;"> po</span><span style="color:#98C379;--shiki-dark:#98C379;"> 长期不等于0，表示内存不足。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">如果</span><span style="color:#98C379;--shiki-dark:#98C379;"> b</span><span style="color:#98C379;--shiki-dark:#98C379;"> 队列经常大于3，表示io性能不好。</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="日志管理" tabindex="-1"><a class="header-anchor" href="#日志管理"><span>日志管理</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">history</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 历时命令默认1000条</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">HISTTIMEFORMAT</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;%Y-%m-%d %H:%M:%S &quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 让history命令显示具体时间</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">history</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  -c</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 清除记录命令</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $HOME</span><span style="color:#98C379;--shiki-dark:#98C379;">/.bash_history</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 历史命令记录文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lastb</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     # 列出登录系统失败的用户相关信息  清空二进制日志记录文件 echo &gt; /var/log/btmp</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">last</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                         # 查看登陆过的用户信息  清空二进制日志记录文件 echo &gt; /var/log/wtmp   默认打开乱码</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">who</span><span style="color:#98C379;--shiki-dark:#98C379;"> /var/log/wtmp</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 查看登陆过的用户信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lastlog</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 用户最后登录的时间</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tail</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -f</span><span style="color:#98C379;--shiki-dark:#98C379;"> /var/log/messages</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 系统日志</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tail</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -f</span><span style="color:#98C379;--shiki-dark:#98C379;"> /var/log/secure</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # ssh日志</span></span></code></pre></div><h3 id="selinux" tabindex="-1"><a class="header-anchor" href="#selinux"><span>selinux</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sestatus</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -v</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # 查看selinux状态</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getenforce</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     # 查看selinux模式</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">setenforce</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 设置selinux为宽容模式(可避免阻止一些操作)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">semanage</span><span style="color:#98C379;--shiki-dark:#98C379;"> port</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 查看selinux端口限制规则</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">semanage</span><span style="color:#98C379;--shiki-dark:#98C379;"> port</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> http_port_t</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> tcp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 8000</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 在selinux中注册端口类型</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">vi</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc/selinux/config</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # selinux配置文件</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">SELINUX</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">enfoceing</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 关闭selinux 把其修改为  SELINUX=disabled</span></span></code></pre></div><h3 id="系统信息" tabindex="-1"><a class="header-anchor" href="#系统信息"><span>系统信息</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">uname</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 查看Linux内核版本信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> /proc/version</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 查看内核版本</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc/issue</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 查看系统版本</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lsb_release</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 查看系统版本  需安装 centos-release</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">locale</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 列出所有语系</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">locale</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 当前环境变量中所有编码</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">hwclock</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 查看时间</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">who</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 当前在线用户</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">w</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     # 当前在线用户</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">whoami</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 查看当前用户名</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">logname</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 查看初始登陆用户名</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">uptime</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 查看服务器启动时间</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sar</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> DEV</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 查看网卡网速流量</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dmesg</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 显示开机信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lsmod</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 查看内核模块</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="硬件信息" tabindex="-1"><a class="header-anchor" href="#硬件信息"><span>硬件信息</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">more</span><span style="color:#98C379;--shiki-dark:#98C379;"> /proc/cpuinfo</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                       # 查看cpu信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lscpu</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                    # 查看cpu信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> /proc/cpuinfo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cut</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -f2</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">uniq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -c</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 查看cpu型号和逻辑核心数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getconf</span><span style="color:#98C379;--shiki-dark:#98C379;"> LONG_BIT</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                         # cpu运行的位数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> /proc/cpuinfo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;physical id&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sort</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">uniq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -c</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 物理cpu个数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> /proc/cpuinfo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> flags</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39; lm &#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">wc</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 结果大于0支持64位</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> /proc/cpuinfo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> flags</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                             # 查看cpu是否支持虚拟化   pae支持半虚拟化  IntelVT 支持全虚拟化</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">more</span><span style="color:#98C379;--shiki-dark:#98C379;"> /proc/meminfo</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                       # 查看内存信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dmidecode</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                # 查看全面硬件信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dmidecode</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Product Name&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                          # 查看服务器型号</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dmidecode</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -P</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A5</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Memory\\s+Device&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> Size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -v</span><span style="color:#98C379;--shiki-dark:#98C379;"> Range</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 查看内存插槽</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> /proc/mdstat</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                         # 查看软raid信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> /proc/scsi/scsi</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                      # 查看Dell硬raid信息(IBM、HP需要官方检测工具)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lspci</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                    # 查看硬件信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lspci</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> RAID</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                          # 查看是否支持raid</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lspci</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -vvv</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> Ethernet</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                # 查看网卡型号</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lspci</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -vvv</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> Kernel</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> driver</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 查看驱动模块</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">modinfo</span><span style="color:#98C379;--shiki-dark:#98C379;"> tg2</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                              # 查看驱动版本(驱动模块)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ethtool</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> em1</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                           # 查看网卡驱动版本</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ethtool</span><span style="color:#98C379;--shiki-dark:#98C379;"> em1</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                              # 查看网卡带宽</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="limits-conf" tabindex="-1"><a class="header-anchor" href="#limits-conf"><span>limits.conf</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">ulimit</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -SHn</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 65535</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 临时设置文件描述符大小 进程最大打开文件柄数 还有socket最大连接数, 等同配置 nofile</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">ulimit</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -SHu</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 65535</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 临时设置用户最大进程数</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">ulimit</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 查看</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/etc/security/limits.conf</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 文件描述符大小  open files</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># lsof |wc -l   查看当前文件句柄数使用数量</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">* soft nofile 16384         </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 设置太大，进程使用过多会把机器拖死</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">* hard nofile 32768</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 用户最大进程数  max user processes</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># echo $((\`ps uxm |wc -l\`-\`ps ux |wc -l\`))  查看当前用户占用的进程数 [包括线程]</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">user</span><span style="color:#98C379;--shiki-dark:#98C379;"> soft</span><span style="color:#98C379;--shiki-dark:#98C379;"> nproc</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 16384</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">user</span><span style="color:#98C379;--shiki-dark:#98C379;"> hard</span><span style="color:#98C379;--shiki-dark:#98C379;"> nproc</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 32768</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 如果/etc/security/limits.d/有配置文件，将会覆盖/etc/security/limits.conf里的配置</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 即/etc/security/limits.d/的配置文件里就不要有同样的参量设置</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/etc/security/limits.d/90-nproc.conf</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # centos6.3的默认这个文件会覆盖 limits.conf</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">user</span><span style="color:#98C379;--shiki-dark:#98C379;"> soft</span><span style="color:#98C379;--shiki-dark:#98C379;"> nproc</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 16384</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">user</span><span style="color:#98C379;--shiki-dark:#98C379;"> hard</span><span style="color:#98C379;--shiki-dark:#98C379;"> nproc</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 32768</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sysctl</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 修改配置文件后让系统生效</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="libc-so故障修复" tabindex="-1"><a class="header-anchor" href="#libc-so故障修复"><span>libc.so故障修复</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 由于升级glibc导致libc.so不稳定,突然报错,幸好还有未退出的终端</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep:</span><span style="color:#98C379;--shiki-dark:#98C379;"> error</span><span style="color:#98C379;--shiki-dark:#98C379;"> while</span><span style="color:#98C379;--shiki-dark:#98C379;"> loading</span><span style="color:#98C379;--shiki-dark:#98C379;"> shared</span><span style="color:#98C379;--shiki-dark:#98C379;"> libraries:</span><span style="color:#98C379;--shiki-dark:#98C379;"> /lib64/libc.so.6:</span><span style="color:#98C379;--shiki-dark:#98C379;"> ELF</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#98C379;--shiki-dark:#98C379;"> OS</span><span style="color:#98C379;--shiki-dark:#98C379;"> ABI</span><span style="color:#98C379;--shiki-dark:#98C379;"> invalid</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 看看当前系统有多少版本 libc.so</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ls</span><span style="color:#98C379;--shiki-dark:#98C379;"> /lib64/libc-[tab]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 更改环境变量指向其他 libc.so 文件测试</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">export</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> LD_PRELOAD</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">/</span><span style="color:#E06C75;--shiki-dark:#E06C75;">lib64</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">/</span><span style="color:#E06C75;--shiki-dark:#E06C75;">libc-2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E06C75;--shiki-dark:#E06C75;">7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.</span><span style="color:#E06C75;--shiki-dark:#E06C75;">so</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 如果不改变LD_PRELOAD变量,ln不能用,需要使用 /sbin/sln 命令做链接</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 当前如果好使了，在执行下面强制替换软链接。如不好使，测试其他版本的libc.so文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ln</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -f</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> /lib64/libc-2.7.so</span><span style="color:#98C379;--shiki-dark:#98C379;"> /lib64/libc.so.6</span></span></code></pre></div><h3 id="sudo" tabindex="-1"><a class="header-anchor" href="#sudo"><span>sudo</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> myPassword</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sudo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -S</span><span style="color:#98C379;--shiki-dark:#98C379;"> ls</span><span style="color:#98C379;--shiki-dark:#98C379;"> /tmp</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 直接输入sudo的密码非交互,从标准输入读取密码而不是终端设备</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">visudo</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                             # sudo命令权限添加  /etc/sudoers</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">用户</span><span style="color:#98C379;--shiki-dark:#98C379;">  别名</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">可用all</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#98C379;--shiki-dark:#98C379;">=NOPASSWD:命令1,命令2</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">user</span><span style="color:#98C379;--shiki-dark:#98C379;">  ALL=NOPASSWD:/bin/su</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 免root密码切换root身份</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">wangming</span><span style="color:#98C379;--shiki-dark:#98C379;"> linuxfan=NOPASSWD:/sbin/apache</span><span style="color:#98C379;--shiki-dark:#98C379;"> start,/sbin/apache</span><span style="color:#98C379;--shiki-dark:#98C379;"> restart</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">UserName</span><span style="color:#98C379;--shiki-dark:#98C379;"> ALL=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ALL</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">ALL</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">UserName</span><span style="color:#98C379;--shiki-dark:#98C379;"> ALL=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ALL</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">NOPASSWD:</span><span style="color:#98C379;--shiki-dark:#98C379;"> ALL</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">peterli</span><span style="color:#98C379;--shiki-dark:#98C379;">        ALL=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ALL</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)       </span><span style="color:#98C379;--shiki-dark:#98C379;">NOPASSWD:/sbin/service</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Defaults</span><span style="color:#98C379;--shiki-dark:#98C379;"> requiretty</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # sudo不允许后台运行,注释此行既允许</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Defaults</span><span style="color:#98C379;--shiki-dark:#98C379;"> !visiblepw</span></span></code></pre></div><h3 id="iptables" tabindex="-1"><a class="header-anchor" href="#iptables"><span>iptables</span></a></h3><div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>内建三个表：nat mangle 和 filter</span></span>
<span class="line"><span>filter预设规则表，有INPUT、FORWARD 和 OUTPUT 三个规则链</span></span>
<span class="line"><span>vi /etc/sysconfig/iptables    # 配置文件</span></span>
<span class="line"><span>INPUT    # 进入</span></span>
<span class="line"><span>FORWARD  # 转发</span></span>
<span class="line"><span>OUTPUT   # 出去</span></span>
<span class="line"><span>ACCEPT   # 将封包放行</span></span>
<span class="line"><span>REJECT   # 拦阻该封包</span></span>
<span class="line"><span>DROP     # 丢弃封包不予处理</span></span>
<span class="line"><span>-A       # 在所选择的链(INPUT等)末添加一条或更多规则</span></span>
<span class="line"><span>-D       # 删除一条</span></span>
<span class="line"><span>-E       # 修改</span></span>
<span class="line"><span>-p       # tcp、udp、icmp    0相当于所有all    !取反</span></span>
<span class="line"><span>-P       # 设置缺省策略(与所有链都不匹配强制使用此策略)</span></span>
<span class="line"><span>-s       # IP/掩码    (IP/24)    主机名、网络名和清楚的IP地址 !取反</span></span>
<span class="line"><span>-j       # 目标跳转，立即决定包的命运的专用内建目标</span></span>
<span class="line"><span>-i       # 进入的（网络）接口 [名称] eth0</span></span>
<span class="line"><span>-o       # 输出接口[名称]</span></span>
<span class="line"><span>-m       # 模块</span></span>
<span class="line"><span>--sport  # 源端口</span></span>
<span class="line"><span>--dport  # 目标端口</span></span>
<span class="line"><span></span></span>
<span class="line"><span>iptables -F                        # 将防火墙中的规则条目清除掉  # 注意: iptables -P INPUT ACCEPT</span></span>
<span class="line"><span>iptables-restore &lt; 规则文件        # 导入防火墙规则</span></span>
<span class="line"><span>/etc/init.d/iptables save          # 保存防火墙设置</span></span>
<span class="line"><span>/etc/init.d/iptables restart       # 重启防火墙服务</span></span>
<span class="line"><span>iptables -L -n                     # 查看规则</span></span>
<span class="line"><span>iptables -t nat -nL                # 查看转发</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="iptables实例" tabindex="-1"><a class="header-anchor" href="#iptables实例"><span>iptables实例</span></a></h4><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -L</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 列出某规则链中的所有规则</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -X</span><span style="color:#98C379;--shiki-dark:#98C379;"> allowed</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 删除某个规则链 ,不加规则链，清除所有非内建的</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -Z</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 将封包计数器归零</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -N</span><span style="color:#98C379;--shiki-dark:#98C379;"> allowed</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 定义新的规则链</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -P</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#98C379;--shiki-dark:#98C379;"> DROP</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 定义过滤政策</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 192.168.1.1</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 比对封包的来源IP   # ! 192.168.0.0/24  ! 反向对比</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 192.168.1.1</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 比对封包的目的地IP</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> eth0</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 比对封包是从哪片网卡进入</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> FORWARD</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -o</span><span style="color:#98C379;--shiki-dark:#98C379;"> eth0</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 比对封包要从哪片网卡送出 eth+表示所有的网卡</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> tcp</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # -p ! tcp 排除tcp以外的udp、icmp。-p all所有类型</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -D</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 8</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 从某个规则链中删除一条规则</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -D</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --dport</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 80</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> DROP</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 从某个规则链中删除一条规则</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -R</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 8</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 192.168.0.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> DROP</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 取代现行规则</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -I</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 8</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --dport</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 80</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> ACCEPT</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 插入一条规则</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> eth0</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> DROP</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 其它情况不允许</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> tcp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> IP</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> DROP</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 禁止指定IP访问</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> tcp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> IP</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --dport</span><span style="color:#98C379;--shiki-dark:#98C379;"> port</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> DROP</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 禁止指定IP访问端口</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> IP</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> tcp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --dport</span><span style="color:#98C379;--shiki-dark:#98C379;"> port</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> ACCEPT</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 允许在IP访问指定端口</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> tcp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --dport</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 22</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> DROP</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 禁止使用某端口</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> eth0</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> icmp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -m</span><span style="color:#98C379;--shiki-dark:#98C379;"> icmp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --icmp-type</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 8</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> DROP</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 禁止icmp端口</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> eth0</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> icmp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> DROP</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                         # 禁止icmp端口</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> filter</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> eth0</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> tcp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --syn</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> DROP</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 阻止所有没有经过你系统授权的TCP连接</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -f</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -m</span><span style="color:#98C379;--shiki-dark:#98C379;"> limit</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --limit</span><span style="color:#98C379;--shiki-dark:#98C379;"> 100/s</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --limit-burst</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 100</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> ACCEPT</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # IP包流量限制</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> eth0</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> 192.168.62.1/32</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> icmp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -m</span><span style="color:#98C379;--shiki-dark:#98C379;"> icmp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --icmp-type</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 8</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> ACCEPT</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 除192.168.62.1外，禁止其它人ping我的主机</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> tcp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -m</span><span style="color:#98C379;--shiki-dark:#98C379;"> tcp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --dport</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 80</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -m</span><span style="color:#98C379;--shiki-dark:#98C379;"> state</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --state</span><span style="color:#98C379;--shiki-dark:#98C379;"> NEW</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -m</span><span style="color:#98C379;--shiki-dark:#98C379;"> recent</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --update</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --seconds</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 5</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --hitcount</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 20</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --rttl</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --name</span><span style="color:#98C379;--shiki-dark:#98C379;"> WEB</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --rsource</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> DROP</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 可防御cc攻击(未测试)</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="常用配置实例" tabindex="-1"><a class="header-anchor" href="#常用配置实例"><span>常用配置实例</span></a></h4><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 允许某段IP访问任何端口</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> 192.168.0.3/24</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> tcp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> ACCEPT</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 设定预设规则 (拒绝所有的数据包，再允许需要的,如只做WEB服务器.还是推荐三个链都是DROP)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -P</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#98C379;--shiki-dark:#98C379;"> DROP</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -P</span><span style="color:#98C379;--shiki-dark:#98C379;"> FORWARD</span><span style="color:#98C379;--shiki-dark:#98C379;"> DROP</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -P</span><span style="color:#98C379;--shiki-dark:#98C379;"> OUTPUT</span><span style="color:#98C379;--shiki-dark:#98C379;"> ACCEPT</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 注意: 直接设置这三条会掉线</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 开启22端口</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> tcp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --dport</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 22</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> ACCEPT</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 如果OUTPUT 设置成DROP的，要写上下面一条</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> OUTPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> tcp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --sport</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 22</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> ACCEPT</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 注:不写导致无法SSH.其他的端口一样,OUTPUT设置成DROP的话,也要添加一条链</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 如果开启了web服务器,OUTPUT设置成DROP的话,同样也要添加一条链</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> OUTPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> tcp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --sport</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 80</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> ACCEPT</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 做WEB服务器,开启80端口 ,其他同理</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> tcp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --dport</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 80</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> ACCEPT</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 做邮件服务器,开启25,110端口</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> tcp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --dport</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 110</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> ACCEPT</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> tcp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --dport</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 25</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> ACCEPT</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 允许icmp包通过,允许ping</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> OUTPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> icmp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> ACCEPT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (OUTPUT设置成DROP的话)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> icmp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> ACCEPT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  (INPUT设置成DROP的话)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 允许loopback!(不然会导致DNS无法正常关闭等问题)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">IPTABLES</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> INPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> lo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> all</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> ACCEPT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (如果是INPUT </span><span style="color:#98C379;--shiki-dark:#98C379;">DROP</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">IPTABLES</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> OUTPUT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -o</span><span style="color:#98C379;--shiki-dark:#98C379;"> lo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> all</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> ACCEPT</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">如果是OUTPUT</span><span style="color:#98C379;--shiki-dark:#98C379;"> DROP</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="网段转发" tabindex="-1"><a class="header-anchor" href="#网段转发"><span>网段转发</span></a></h4><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span># 例如通过vpn上网</span></span>
<span class="line"><span>echo 1 &gt; /proc/sys/net/ipv4/ip_forward       # 在内核里打开ip转发功能</span></span>
<span class="line"><span>iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -j MASQUERADE  # 添加网段转发</span></span>
<span class="line"><span>iptables -t nat -A POSTROUTING -s 10.0.0.0/255.0.0.0 -o eth0 -j SNAT --to 192.168.10.158  # 原IP网段经过哪个网卡IP出去</span></span>
<span class="line"><span>iptables -t nat -nL                # 查看转发</span></span></code></pre></div><h4 id="端口映射" tabindex="-1"><a class="header-anchor" href="#端口映射"><span>端口映射</span></a></h4><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 内网通过有外网IP的机器映射端口</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 内网主机添加路由</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">route</span><span style="color:#98C379;--shiki-dark:#98C379;"> add</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -net</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10.10.20.0</span><span style="color:#98C379;--shiki-dark:#98C379;"> netmask</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 255.255.255.0</span><span style="color:#98C379;--shiki-dark:#98C379;"> gw</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10.10.20.111</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 内网需要添加默认网关，并且网关开启转发</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 网关主机</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">/proc/sys/net/ipv4/ip_forward</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 在内核里打开ip转发功能</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> nat</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> PREROUTING</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> 外网IP</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> tcp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --dport</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 9999</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> DNAT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --to</span><span style="color:#98C379;--shiki-dark:#98C379;"> 10.10.20.55:22</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 进入</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> nat</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#98C379;--shiki-dark:#98C379;"> POSTROUTING</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> 10.10.20.0/24</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> SNAT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --to</span><span style="color:#98C379;--shiki-dark:#98C379;"> 外网IP</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                         # 转发回去</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptables</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> nat</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -nL</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 查看转发</span></span></code></pre></div><h2 id="网络" tabindex="-1"><a class="header-anchor" href="#网络"><span>网络</span></a></h2><h3 id="常用-1" tabindex="-1"><a class="header-anchor" href="#常用-1"><span>常用</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rz</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                                    # 通过ssh上传小文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sz</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                                    # 通过ssh下载小文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ifconfig</span><span style="color:#98C379;--shiki-dark:#98C379;"> eth0</span><span style="color:#98C379;--shiki-dark:#98C379;"> down</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                    # 禁用网卡</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ifconfig</span><span style="color:#98C379;--shiki-dark:#98C379;"> eth0</span><span style="color:#98C379;--shiki-dark:#98C379;"> up</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                      # 启用网卡</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ifup</span><span style="color:#98C379;--shiki-dark:#98C379;"> eth0:0</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                           # 启用网卡</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mii-tool</span><span style="color:#98C379;--shiki-dark:#98C379;"> em1</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                          # 查看网线是否连接</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">traceroute</span><span style="color:#98C379;--shiki-dark:#98C379;"> www.baidu.com</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                              # 测试跳数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">vi</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc/resolv.conf</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                   # 设置DNS  nameserver IP 定义DNS服务器的IP地址</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">nslookup</span><span style="color:#98C379;--shiki-dark:#98C379;"> www.moon.com</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                 # 解析域名IP</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dig</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -x</span><span style="color:#98C379;--shiki-dark:#98C379;"> www.baidu.com</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                  # 解析域名IP</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dig</span><span style="color:#98C379;--shiki-dark:#98C379;"> +trace</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> A</span><span style="color:#98C379;--shiki-dark:#98C379;"> domainname</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                            # 跟踪dns</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dig</span><span style="color:#98C379;--shiki-dark:#98C379;"> +short</span><span style="color:#98C379;--shiki-dark:#98C379;"> txt</span><span style="color:#98C379;--shiki-dark:#98C379;"> hacker.wp.dg.cx</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                        # 通过 DNS 来读取 Wikipedia 的hacker词条</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">host</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> txt</span><span style="color:#98C379;--shiki-dark:#98C379;"> hacker.wp.dg.cx</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                           # 通过 DNS 来读取 Wikipedia 的hacker词条</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lynx</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                                  # 文本上网</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">wget</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -P</span><span style="color:#98C379;--shiki-dark:#98C379;"> path</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -O</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#98C379;--shiki-dark:#98C379;"> url</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                              # 下载  包名:wgetrc   -q 安静 -c 续传</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dhclient</span><span style="color:#98C379;--shiki-dark:#98C379;"> eth1</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                         # 自动获取IP</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mtr</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -r</span><span style="color:#98C379;--shiki-dark:#98C379;"> www.baidu.com</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                  # 测试网络链路节点响应时间 # trace ping 结合</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ipcalc</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -m</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$ip</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$num</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                             # 根据IP和主机最大数计算掩码</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">curl</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -I</span><span style="color:#98C379;--shiki-dark:#98C379;"> www.baidu.com</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                 # 查看网页http头</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">curl</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> www.baidu.com</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                 # 不显示进度</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">queryperf</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> list</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> DNS_IP</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                      # BIND自带DNS压力测试  [list 文件格式:www.turku.fi A]</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">telnet</span><span style="color:#98C379;--shiki-dark:#98C379;"> ip</span><span style="color:#98C379;--shiki-dark:#98C379;"> port</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                        # 测试端口是否开放,有些服务可直接输入命令得到返回状态</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;show &quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">nc</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $ip</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $port</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                            # 适用于telnet一类登录得到命令返回</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">nc</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> port</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                                         # 监听指定端口</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">nc</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -nv</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -z</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10.10.10.11</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1080</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> succeeded</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                            # 检查主机端口是否开放</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">curl</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -o</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/null</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -m</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --connect-timeout</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -w</span><span style="color:#98C379;--shiki-dark:#98C379;"> %{http_code}</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $URL</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 检查页面状态</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">curl</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -X</span><span style="color:#98C379;--shiki-dark:#98C379;"> POST</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;user=xuesong&amp;pwd=123&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> http://www.abc.cn/Result</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 提交POST请求</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">curl</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> http://20140507.ip138.com/ic.asp</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                              # 通过IP138取本机出口外网IP</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">curl</span><span style="color:#98C379;--shiki-dark:#98C379;"> http://IP/</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -H</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;X-Forwarded-For: ip&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -H</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Host: www.ttlsa.com&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 连到指定IP的响应主机,HTTPserver只看 Host字段</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ifconfig</span><span style="color:#98C379;--shiki-dark:#98C379;"> eth0:0</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 192.168.1.221</span><span style="color:#98C379;--shiki-dark:#98C379;"> netmask</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 255.255.255.0</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 增加逻辑IP地址</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">/proc/sys/net/ipv4/icmp_echo_ignore_all</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 禁ping</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">net</span><span style="color:#98C379;--shiki-dark:#98C379;"> rpc</span><span style="color:#98C379;--shiki-dark:#98C379;"> shutdown</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -I</span><span style="color:#98C379;--shiki-dark:#98C379;"> IP_ADDRESS</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -U</span><span style="color:#98C379;--shiki-dark:#98C379;"> username%password</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 远程关掉一台WINDOWS机器</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">wget</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --random-wait</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -r</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> robots=off</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -U</span><span style="color:#98C379;--shiki-dark:#98C379;"> Mozilla</span><span style="color:#98C379;--shiki-dark:#98C379;"> www.example.com</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 递归方式下载整个网站</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sshpass</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$pwd</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> rsync</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -avzP</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dir</span><span style="color:#98C379;--shiki-dark:#98C379;">  user@</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$IP</span><span style="color:#98C379;--shiki-dark:#98C379;">:/dir/</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # 指定密码避免交互同步目录</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rsync</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -avzP</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --delete</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dir</span><span style="color:#98C379;--shiki-dark:#98C379;"> user@</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$IP</span><span style="color:#98C379;--shiki-dark:#98C379;">:/dir</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                               # 无差同步目录 可以快速清空大目录</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rsync</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -avzP</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;ssh -p 22 -e -o StrictHostKeyChecking=no&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dir</span><span style="color:#98C379;--shiki-dark:#98C379;"> user@</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$IP</span><span style="color:#98C379;--shiki-dark:#98C379;">:/dir</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 指定ssh参数同步</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="网卡流量查看" tabindex="-1"><a class="header-anchor" href="#网卡流量查看"><span>网卡流量查看</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">watch</span><span style="color:#98C379;--shiki-dark:#98C379;"> more</span><span style="color:#98C379;--shiki-dark:#98C379;"> /proc/net/dev</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 实时监控流量文件系统 累计值</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iptraf</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 网卡流量查看工具</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">nethogs</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 5</span><span style="color:#98C379;--shiki-dark:#98C379;"> eth0</span><span style="color:#98C379;--shiki-dark:#98C379;"> eth1</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 按进程实时统计网络流量 epel源nethogs</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iftop</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> eth0</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -P</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 实时流量监控</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sar</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-n参数有6个不同的开关:</span><span style="color:#98C379;--shiki-dark:#98C379;"> DEV</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">EDEV</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">NFS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">NFSD</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SOCK</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ALL</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">DEV显示网络接口信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">EDEV显示关于网络错误的统计数据</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">NFS统计活动的NFS客户端的信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">NFSD统计NFS服务器的信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SOCK显示套</span><span style="color:#98C379;--shiki-dark:#98C379;"> 接字信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ALL显示所有5个开关</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sar</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> DEV</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rxpck/s</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 每秒钟接收的数据包</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">txpck/s</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 每秒钟发送的数据包</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rxbyt/s</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 每秒钟接收的字节数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">txbyt/s</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 每秒钟发送的字节数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rxcmp/s</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 每秒钟接收的压缩数据包</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">txcmp/s</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 每秒钟发送的压缩数据包</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rxmcst/s</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 每秒钟接收的多播数据包</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ss" tabindex="-1"><a class="header-anchor" href="#ss"><span>ss</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># netstat是遍历/proc下面每个PID目录，ss直接读/proc/net下面的统计信息。所以ss执行的时候消耗资源以及消耗的时间都比netstat少很多</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ss</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                          # 列出当前socket详细信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ss</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                          # 显示本地打开的所有端口</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ss</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -tnlp</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 显示每个进程具体打开的socket</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ss</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -ant</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 显示所有TCP socket</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ss</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -u</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 显示所有UDP Socekt</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ss</span><span style="color:#98C379;--shiki-dark:#98C379;"> dst</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 192.168.119.113</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 匹配远程地址</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ss</span><span style="color:#98C379;--shiki-dark:#98C379;"> dst</span><span style="color:#98C379;--shiki-dark:#98C379;"> 192.168.119.113:http</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 匹配远程地址和端口号</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ss</span><span style="color:#98C379;--shiki-dark:#98C379;"> dst</span><span style="color:#98C379;--shiki-dark:#98C379;"> 192.168.119.113:3844</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 匹配远程地址和端口号</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ss</span><span style="color:#98C379;--shiki-dark:#98C379;"> src</span><span style="color:#98C379;--shiki-dark:#98C379;"> 192.168.119.103:16021</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 匹配本地地址和端口号</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ss</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -o</span><span style="color:#98C379;--shiki-dark:#98C379;"> state</span><span style="color:#98C379;--shiki-dark:#98C379;"> established</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;( dport = :smtp or sport = :smtp )&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 显示所有已建立的SMTP连接</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ss</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -o</span><span style="color:#98C379;--shiki-dark:#98C379;"> state</span><span style="color:#98C379;--shiki-dark:#98C379;"> established</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;( dport = :http or sport = :http )&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 显示所有已建立的HTTP连接</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ss</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -x</span><span style="color:#98C379;--shiki-dark:#98C379;"> src</span><span style="color:#98C379;--shiki-dark:#98C379;"> /tmp/.X11-unix/</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">*</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 找出所有连接X服务器的进程</span></span></code></pre></div><h3 id="ssh" tabindex="-1"><a class="header-anchor" href="#ssh"><span>ssh</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ssh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 22</span><span style="color:#98C379;--shiki-dark:#98C379;"> user@192.168.1.209</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                            # 从linux ssh登录另一台linux</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ssh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 22</span><span style="color:#98C379;--shiki-dark:#98C379;"> root@192.168.1.209</span><span style="color:#98C379;--shiki-dark:#98C379;"> CMD</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 利用ssh操作远程主机</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">scp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -P</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 22</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#98C379;--shiki-dark:#98C379;"> root@ip:/dir</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                             # 把本地文件拷贝到远程主机</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">scp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 100000</span><span style="color:#98C379;--shiki-dark:#98C379;">  file</span><span style="color:#98C379;--shiki-dark:#98C379;"> root@ip:/dir</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 传输文件到远程，限制速度100M</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sshpass</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;pwd&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> ssh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> root@</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$IP</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;echo hello&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 指定密码远程操作</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ssh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -o</span><span style="color:#98C379;--shiki-dark:#98C379;"> StrictHostKeyChecking=no</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $IP</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     # ssh连接不提示yes</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ssh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;su -&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                           # 指定伪终端 客户端以交互模式工作</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">scp</span><span style="color:#98C379;--shiki-dark:#98C379;"> root@192.168.1.209:/RemoteDir</span><span style="color:#98C379;--shiki-dark:#98C379;"> /localDir</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 把远程指定文件拷贝到本地</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">pscp</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -h</span><span style="color:#98C379;--shiki-dark:#98C379;"> host.ip</span><span style="color:#98C379;--shiki-dark:#98C379;"> /a.sh</span><span style="color:#98C379;--shiki-dark:#98C379;"> /opt/sbin/</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 批量传输文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ssh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -N</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -L2001:remotehost:80</span><span style="color:#98C379;--shiki-dark:#98C379;"> user@somemachine</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 用SSH创建端口转发通道</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ssh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> host_A</span><span style="color:#98C379;--shiki-dark:#98C379;"> ssh</span><span style="color:#98C379;--shiki-dark:#98C379;"> host_B</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                # 嵌套使用SSH</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ssh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 22</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $user</span><span style="color:#98C379;--shiki-dark:#98C379;">@</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Ip</span><span style="color:#98C379;--shiki-dark:#98C379;"> /bin/su</span><span style="color:#98C379;--shiki-dark:#98C379;"> -</span><span style="color:#98C379;--shiki-dark:#98C379;"> root</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -c</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Cmd</span><span style="color:#98C379;--shiki-dark:#98C379;">}</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;        </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 远程su执行命令 Cmd=&quot;\\&quot;/sbin/ifconfig eth0\\&quot;&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ssh-keygen</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> rsa</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                       # 生成密钥</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ssh-copy-id</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> xuesong@10.10.10.133</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     # 传送key</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">vi</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $HOME</span><span style="color:#98C379;--shiki-dark:#98C379;">/.ssh/authorized_keys</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                           # 公钥存放位置</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sshfs</span><span style="color:#98C379;--shiki-dark:#98C379;"> name@server:/path/to/folder</span><span style="color:#98C379;--shiki-dark:#98C379;"> /path/to/mount/point</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 通过ssh挂载远程主机上的文件夹</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">fusermount</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -u</span><span style="color:#98C379;--shiki-dark:#98C379;"> /path/to/mount/point</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 卸载ssh挂载的目录</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ssh</span><span style="color:#98C379;--shiki-dark:#98C379;"> user@host</span><span style="color:#98C379;--shiki-dark:#98C379;"> cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> /path/to/remotefile</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">diff</span><span style="color:#98C379;--shiki-dark:#98C379;"> /path/to/localfile</span><span style="color:#98C379;--shiki-dark:#98C379;"> -</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 用DIFF对比远程文件跟本地文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">su</span><span style="color:#98C379;--shiki-dark:#98C379;"> -</span><span style="color:#98C379;--shiki-dark:#98C379;"> user</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -c</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;ssh user@192.168.1.1 </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">echo -e aa |mail -s test mail@163.com</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 切换用户登录远程发送邮件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">pssh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -h</span><span style="color:#98C379;--shiki-dark:#98C379;"> ip.txt</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> uptime</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                # 批量执行ssh yum install pssh</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">SSH反向连接</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 外网A要控制内网B</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ssh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -NfR</span><span style="color:#98C379;--shiki-dark:#98C379;"> 1234:localhost:2223</span><span style="color:#98C379;--shiki-dark:#98C379;"> user1@123.123.123.123</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p22</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 将A主机的1234端口和B主机的2223端口绑定，相当于远程端口映射</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ss</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -ant</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 这时在A主机上sshd会listen本地1234端口</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># LISTEN     0    128    127.0.0.1:1234       *:*</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ssh</span><span style="color:#98C379;--shiki-dark:#98C379;"> localhost</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p1234</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 在A主机连接本地1234端口</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="路由" tabindex="-1"><a class="header-anchor" href="#路由"><span>路由</span></a></h3><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>route                           # 查看路由表</span></span>
<span class="line"><span>route add default  gw 192.168.1.1  dev eth0                        # 添加默认路由</span></span>
<span class="line"><span>route add -net 172.16.0.0 netmask 255.255.0.0 gw 10.39.111.254     # 添加静态路由网关</span></span>
<span class="line"><span>route del -net 172.16.0.0 netmask 255.255.0.0 gw 10.39.111.254     # 删除静态路由网关</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>    静态路由{</span></span>
<span class="line"><span></span></span>
<span class="line"><span>        vim /etc/sysconfig/static-routes</span></span>
<span class="line"><span>        any net 192.168.12.0/24 gw 192.168.0.254</span></span>
<span class="line"><span>        any net 192.168.13.0/24 gw 192.168.0.254</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    }</span></span></code></pre></div><h2 id="磁盘" tabindex="-1"><a class="header-anchor" href="#磁盘"><span>磁盘</span></a></h2><h3 id="常用-2" tabindex="-1"><a class="header-anchor" href="#常用-2"><span>常用</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">df</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -Ph</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                          # 查看硬盘容量</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">df</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -T</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                           # 查看磁盘分区格式</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">df</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                           # 查看inode节点   如果inode用满后无法创建文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">du</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -h</span><span style="color:#98C379;--shiki-dark:#98C379;"> dir</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                       # 检测目录下所有文件大小</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">du</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -sh</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> *</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                        # 显示当前目录中子目录的大小</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mount</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                        # 查看分区挂载情况</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">fdisk</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                        # 查看磁盘分区状态</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">fdisk</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/hda3</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                 # 分区</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mkfs</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> ext3</span><span style="color:#98C379;--shiki-dark:#98C379;">  /dev/hda3</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                         # 格式化分区</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">fsck</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -y</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda6</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                               # 对文件系统修复</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lsof</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> delete</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                               # 释放进程占用磁盘空间  列出进程后，查看文件是否存在，不存在则kill掉此进程</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tmpwatch</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -afv</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#98C379;--shiki-dark:#98C379;">   /tmp</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                         # 删除10小时内未使用的文件  勿在重要目录使用</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> /proc/filesystems</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                           # 查看当前系统支持文件系统</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mount</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -o</span><span style="color:#98C379;--shiki-dark:#98C379;"> remount,rw</span><span style="color:#98C379;--shiki-dark:#98C379;"> /</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                           # 修改只读文件系统为读写</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">iotop</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                           # 进程占用磁盘IO情况   yum install iotop</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">smartctl</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -H</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                            # 检测硬盘状态  # yum install smartmontools</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">smartctl</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                            # 检测硬盘信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">smartctl</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                            # 检测所有信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">e2label</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda5</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                               # 查看卷标</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">e2label</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda5</span><span style="color:#98C379;--shiki-dark:#98C379;"> new-label</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     # 创建卷标</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ntfslabel</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -v</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda8</span><span style="color:#98C379;--shiki-dark:#98C379;"> new-label</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # NTFS添加卷标</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tune2fs</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -j</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                             # ext2分区转ext3分区</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tune2fs</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                             # 查看文件系统信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mke2fs</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -b</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2048</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda5</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 指定索引块大小</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dumpe2fs</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -h</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda5</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                           # 查看超级块的信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mount</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> iso9660</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/dvd</span><span style="color:#98C379;--shiki-dark:#98C379;">  /mnt</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 挂载光驱</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mount</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> ntfs-3g</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sdc1</span><span style="color:#98C379;--shiki-dark:#98C379;"> /media/yidong</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 挂载ntfs硬盘</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mount</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> nfs</span><span style="color:#98C379;--shiki-dark:#98C379;"> 10.0.0.3:/opt</span><span style="color:#98C379;--shiki-dark:#98C379;"> /images</span><span style="color:#98C379;--shiki-dark:#98C379;">  /data/img</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 挂载nfs 需要重载 /etc/init.d/nfs reload  重启需要先启动 portmap 服务</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mount</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -o</span><span style="color:#98C379;--shiki-dark:#98C379;"> loop</span><span style="color:#98C379;--shiki-dark:#98C379;">  /software/rhel4.6.iso</span><span style="color:#98C379;--shiki-dark:#98C379;">   /mnt/</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 挂载镜像文件</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="io系能" tabindex="-1"><a class="header-anchor" href="#io系能"><span>IO系能</span></a></h3><div class="language- line-numbers-mode" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>iostat -x 1 10</span></span>
<span class="line"><span></span></span>
<span class="line"><span>% user       # 显示了在用户级(应用程序)执行时生成的 CPU 使用率百分比。</span></span>
<span class="line"><span>% system     # 显示了在系统级(内核)执行时生成的 CPU 使用率百分比。</span></span>
<span class="line"><span>% idle       # 显示了在 CPU 空闲并且系统没有未完成的磁盘 I/O 请求时的时间百分比。</span></span>
<span class="line"><span>% iowait     # 显示了 CPU 空闲期间系统有未完成的磁盘 I/O 请求时的时间百分比。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>rrqm/s       # 每秒进行 merge 的读操作数目。即 delta(rmerge)/s</span></span>
<span class="line"><span>wrqm/s       # 每秒进行 merge 的写操作数目。即 delta(wmerge)/s</span></span>
<span class="line"><span>r/s          # 每秒完成的读 I/O 设备次数。即 delta(rio)/s</span></span>
<span class="line"><span>w/s          # 每秒完成的写 I/O 设备次数。即 delta(wio)/s</span></span>
<span class="line"><span>rsec/s       # 每秒读扇区数。即 delta(rsect)/s</span></span>
<span class="line"><span>wsec/s       # 每秒写扇区数。即 delta(wsect)/s</span></span>
<span class="line"><span>rkB/s        # 每秒读K字节数。是 rsect/s 的一半，因为每扇区大小为512字节。(需要计算)</span></span>
<span class="line"><span>wkB/s        # 每秒写K字节数。是 wsect/s 的一半。(需要计算)</span></span>
<span class="line"><span>avgrq-sz     # 平均每次设备I/O操作的数据大小 (扇区)。delta(rsect+wsect)/delta(rio+wio)</span></span>
<span class="line"><span>avgqu-sz     # 平均I/O队列长度。即 delta(aveq)/s/1000 (因为aveq的单位为毫秒)。</span></span>
<span class="line"><span>await        # 平均每次设备I/O操作的等待时间 (毫秒)。即 delta(ruse+wuse)/delta(rio+wio)</span></span>
<span class="line"><span>svctm        # 平均每次设备I/O操作的服务时间 (毫秒)。即 delta(use)/delta(rio+wio)</span></span>
<span class="line"><span>%util        # 一秒中有百分之多少的时间用于 I/O 操作，或者说一秒中有多少时间 I/O 队列是非空的。即 delta(use)/s/1000 (因为use的单位为毫秒)</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>标准</p><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>1、 如果 %util 接近 100%，说明产生的I/O请求太多，I/O系统已经满负荷，该磁盘可能存在瓶颈。</span></span>
<span class="line"><span>2、 idle 小于70% IO压力就较大了,一般读取速度有较多的wait.</span></span>
<span class="line"><span>3、 同时可以结合 vmstat 查看查看b参数(等待资源的进程数)和wa参数(IO等待所占用的CPU时间的百分比,高过30%时IO压力高)</span></span>
<span class="line"><span>4、 svctm 一般要小于 await (因为同时等待的请求的等待时间被重复计算了),svctm 的大小一般和磁盘性能有关,CPU/内存的负荷也会对其有影响,请求过多也会间接导致 svctm 的增加. await 的大小一般取决于服务时间(svctm) 以及 I/O 队列的长度和 I/O 请求的发出模式. 如果 svctm 比较接近 await,说明 I/O 几乎没有等待时间;如果 await 远大于 svctm,说明 I/O 队列太长,应用得到的响应时间变慢,如果响应时间超过了用户可以容许的范围,这时可以考虑更换更快的磁盘,调整内核 elevator 算法,优化应用,或者升级 CPU</span></span>
<span class="line"><span>5、 队列长度(avgqu-sz)也可作为衡量系统 I/O 负荷的指标，但由于 avgqu-sz 是按照单位时间的平均值，所以不能反映瞬间的 I/O 洪水。</span></span></code></pre></div><h3 id="iotop" tabindex="-1"><a class="header-anchor" href="#iotop"><span>iotop</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 监视进程磁盘I/O</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">yum</span><span style="color:#98C379;--shiki-dark:#98C379;"> install</span><span style="color:#98C379;--shiki-dark:#98C379;"> iotop</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-o</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 只显示有io操作的进程</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-b</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 批量显示，无交互，主要用作记录到文件。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-n</span><span style="color:#98C379;--shiki-dark:#98C379;"> NUM</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 显示NUM次，主要用于非交互式模式。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-d</span><span style="color:#98C379;--shiki-dark:#98C379;"> SEC</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 间隔SEC秒显示一次。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-p</span><span style="color:#98C379;--shiki-dark:#98C379;"> PID</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 监控的进程pid。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-u</span><span style="color:#98C379;--shiki-dark:#98C379;"> USER</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 监控的进程用户。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 左右箭头：改变排序方式，默认是按IO排序。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">r</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 改变排序顺序。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">o</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 只显示有IO输出的进程。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">p</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 进程/线程的显示方式的切换。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 显示累积使用量。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">q</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 退出。</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>创建swap文件</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dd</span><span style="color:#98C379;--shiki-dark:#98C379;"> if=/dev/zero</span><span style="color:#98C379;--shiki-dark:#98C379;"> of=/swap</span><span style="color:#98C379;--shiki-dark:#98C379;"> bs=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">1024</span><span style="color:#98C379;--shiki-dark:#98C379;"> count=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">4096000</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 创建一个足够大的文件</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># count的值等于1024 x 你想要的文件大小, 4096000是4G</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mkswap</span><span style="color:#98C379;--shiki-dark:#98C379;"> /swap</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 把这个文件变成swap文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">swapon</span><span style="color:#98C379;--shiki-dark:#98C379;"> /swap</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 启用这个swap文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/swap</span><span style="color:#98C379;--shiki-dark:#98C379;"> swap</span><span style="color:#98C379;--shiki-dark:#98C379;"> swap</span><span style="color:#98C379;--shiki-dark:#98C379;"> defaults</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 在每次开机的时候自动加载swap文件, 需要在 /etc/fstab 文件中增加一行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> /proc/swaps</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 查看swap</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">swapoff</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 关闭swap</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">swapon</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span></span></code></pre></div><h3 id="新硬盘挂载" tabindex="-1"><a class="header-anchor" href="#新硬盘挂载"><span>新硬盘挂载</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">fdisk</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sdc</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">p</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #  打印分区</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">d</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #  删除分区</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #  创建分区，（一块硬盘最多4个主分区，扩展占一个主分区位置。p主分区 e扩展）</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">w</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #  保存退出</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mkfs.ext4</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -L</span><span style="color:#98C379;--shiki-dark:#98C379;"> 卷标</span><span style="color:#98C379;--shiki-dark:#98C379;">  /dev/sdc1</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 格式化相应分区</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mount</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sdc1</span><span style="color:#98C379;--shiki-dark:#98C379;">  /mnt</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 挂载</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">vi</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc/fstab</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                          # 添加开机挂载分区</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">LABEL</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">/data</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">            /data</span><span style="color:#98C379;--shiki-dark:#98C379;">                   ext4</span><span style="color:#98C379;--shiki-dark:#98C379;">    defaults</span><span style="color:#D19A66;--shiki-dark:#D19A66;">        1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 用卷标挂载</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/dev/sdb1</span><span style="color:#98C379;--shiki-dark:#98C379;">              /data4</span><span style="color:#98C379;--shiki-dark:#98C379;">                  ext4</span><span style="color:#98C379;--shiki-dark:#98C379;">    defaults</span><span style="color:#D19A66;--shiki-dark:#D19A66;">        1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 用真实分区挂载</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/dev/sdb2</span><span style="color:#98C379;--shiki-dark:#98C379;">              /data4</span><span style="color:#98C379;--shiki-dark:#98C379;">                  ext4</span><span style="color:#98C379;--shiki-dark:#98C379;">    noatime,defaults</span><span style="color:#D19A66;--shiki-dark:#D19A66;">        1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">第一个数字</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;1&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">该选项被</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;dump&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">命令使用来检查一个文件系统应该以多快频率进行转储，若不需要转储就设置该字段为0</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">第二个数字</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;2&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">该字段被fsck命令用来决定在启动时需要被扫描的文件系统的顺序，根文件系统</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;/&quot;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">对应该字段的值应该为1，其他文件系统应该为2。若该文件系统无需在启动时扫描则设置该字段为0</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">当以</span><span style="color:#98C379;--shiki-dark:#98C379;"> noatime</span><span style="color:#98C379;--shiki-dark:#98C379;"> 选项加载（mount）文件系统时，对文件的读取不会更新文件属性中的atime信息。设置noatime的重要性是消除了文件系统对文件的写操作，文件只是简单地被系统读取。由于写操作相对读来说要更消耗系统资源，所以这样设置可以明显提高服务器的性能.wtime信息仍然有效，任何时候文件被写，该信息仍被更新。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mount</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 自动加载 fstab 文件挂载，避免配置错误，系统无法重启</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#centos6</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">fdisk</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">fdisk</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">n</span><span style="color:#98C379;--shiki-dark:#98C379;"> p</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#98C379;--shiki-dark:#98C379;"> enter</span><span style="color:#98C379;--shiki-dark:#98C379;"> enter</span><span style="color:#98C379;--shiki-dark:#98C379;">  w</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">partx</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">pvcreate</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda3</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">vgextend</span><span style="color:#98C379;--shiki-dark:#98C379;"> vg_centos6</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda3</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lvextend</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/vg_centos6/lv_root</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda3</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">resize2fs</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/vg_centos6/lv_root</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#centos7</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">fdisk</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">fdisk</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">n</span><span style="color:#98C379;--shiki-dark:#98C379;"> p</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#98C379;--shiki-dark:#98C379;"> enter</span><span style="color:#98C379;--shiki-dark:#98C379;"> enter</span><span style="color:#98C379;--shiki-dark:#98C379;"> t</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#98C379;--shiki-dark:#98C379;"> 8e</span><span style="color:#98C379;--shiki-dark:#98C379;"> w</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">partprobe</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mkfs</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> xfs</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda3</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">pvcreate</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda3</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">vgextend</span><span style="color:#98C379;--shiki-dark:#98C379;"> centos</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda3</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lvextend</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -L</span><span style="color:#98C379;--shiki-dark:#98C379;"> +399.99G</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/centos/root</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sda3</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">xfs_growfs</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/centos/root</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lvcreate</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#98C379;--shiki-dark:#98C379;"> 100%FREE</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/vg_adj</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">##添加硬盘不重启</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;- - -&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">/sys/class/scsi_host/host0/scan</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2t和16t分区" tabindex="-1"><a class="header-anchor" href="#_2t和16t分区"><span>2T和16T分区</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">parted</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sdb</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 针对磁盘分区</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">parted</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mklabel</span><span style="color:#98C379;--shiki-dark:#98C379;"> gpt</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 设置为 gpt</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">parted</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">print</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">parted</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mkpart</span><span style="color:#98C379;--shiki-dark:#98C379;">  primary</span><span style="color:#98C379;--shiki-dark:#98C379;"> 0KB</span><span style="color:#98C379;--shiki-dark:#98C379;"> 22.0TB</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 指定分区大小</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Is</span><span style="color:#98C379;--shiki-dark:#98C379;"> this</span><span style="color:#98C379;--shiki-dark:#98C379;"> still</span><span style="color:#98C379;--shiki-dark:#98C379;"> acceptable</span><span style="color:#98C379;--shiki-dark:#98C379;"> to</span><span style="color:#98C379;--shiki-dark:#98C379;"> you?</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Yes/No?</span><span style="color:#98C379;--shiki-dark:#98C379;"> Yes</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Ignore/Cancel?</span><span style="color:#98C379;--shiki-dark:#98C379;"> Ignore</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">parted</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">print</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Model:</span><span style="color:#98C379;--shiki-dark:#98C379;"> LSI</span><span style="color:#98C379;--shiki-dark:#98C379;"> MR9271-8i</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (scsi)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Disk</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sdb:</span><span style="color:#98C379;--shiki-dark:#98C379;"> 22.0TB</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Sector</span><span style="color:#98C379;--shiki-dark:#98C379;"> size</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (logical/physical): 512B/512B</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Partition</span><span style="color:#98C379;--shiki-dark:#98C379;"> Table:</span><span style="color:#98C379;--shiki-dark:#98C379;"> gpt</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Number</span><span style="color:#98C379;--shiki-dark:#98C379;">  Start</span><span style="color:#98C379;--shiki-dark:#98C379;">   End</span><span style="color:#98C379;--shiki-dark:#98C379;">     Size</span><span style="color:#98C379;--shiki-dark:#98C379;">    File</span><span style="color:#98C379;--shiki-dark:#98C379;"> system</span><span style="color:#98C379;--shiki-dark:#98C379;">  Name</span><span style="color:#98C379;--shiki-dark:#98C379;">     Flags</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="color:#98C379;--shiki-dark:#98C379;">      17.4kB</span><span style="color:#98C379;--shiki-dark:#98C379;">  22.0TB</span><span style="color:#98C379;--shiki-dark:#98C379;">  22.0TB</span><span style="color:#98C379;--shiki-dark:#98C379;">               primary</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">parted</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">quit</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mkfs.ext4</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sdb1</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # e2fsprogs升级后支持大于16T硬盘</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 大于16T的单个分区ext4格式化报错，需要升级e2fsprogs</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Size</span><span style="color:#98C379;--shiki-dark:#98C379;"> of</span><span style="color:#98C379;--shiki-dark:#98C379;"> device</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sdb1</span><span style="color:#98C379;--shiki-dark:#98C379;"> too</span><span style="color:#98C379;--shiki-dark:#98C379;"> big</span><span style="color:#98C379;--shiki-dark:#98C379;"> to</span><span style="color:#98C379;--shiki-dark:#98C379;"> be</span><span style="color:#98C379;--shiki-dark:#98C379;"> expressed</span><span style="color:#98C379;--shiki-dark:#98C379;"> in</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 32</span><span style="color:#98C379;--shiki-dark:#98C379;"> bits</span><span style="color:#98C379;--shiki-dark:#98C379;"> using</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#98C379;--shiki-dark:#98C379;"> blocksize</span><span style="color:#98C379;--shiki-dark:#98C379;"> of</span><span style="color:#98C379;--shiki-dark:#98C379;"> 4096.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">yum</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -y</span><span style="color:#98C379;--shiki-dark:#98C379;"> install</span><span style="color:#98C379;--shiki-dark:#98C379;"> xfsprogs</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mkfs.xfs</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -f</span><span style="color:#98C379;--shiki-dark:#98C379;"> /dev/sdb1</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 大于16T单个分区也可以使用XFS分区,但inode占用很大,对大量的小文件支持不太好</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="raid原理" tabindex="-1"><a class="header-anchor" href="#raid原理"><span>raid原理</span></a></h3><div class="language-" data-ext="" data-title=""><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span>        raid0至少2块硬盘.吞吐量大,性能好,同时读写,但损坏一个就完蛋</span></span>
<span class="line"><span>        raid1至少2块硬盘.相当镜像,一个存储,一个备份.安全性比较高.但是性能比0弱</span></span>
<span class="line"><span>        raid5至少3块硬盘.分别存储校验信息和数据，坏了一个根据校验信息能恢复</span></span>
<span class="line"><span>        raid6至少4块硬盘.两个独立的奇偶系统,可坏两块磁盘,写性能非常差</span></span></code></pre></div><h2 id="用户" tabindex="-1"><a class="header-anchor" href="#用户"><span>用户</span></a></h2><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">users</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                      # 显示所有的登录用户</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">groups</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                     # 列出当前用户和他所属的组</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">who</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -q</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                     # 显示所有的登录用户</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">groupadd</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                   # 添加组</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">useradd</span><span style="color:#98C379;--shiki-dark:#98C379;"> user</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                               # 建立用户</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">passwd</span><span style="color:#98C379;--shiki-dark:#98C379;"> username</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                            # 修改密码</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">userdel</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -r</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                 # 删除帐号及家目录</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">chown</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -R</span><span style="color:#98C379;--shiki-dark:#98C379;"> user:group</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 修改目录拥有者(R递归)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">chown</span><span style="color:#98C379;--shiki-dark:#98C379;"> y</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\.</span><span style="color:#98C379;--shiki-dark:#98C379;">li:mysql</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                          # 修改所有者用户中包含点&quot;.&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">umask</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                      # 设置用户文件和目录的文件创建缺省屏蔽值</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">chgrp</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                      # 修改用户组</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">finger</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                     # 查找用户显示信息</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;xuesong&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">passwd</span><span style="color:#98C379;--shiki-dark:#98C379;"> user</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --stdin</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 非交互修改密码</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">useradd</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -g</span><span style="color:#98C379;--shiki-dark:#98C379;"> www</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -M</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> /sbin/nologin</span><span style="color:#98C379;--shiki-dark:#98C379;">  www</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 指定组并不允许登录的用户,nologin允许使用服务</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">useradd</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -g</span><span style="color:#98C379;--shiki-dark:#98C379;"> www</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -M</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> /bin/</span><span style="color:#D19A66;--shiki-dark:#D19A66;">false</span><span style="color:#98C379;--shiki-dark:#98C379;">  www</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 指定组并不允许登录的用户,false最为严格</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">useradd</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> /data/song</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -g</span><span style="color:#98C379;--shiki-dark:#98C379;"> song</span><span style="color:#98C379;--shiki-dark:#98C379;"> song</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 创建用户并指定家目录和组</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">usermod</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#98C379;--shiki-dark:#98C379;"> newuser</span><span style="color:#98C379;--shiki-dark:#98C379;"> olduser</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 修改用户名</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">usermod</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -g</span><span style="color:#98C379;--shiki-dark:#98C379;"> user</span><span style="color:#98C379;--shiki-dark:#98C379;"> group</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 修改用户所属组</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">usermod</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> dir</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -m</span><span style="color:#98C379;--shiki-dark:#98C379;"> user</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     # 修改用户家目录</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">usermod</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -G</span><span style="color:#98C379;--shiki-dark:#98C379;"> group</span><span style="color:#98C379;--shiki-dark:#98C379;"> user</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 将用户添加到附加组</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">gpasswd</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> user</span><span style="color:#98C379;--shiki-dark:#98C379;"> group</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 从组中删除用户</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">su</span><span style="color:#98C379;--shiki-dark:#98C379;"> -</span><span style="color:#98C379;--shiki-dark:#98C379;"> user</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -c</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot; #cmd1; &quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # 切换用户执行</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="恢复密码" tabindex="-1"><a class="header-anchor" href="#恢复密码"><span>恢复密码</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 即进入单用户模式: 在linux出现grub后，在安装的系统上面按&quot;e&quot;，然后出现grub的配置文件，按键盘移动光标到第二行&quot;Ker……&quot;，再按&quot;e&quot;，然后在这一行的结尾加上：空格 single或者空格1回车，然后按&quot;b&quot;重启，就进入了&quot;单用户模式&quot;</span></span></code></pre></div><h3 id="特殊权限" tabindex="-1"><a class="header-anchor" href="#特殊权限"><span>特殊权限</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">s或</span><span style="color:#98C379;--shiki-dark:#98C379;"> S</span><span style="color:#98C379;--shiki-dark:#98C379;"> （SUID）：对应数值4</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">s或</span><span style="color:#98C379;--shiki-dark:#98C379;"> S</span><span style="color:#98C379;--shiki-dark:#98C379;"> （SGID）：对应数值2</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">t或</span><span style="color:#98C379;--shiki-dark:#98C379;"> T</span><span style="color:#98C379;--shiki-dark:#98C379;"> ：对应数值1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">大S：代表拥有root权限，但是没有执行权限</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">小s：拥有特权且拥有执行权限，这个文件可以访问系统任何root用户可以访问的资源</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">T或T（Sticky）：/tmp和</span><span style="color:#98C379;--shiki-dark:#98C379;"> /var/tmp目录供所有用户暂时存取文件，亦即每位用户皆拥有完整的权限进入该目录，去浏览、删除和移动文件</span></span></code></pre></div><h2 id="脚本" tabindex="-1"><a class="header-anchor" href="#脚本"><span>脚本</span></a></h2><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/sh                             # 在脚本第一行脚本头 # sh为当前系统默认shell,可指定为bash等shell</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">shopt</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                 # 显示和设置shell中的行为选项</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -x</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                 # 执行过程</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                 # 检查语法</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">set</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                # 若指令传回值不等于0，则立即退出shell</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#E06C75;--shiki-dark:#E06C75;">a</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">bbk</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)                               </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 括号创建子shell运行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">basename</span><span style="color:#98C379;--shiki-dark:#98C379;"> /a/b/c</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 从全路径中保留最后一层文件名或目录</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dirname</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                               # 取路径</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">$RANDOM</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                               # 随机数</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$$</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                    # 进程号</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">source</span><span style="color:#98C379;--shiki-dark:#98C379;"> FileName</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 在当前bash环境下读取并执行FileName中的命令  # 等同 . FileName</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sleep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 5</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                               # 间隔睡眠5秒</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">trap</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                  # 在接收到信号后将要采取的行动</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">trap</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                           # 禁止ctrl+c</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">$PWD</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                  # 当前目录</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">$HOME</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                 # 家目录</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">$OLDPWD</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                               # 之前一个目录的路径</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">cd</span><span style="color:#98C379;--shiki-dark:#98C379;"> -</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                  # 返回上一个目录路径</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">local</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> ret</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                             # 局部变量</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">yes</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                   # 重复打印</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">yes</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> *</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                          # 自动回答y或者其他</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ls</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> /home</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                           # 区分目录和文件夹</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ls</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> /home/</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                          # 查看匹配完整路径</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">time</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> a.sh                             </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 测试程序执行时间</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> aa</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> bb</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # 不换行执行下一句话 将字符串原样输出</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;s\\tss\\n\\n\\n&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 使转义生效</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $a</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cut</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -c2-6</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 取字符串中字元</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> {a,b,c}{a,b,c}{a,b,c}</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 排列组合(括号内一个元素分别和其他括号内元素组合)</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> $((</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2#11010</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">))                     </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 二进制转10进制</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> aaa</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tee</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 打印同时写入文件 默认覆盖 -a追加</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> {1..10}</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                          # 打印10个字符</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">printf</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;%10s\\n&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot; &quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 打印10个字符</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">pwd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -F/</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{ print $2 }&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 返回目录名</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tac</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> 1,3d</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tac</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 倒置读取文件  # 删除最后3行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tail</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -3</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                          # 取最后3行</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">outtmp</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">/tmp/</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$$</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">date</span><span style="color:#98C379;--shiki-dark:#98C379;"> +%s%N\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">.outtmp</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 临时文件定义</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(){ </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&amp; };</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                         # fork炸弹,系统执行海量的进程,直到系统僵死</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\\e[32mcolour\\e[0m&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 打印颜色</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\\033[32mcolour\\033[m&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 打印颜色</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\\033[0;31mL\\033[0;32mO\\033[0;33mV\\033[0;34mE\\t\\033[0;35mY\\033[0;36mO\\033[0;32mU\\e[m&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 打印颜色</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="正则表达式" tabindex="-1"><a class="header-anchor" href="#正则表达式"><span>正则表达式</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    ^</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 行首定位</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    $</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 行尾定位</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    .</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 匹配除换行符以外的任意字符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    *</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 匹配0或多个重复字符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    +</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 重复一次或更多次</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    ?</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 重复零次或一次</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    ?</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 结束贪婪因子 .*? 表示最小匹配</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    []                      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 匹配一组中任意一个字符</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    [^]                     </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 匹配不在指定组内的字符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 用来转义元字符</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    &lt;                       </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 词首定位符(支持vi和grep)  &lt;love</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    &gt;                       </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 词尾定位符(支持vi和grep)  love&gt;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    x\\</span><span style="color:#98C379;--shiki-dark:#98C379;">{m</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">\\</span><span style="color:#98C379;--shiki-dark:#98C379;">}</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 重复出现m次</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    x\\</span><span style="color:#98C379;--shiki-dark:#98C379;">{m,</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">\\</span><span style="color:#98C379;--shiki-dark:#98C379;">}</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 重复出现至少m次</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    x\\</span><span style="color:#98C379;--shiki-dark:#98C379;">{m,n</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">\\</span><span style="color:#98C379;--shiki-dark:#98C379;">}</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 重复出现至少m次不超过n次</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    X?</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 匹配出现零次或一次的大写字母 X</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    X+</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 匹配一个或多个字母 X</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ()                      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 括号内的字符为一组</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    (</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ab</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">de</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">+</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 匹配一连串的（最少一个） abc 或 def；abc 和 def 将匹配</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    [[:alpha:]]             </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 代表所有字母不论大小写</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    [[:lower:]]             </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 表示小写字母</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    [[:upper:]]             </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 表示大写字母</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    [[:digit:]]             </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 表示数字字符</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    [[:digit:][:lower:]]    </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 表示数字字符加小写字母</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">元字符</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\d</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 匹配任意一位数字</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\D</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 匹配任意单个非数字字符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\w</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 匹配任意单个字母数字下划线字符，同义词是 [:alnum:]</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\W</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 匹配非数字型的字符</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">字符类:空白字符</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\s</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 匹配任意的空白符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\S</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 匹配非空白字符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\b</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 匹配单词的开始或结束</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 匹配换行符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\r</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 匹配回车符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\t</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 匹配制表符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\b</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 匹配退格符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\0</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 匹配空值字符</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">字符类:锚定字符</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\b</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 匹配字边界(不在[]中时)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\B</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 匹配非字边界</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\A</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 匹配字符串开头</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\Z</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 匹配字符串或行的末尾</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\z</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 只匹配字符串末尾</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\G</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 匹配前一次m//g离开之处</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">捕获</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    (</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">exp</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)                </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 匹配exp,并捕获文本到自动命名的组里</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    (?&lt;name&gt;exp)         </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 匹配exp,并捕获文本到名称为name的组里，也可以写成(?&#39;name&#39;exp)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    (?:exp)              </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 匹配exp,不捕获匹配的文本，也不给此分组分配组号</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">零宽断言</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    (?=exp)              </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 匹配exp前面的位置</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    (?&lt;=exp)             </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 匹配exp后面的位置</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    (?!</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">exp</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)              </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 匹配后面跟的不是exp的位置</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    (?&lt;!</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">exp</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)             </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 匹配前面不是exp的位置</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    (?#comment)          </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 注释不对正则表达式的处理产生任何影响，用于注释</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">特殊字符</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    http://en.wikipedia.org/wiki/Ascii_table</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    ^H</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">  \\0</span><span style="color:#98C379;--shiki-dark:#98C379;">10</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> \\b</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    ^M</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">  \\0</span><span style="color:#98C379;--shiki-dark:#98C379;">15</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> \\r</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    匹配特殊字符:</span><span style="color:#98C379;--shiki-dark:#98C379;"> ctrl+V</span><span style="color:#98C379;--shiki-dark:#98C379;"> ctrl不放在按H或M</span><span style="color:#98C379;--shiki-dark:#98C379;"> 即可输出^H,用于匹配</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="流程结构" tabindex="-1"><a class="header-anchor" href="#流程结构"><span>流程结构</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">if判断</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$a</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> ==</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $b</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ]</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    then</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;等于&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    else</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;不等于&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">case分支选择</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    case</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $xs</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;0&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ;;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;1&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ;;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    *) </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;其他&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ;;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    esac</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">while循环</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # while true  等同   while :</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 读文件为整行读入</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    num</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    while</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$num</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -lt</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ]</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    do</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $num</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ((</span><span style="color:#E06C75;--shiki-dark:#E06C75;">num</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$num</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">+</span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    done</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    ###########################</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#98C379;--shiki-dark:#98C379;">  a.txt</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#C678DD;--shiki-dark:#C678DD;">while</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> read</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    do</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $a</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    done</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    ###########################</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    while</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> read</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    do</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $a</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    done</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt; a.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">for循环</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 读文件已空格分隔</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    w</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -F</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;:&quot; &#39;{print $1}&#39; c\`</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> d</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $w</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    do</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        $d</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    done</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    ###########################</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ((</span><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">\${#</span><span style="color:#E06C75;--shiki-dark:#E06C75;">o</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[*]};</span><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">++</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    do</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">o</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$i</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">]}</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    done</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">until循环</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #  当command不为0时循环</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    until</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> command</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    do</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        body</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    done</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">流程控制</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    break</span><span style="color:#98C379;--shiki-dark:#98C379;"> N</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     #  跳出几层循环</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    continue</span><span style="color:#98C379;--shiki-dark:#98C379;"> N</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  #  跳出几层循环，循环次数不变</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    continue</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #  重新循环次数不变</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="变量" tabindex="-1"><a class="header-anchor" href="#变量"><span>变量</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">A</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;a b c def&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 将字符串复制给变量</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">A</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cmd</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 将命令结果赋给变量</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">A</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">$(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cmd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)                </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将命令结果赋给变量</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">eval</span><span style="color:#98C379;--shiki-dark:#98C379;"> a=</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\$</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 间接调用</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&amp;&amp;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> $((</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">i+3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">))      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 计算后打印新变量结果</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&amp;&amp;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> $</span><span style="color:#98C379;--shiki-dark:#98C379;">[i+3]</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 计算后打印新变量结果</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">a</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">$((2&gt;6?5:8))          </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 判断两个值满足条件的赋值给变量</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$1</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">  $2</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">  $*</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 位置参数 *代表所有</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">env</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     # 查看环境变量</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">env</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;name&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 查看定义的环境变量</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">set</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     # 查看环境变量和本地变量</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">read</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 输入变量</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">readonly</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> name</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 把name这个变量设置为只读变量,不允许再次设置</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">readonly</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 查看系统存在的只读文件</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">export</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> name</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 变量name由本地升为环境</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">export</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> name</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;RedHat&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    # 直接定义name为环境变量</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">export</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> Stat$nu</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">2222</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 变量引用变量赋值</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">unset</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 变量清除</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">export</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> name</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 去掉只读变量</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">shift</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 用于移动位置变量,调整位置变量,使$3的值赋给$2.$2的值赋予$1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">name</span><span style="color:#98C379;--shiki-dark:#98C379;"> +</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 将字符串转换为数字</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">number</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot; &quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 将数字转换成字符串</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">a</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;ee&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">b</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;a&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> \${!</span><span style="color:#E06C75;--shiki-dark:#E06C75;">b</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">} </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 间接引用name变量的值</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">a</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;cc&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}             </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 如果a有值则不改变,如果a无值则赋值a变量为cc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">数组</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    A</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#98C379;--shiki-dark:#98C379;">a</span><span style="color:#98C379;--shiki-dark:#98C379;"> b</span><span style="color:#98C379;--shiki-dark:#98C379;"> c</span><span style="color:#98C379;--shiki-dark:#98C379;"> def</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)         </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将变量定义为数組</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${#</span><span style="color:#E06C75;--shiki-dark:#E06C75;">A</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[*]}              </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 数组个数</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">A</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[*]}               </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 数组所有元素,大字符串</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">A</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[@]}               </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 数组所有元素,类似列表可迭代</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">A</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[2]}               </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 脚本的一个参数或数组第三位</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">定义变量类型</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    declare</span><span style="color:#98C379;--shiki-dark:#98C379;"> 或</span><span style="color:#98C379;--shiki-dark:#98C379;"> typeset</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -r</span><span style="color:#98C379;--shiki-dark:#98C379;"> 只读</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">readonly一样</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> 整形</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> 数组</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -f</span><span style="color:#98C379;--shiki-dark:#98C379;"> 函数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -x</span><span style="color:#98C379;--shiki-dark:#98C379;"> export</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    declare</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> n</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">系统变量</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    $0</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   #  脚本启动名(包括路径)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    $n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   #  第n个参数,n=1,2,…9</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    $*</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   #  所有参数列表(不包括脚本本身)</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    $@</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   #  所有参数列表(独立字符串)</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    $#</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   #  参数个数(不包括脚本本身)</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    $$</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   #  当前程式的PID</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    $!</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   #  执行上一个指令的PID</span></span>
<span class="line"><span style="color:#E5C07B;--shiki-dark:#E5C07B;">    $?</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   #  执行上一个指令的返回值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">变量引用技巧</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:+</span><span style="color:#E06C75;--shiki-dark:#E06C75;">value</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}        </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 如果设置了name,就把value显示,未设置则为空</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:-</span><span style="color:#E06C75;--shiki-dark:#E06C75;">value</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}        </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 如果设置了name,就显示它,未设置就显示value</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:?</span><span style="color:#E06C75;--shiki-dark:#E06C75;">value</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}        </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 未设置提示用户错误信息value </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">value</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}        </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 如未设置就把value设置并显示&lt;写入本地中&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${#</span><span style="color:#E06C75;--shiki-dark:#E06C75;">A</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}                 </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 可得到变量中字节</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">A</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:</span><span style="color:#E06C75;--shiki-dark:#E06C75;">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:</span><span style="color:#E06C75;--shiki-dark:#E06C75;">9</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}              </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 取变量中第4位到后面9位</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">A</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:(</span><span style="color:#E06C75;--shiki-dark:#E06C75;">-1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)}             </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 倒叙取最后一个字符</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">A</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">/</span><span style="color:#E06C75;--shiki-dark:#E06C75;">www</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">/</span><span style="color:#E06C75;--shiki-dark:#E06C75;">http</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}         </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 取变量并且替换每行第一个关键字</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">A</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">//</span><span style="color:#E06C75;--shiki-dark:#E06C75;">www</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">/</span><span style="color:#E06C75;--shiki-dark:#E06C75;">http</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}        </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 取变量并且全部替换每行关键字</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    定义了一个变量：</span><span style="color:#98C379;--shiki-dark:#98C379;"> file=/dir1/dir2/dir3/my.file.txt</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">file</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">#*/}     </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 去掉第一条 / 及其左边的字串：dir1/dir2/dir3/my.file.txt</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">file</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">##*/}    </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 去掉最后一条 / 及其左边的字串：my.file.txt</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">file</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">#*.}     </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 去掉第一个 .  及其左边的字串：file.txt</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">file</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">##*.}    </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 去掉最后一个 .  及其左边的字串：txt</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">file</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">%/*}     </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 去掉最后条 / 及其右边的字串：/dir1/dir2/dir3</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">file</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">%%/*}    </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 去掉第一条 / 及其右边的字串：(空值)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">file</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">%.*}     </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 去掉最后一个 .  及其右边的字串：/dir1/dir2/dir3/my.file</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">file</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">%%.*}    </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 去掉第一个 .  及其右边的字串：/dir1/dir2/dir3/my</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #   # 是去掉左边(在键盘上 # 在 $ 之左边)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #   % 是去掉右边(在键盘上 % 在 $ 之右边)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #   单一符号是最小匹配﹔两个符号是最大匹配</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="test判断" tabindex="-1"><a class="header-anchor" href="#test判断"><span>test判断</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 符号 [ ] 等同  test命令</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">expression为字符串操作</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> str</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 字符串str是否不为空</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -z</span><span style="color:#98C379;--shiki-dark:#98C379;"> str</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 字符串str是否为空</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">expression为文件操作</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 并且，两条件为真</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -b</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 是否块文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -p</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 文件是否为一个命名管道</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -c</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 是否字符文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -r</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 文件是否可读</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -d</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 是否一个目录</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -s</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 文件的长度是否不为零</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -e</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 文件是否存在</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -S</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 是否为套接字文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -f</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 是否普通文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -x</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 文件是否可执行，则为真</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -g</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 是否设置了文件的 SGID 位</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -u</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 是否设置了文件的 SUID 位</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -G</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 文件是否存在且归该组所有</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -w</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 文件是否可写，则为真</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -k</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 文件是否设置了的粘贴位</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> fd</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # fd 是否是个和终端相连的打开的文件描述符（fd 默认为 1）</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -o</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 或，一个条件为真</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -O</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 文件是否存在且归该用户所有</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    !      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 取反</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">expression为整数操作</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    expr1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> expr2</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 如果 expr1 和 expr2 评估为真，则为真</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    expr1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -o</span><span style="color:#98C379;--shiki-dark:#98C379;"> expr2</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 如果 expr1 或 expr2 评估为真，则为真</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">两值比较</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    整数</span><span style="color:#98C379;--shiki-dark:#98C379;">     字符串</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -lt</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">      &lt;         </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 小于</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -gt</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">      &gt;         </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 大于</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -le</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">      &lt;</span><span style="color:#98C379;--shiki-dark:#98C379;">=</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 小于或等于</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -ge</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">      &gt;</span><span style="color:#98C379;--shiki-dark:#98C379;">=</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 大于或等于</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -eq</span><span style="color:#98C379;--shiki-dark:#98C379;">      ==</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 等于</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    -ne</span><span style="color:#98C379;--shiki-dark:#98C379;">      !=</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 不等于</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">test</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -lt</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 5</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 判断大小</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> $?</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 查看上句test命令返回状态  # 结果0为真,1为假</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">test</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;hello&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 判断字符串长度是否为0</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[ </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$?</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -eq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ] &amp;&amp; </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;success&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> || </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">exit</span><span style="color:#98C379;--shiki-dark:#98C379;">　　　#</span><span style="color:#98C379;--shiki-dark:#98C379;"> 判断成功提示,失败则退出</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="重定向" tabindex="-1"><a class="header-anchor" href="#重定向"><span>重定向</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#  标准输出 stdout 和 标准错误 stderr  标准输入stdin</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cmd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 1&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">fiel</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 把 标准输出 重定向到 file 文件中</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cmd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">file</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 2&gt;&amp;1          </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 把 标准输出 和 标准错误 一起重定向到 file 文件中</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cmd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 2&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 把 标准错误 重定向到 file 文件中</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cmd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 2&gt;&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 把 标准错误 重定向到 file 文件中(追加)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cmd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt;&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">file</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 2&gt;&amp;1         </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 把 标准输出 和 标准错误 一起重定向到 file 文件中(追加)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cmd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt; </span><span style="color:#98C379;--shiki-dark:#98C379;">file</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt;</span><span style="color:#98C379;--shiki-dark:#98C379;">file2</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # cmd 命令以 file 文件作为 stdin(标准输入)，以 file2 文件作为 标准输出</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt;&gt;</span><span style="color:#98C379;--shiki-dark:#98C379;">file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 以读写的方式打开 file</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cmd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt; </span><span style="color:#98C379;--shiki-dark:#98C379;">file</span><span style="color:#98C379;--shiki-dark:#98C379;"> cmd</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 命令以 file 文件作为 stdin</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cmd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt;&lt; </span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">delimiter</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">cmd; #从 stdin 中读入，直至遇到 delimiter 分界符</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">delimiter</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;&amp;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 使用系统调用 dup (2) 复制文件描述符 n 并把结果用作标准输出</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;&amp;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 标准输入复制自文件描述符 n</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;&amp;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 关闭标准输入（键盘）</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;&amp;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 关闭标准输出</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">n</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;&amp;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 表示将 n 号输入关闭</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">n</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;&amp;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 表示将 n 号输出关闭</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="运算符" tabindex="-1"><a class="header-anchor" href="#运算符"><span>运算符</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">$[]等同于$((</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">))  # $[]表示形式告诉shell求中括号中的表达式的值</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">~var</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 按位取反运算符,把var中所有的二进制为1的变为0,为0的变为1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">var\\</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">str</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 左移运算符,把var中的二进制位向左移动str位,忽略最左端移出的各位,最右端的各位上补上0值,每做一次按位左移就有var乘2</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">var&gt;&gt;str        # 右移运算符,把var中所有的二进制位向右移动str位,忽略最右移出的各位,最左的各位上补0,每次做一次右移就有实现var除以2</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">var&amp;str         # 与比较运算符,var和str对应位,对于每个二进制来说,如果二都为1,结果为1.否则为0</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">var^str         # 异或运算符,比较var和str对应位,对于二进制来说如果二者互补,结果为1,否则为0</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">var|str         # 或运算符,比较var和str的对应位,对于每个二进制来说,如二都该位有一个1或都是1,结果为1,否则为0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">运算符优先级{</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    级别      运算符                                  说明</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    1      =,+=,-=,/=,%=,*=,&amp;=,^=,|=,&lt;&lt;=,&gt;&gt;=      # 赋值运算符</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    2         ||                                  # 逻辑或 前面不成功执行</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    3         &amp;&amp;                                  # 逻辑与 前面成功后执行</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    4         |                                   # 按位或</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    5         ^                                   # 按位异或</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    6         &amp;                                   # 按位与</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    7         ==,!=                               # 等于/不等于</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    8         &lt;=,&gt;=,&lt;,&gt;                           # 小于或等于/大于或等于/小于/大于</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    9        \\&lt;&lt;,&gt;&gt;                               # 按位左移/按位右移 (无转意符号)</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    10        +,-                                 # 加减</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    11        *,/,%                               # 乘,除,取余</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    12        ! ,~                                # 逻辑非,按位取反或补码</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    13        -,+                                 # 正负</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="数学运算" tabindex="-1"><a class="header-anchor" href="#数学运算"><span>数学运算</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">$(( ))        </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 整数运算</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">+</span><span style="color:#98C379;--shiki-dark:#98C379;"> -</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> *</span><span style="color:#98C379;--shiki-dark:#98C379;"> /</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> **</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 分別为 &quot;加、減、乘、除、密运算&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&amp; | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">^</span><span style="color:#98C379;--shiki-dark:#98C379;"> !</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 分別为 &quot;AND、OR、XOR、NOT&quot; 运算</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 余数运算</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">let</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    let</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 运算</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    let</span><span style="color:#98C379;--shiki-dark:#98C379;"> x=16/4</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    let</span><span style="color:#98C379;--shiki-dark:#98C379;"> x=5</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">**</span><span style="color:#98C379;--shiki-dark:#98C379;">5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">expr</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    expr</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 14</span><span style="color:#98C379;--shiki-dark:#98C379;"> %</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 9</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # 整数运算</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    SUM</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">expr</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> \\*</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 乘后结果赋值给变量</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    LOOP</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">expr</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $LOOP</span><span style="color:#98C379;--shiki-dark:#98C379;"> + </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 增量计数(加循环即可) LOOP=0</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    expr</span><span style="color:#98C379;--shiki-dark:#98C379;"> length</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;bkeep zbb&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 计算字串长度</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    expr</span><span style="color:#98C379;--shiki-dark:#98C379;"> substr</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;bkeep zbb&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 4</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 9</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 抓取字串</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    expr</span><span style="color:#98C379;--shiki-dark:#98C379;"> index</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;bkeep zbb&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> e</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 抓取第一个字符数字串出现的位置</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    expr</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 30</span><span style="color:#98C379;--shiki-dark:#98C379;"> /</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#98C379;--shiki-dark:#98C379;"> /</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 运算符号有空格</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    expr</span><span style="color:#98C379;--shiki-dark:#98C379;"> bkeep.doc</span><span style="color:#98C379;--shiki-dark:#98C379;"> :</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;.*&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 模式匹配(可以使用expr通过指定冒号选项计算字符串中字符数)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    expr</span><span style="color:#98C379;--shiki-dark:#98C379;"> bkeep.doc</span><span style="color:#98C379;--shiki-dark:#98C379;"> :</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;\\(.*\\).doc&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 在expr中可以使用字符串匹配操作，这里使用模式抽取.doc文件附属名</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    数值测试</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        #如果试图计算非整数，则会返回错误</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        rr</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">3.4</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        expr</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $rr</span><span style="color:#98C379;--shiki-dark:#98C379;"> +</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        expr:</span><span style="color:#98C379;--shiki-dark:#98C379;"> non-numeric</span><span style="color:#98C379;--shiki-dark:#98C379;"> argument</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        rr</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">5</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        expr</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $rr</span><span style="color:#98C379;--shiki-dark:#98C379;"> +</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        6</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">bc</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;m^n&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">bc</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 次方计算</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;+&#39;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">bc</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 从1加到1000</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\\n&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;+&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/+$/\\n/&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">bc</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 从1加到1000</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="grep" tabindex="-1"><a class="header-anchor" href="#grep"><span>grep</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-c</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 显示匹配到得行的数目，不显示内容</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-h</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 不显示文件名</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-i</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 忽略大小写</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-l</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 只列出匹配行所在文件的文件名</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 在每一行中加上相对行号</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-s</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 无声操作只显示报错，检查退出状态</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-v</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 反向查找</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-e</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 使用正则表达式</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-w</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 精确匹配</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-wc</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 精确匹配次数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-o</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 查询所有匹配字段</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-P</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 使用perl正则表达式</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-A3</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 打印匹配行和下三行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-B3</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 打印匹配行和上三行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-C3</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 打印匹配行和上下三行</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -v</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;a&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> txt</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                              # 过滤关键字符行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -w</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;a\\&gt;&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> txt</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                            # 精确匹配字符串</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;a&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> txt</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                              # 大小写敏感</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;">  &quot;a[bB]&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> txt</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                            # 同时匹配大小写</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;[0-9]\\{3\\}&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> txt</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 查找0-9重复三次的所在行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -E</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;word1|word2|word3&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">   file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 任意条件匹配</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> word1</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> word2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> word3</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 同时匹配三个</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> quan@163.com</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -Po</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;(?&lt;=@.).*(?=.$)&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                           # 零宽断言截取字符串  #　63.co</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;I&#39;m singing while you&#39;re dancing&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -Po</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;\\b\\w+(?=ing\\b)&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 零宽断言匹配</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;Rx Optical Power: -5.01dBm, Tx Optical Power: -2.41dBm&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -Po</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;(?&lt;=:).*?(?=d)&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 取出d前面数字 # ?为最小匹配</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;Rx Optical Power: -5.01dBm, Tx Optical Power: -2.41dBm&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -Po</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;[-0-9.]+&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 取出d前面数字 # ?为最小匹配</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;[&quot;mem&quot;,ok],[&quot;hardware&quot;,false],[&quot;filesystem&quot;,false]&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -Po</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;[^&quot;]+(?=&quot;,false)&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 取出false前面的字母</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;[&quot;mem&quot;,ok],[&quot;hardware&quot;,false],[&quot;filesystem&quot;,false]&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -Po</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;\\w+&quot;,false&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -Po</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;^\\w+&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 取出false前面的字母</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep用于if判断</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> abc</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;a&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  &gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">/dev/null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 2&gt;&amp;1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    then</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;abc&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    else</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;null&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="tr" tabindex="-1"><a class="header-anchor" href="#tr"><span>tr</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-c</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 用字符串1中字符集的补集替换此字符集，要求字符集为ASCII</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-d</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 删除字符串1中所有输入字符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-s</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 删除所有重复出现字符序列，只保留第一个:即将重复出现字符串压缩为一个字符串</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[a-z]       </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># a-z内的字符组成的字符串</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[A-Z]       </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># A-Z内的字符组成的字符串</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[0-9]       </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 数字串</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">\\octal</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 一个三位的八进制数，对应有效的ASCII字符</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[O*n]       </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 表示字符O重复出现指定次数n。因此[O*2]匹配OO的字符串</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr中特定控制字符表达方式</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\a</span><span style="color:#98C379;--shiki-dark:#98C379;"> Ctrl-G</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    \\0</span><span style="color:#98C379;--shiki-dark:#98C379;">07</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 铃声</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\b</span><span style="color:#98C379;--shiki-dark:#98C379;"> Ctrl-H</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    \\0</span><span style="color:#98C379;--shiki-dark:#98C379;">10</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 退格符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\f</span><span style="color:#98C379;--shiki-dark:#98C379;"> Ctrl-L</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    \\0</span><span style="color:#98C379;--shiki-dark:#98C379;">14</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 走行换页</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\n</span><span style="color:#98C379;--shiki-dark:#98C379;"> Ctrl-J</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    \\0</span><span style="color:#98C379;--shiki-dark:#98C379;">12</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 新行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\r</span><span style="color:#98C379;--shiki-dark:#98C379;"> Ctrl-M</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    \\0</span><span style="color:#98C379;--shiki-dark:#98C379;">15</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 回车</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\t</span><span style="color:#98C379;--shiki-dark:#98C379;"> Ctrl-I</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    \\0</span><span style="color:#98C379;--shiki-dark:#98C379;">11</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # tab键</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    \\v</span><span style="color:#98C379;--shiki-dark:#98C379;"> Ctrl-X</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    \\0</span><span style="color:#98C379;--shiki-dark:#98C379;">30</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#98C379;--shiki-dark:#98C379;"> A-Z</span><span style="color:#98C379;--shiki-dark:#98C379;"> a-z</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                             # 将所有大写转换成小写字母</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot; &quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\\n&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                            # 将空格替换为换行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;[\\012]&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt; </span><span style="color:#98C379;--shiki-dark:#98C379;">plan.txt</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 删除空行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;\\n&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">] &lt; plan.txt                </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 删除空行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;[\\015]&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;[\\n]&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt; </span><span style="color:#98C379;--shiki-dark:#98C379;">file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 删除文件中的^M，并代之以换行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;[\\r]&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;[\\n]&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt; </span><span style="color:#98C379;--shiki-dark:#98C379;">file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 删除文件中的^M，并代之以换行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;[:]&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;[\\011]&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt; </span><span style="color:#98C379;--shiki-dark:#98C379;">/etc/passwd</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 替换passwd文件中所有冒号，代之以tab键</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;[:]&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;[\\t]&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt; </span><span style="color:#98C379;--shiki-dark:#98C379;">/etc/passwd</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 替换passwd文件中所有冒号，代之以tab键</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $PATH</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;:&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\\n&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 增加显示路径可读性</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1,$!tr</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;\\t&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                         # tr在vi内使用，在tr前加处理行范围和感叹号(&#39;$&#39;表示最后一行)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\\r&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\\n&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#98C379;--shiki-dark:#98C379;">macfile</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">unixfile</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # Mac -&gt; UNIX</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\\n&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\\r&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#98C379;--shiki-dark:#98C379;">unixfile</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">macfile</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # UNIX -&gt; Mac</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\\r&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#98C379;--shiki-dark:#98C379;">dosfile</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">unixfile</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # DOS -&gt; UNIX  Microsoft DOS/Windows 约定，文本的每行以回车字符(\\r)并后跟换行符(\\n)结束</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{ print $0&quot;\\r&quot; }&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#98C379;--shiki-dark:#98C379;">unixfile</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">dosfile</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # UNIX -&gt; DOS：在这种情况下，需要用awk，因为tr不能插入两个字符来替换一个字符</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="seq" tabindex="-1"><a class="header-anchor" href="#seq"><span>seq</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 不指定起始数值，则默认为 1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-s</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 选项主要改变输出的分格符, 预设是 \\n</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-w</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 等位补全，就是宽度相等，不足的前面补 0</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-f</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 格式化输出，就是指定打印的格式</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 100</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 列出10-100</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tac</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 倒叙列出</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;+&#39;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 90</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 100</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">bc</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 从90加到100</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -f</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;dir%g&#39;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">xargs</span><span style="color:#98C379;--shiki-dark:#98C379;"> mkdir</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 创建dir1-10</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -f</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;dir%03g&#39;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">xargs</span><span style="color:#98C379;--shiki-dark:#98C379;"> mkdir</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 创建dir001-010</span></span></code></pre></div><h3 id="trap" tabindex="-1"><a class="header-anchor" href="#trap"><span>trap</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">信号</span><span style="color:#98C379;--shiki-dark:#98C379;">         说明</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">HUP(1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)     </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 挂起，通常因终端掉线或用户退出而引发</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">INT(2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)     </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 中断，通常因按下Ctrl+C组合键而引发</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">QUIT(3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)    </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 退出，通常因按下Ctrl+\\组合键而引发</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ABRT(6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)    </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 中止，通常因某些严重的执行错误而引发</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ALRM(14</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)   </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 报警，通常用来处理超时</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">TERM(15</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)   </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 终止，通常在系统关机时发送</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">trap捕捉到信号之后，可以有三种反应方式：</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    1、执行一段程序来处理这一信号</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    2、接受信号的默认操作</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    3、忽视这一信号</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">第一种形式的trap命令在shell接收到</span><span style="color:#98C379;--shiki-dark:#98C379;"> signal</span><span style="color:#98C379;--shiki-dark:#98C379;"> list</span><span style="color:#98C379;--shiki-dark:#98C379;"> 清单中数值相同的信号时，将执行双引号中的命令串：</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">trap</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;commands&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> signal-list</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 单引号，要在shell探测到信号来的时候才执行命令和变量的替换，时间一直变</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">trap</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;commands&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> signal-list</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 双引号，shell第一次设置信号的时候就执行命令和变量的替换，时间不变</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="awk" tabindex="-1"><a class="header-anchor" href="#awk"><span>awk</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 默认是执行打印全部 print $0</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1为真 打印$0</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 0为假 不打印</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-F</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 改变FS值(分隔符)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">~    </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 域匹配</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">==</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 变量匹配</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">!</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">~</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 匹配不包含</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">=</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 赋值</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">!</span><span style="color:#98C379;--shiki-dark:#98C379;">=</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 不等于</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">+</span><span style="color:#98C379;--shiki-dark:#98C379;">=</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 叠加</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">\\b</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 退格</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">\\f</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 换页</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">\\n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 换行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">\\r</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 回车</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">\\t</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 制表符Tab</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">\\c</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 代表任一其他字符</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-F</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;[ ]+|[%]+&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 多个空格或多个%为分隔符</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[a-z]+         </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 多个小写字母</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[a-Z]          </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 代表所有大小写字母(aAbB...zZ)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[a-z]          </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 代表所有大小写字母(ab...z)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[:alnum:]      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 字母数字字符</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[:alpha:]      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 字母字符</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[:cntrl:]      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 控制字符</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[:digit:]      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 数字字符</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[:graph:]      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 非空白字符(非空格、控制字符等)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[:lower:]      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 小写字母</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[:print:]      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 与[:graph:]相似，但是包含空格字符</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[:punct:]      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 标点字符</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[:space:]      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 所有的空白字符(换行符、空格、制表符)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[:upper:]      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 大写字母</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[:xdigit:]     </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 十六进制的数字(0-9a-fA-F)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[[:digit:][:lower:]]    </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 数字和小写字母(占一个字符)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">内建变量{</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    $n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 当前记录的第 n 个字段，字段间由 FS 分隔</span></span>
<span class="line"><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">    $0</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 完整的输入记录</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ARGC          </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 命令行参数的数目</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ARGIND        </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 命令行中当前文件的位置 ( 从 0 开始算 )</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ARGV          </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 包含命令行参数的数组</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    CONVFMT       </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 数字转换格式 ( 默认值为 %.6g)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ENVIRON       </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 环境变量关联数组</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ERRNO         </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 最后一个系统错误的描述</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    FIELDWIDTHS   </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 字段宽度列表 ( 用空格键分隔 )</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    FILENAME      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 当前文件名</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    FNR           </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 同 NR ，但相对于当前文件</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    FS            </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 字段分隔符 ( 默认是任何空格 )</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    IGNORECASE    </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 如果为真（即非 0 值），则进行忽略大小写的匹配</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    NF            </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 当前记录中的字段数(列)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    NR            </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 当前行数</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    OFMT          </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 数字的输出格式 ( 默认值是 %.6g)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    OFS           </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 输出字段分隔符 ( 默认值是一个空格 )</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ORS           </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 输出记录分隔符 ( 默认值是一个换行符 )</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    RLENGTH       </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 由 match 函数所匹配的字符串的长度</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    RS            </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 记录分隔符 ( 默认是一个换行符 )</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    RSTART        </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 由 match 函数所匹配的字符串的第一个位置</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    SUBSEP        </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 数组下标分隔符 ( 默认值是 /034)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    BEGIN         </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 先处理(可不加文件参数)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    END           </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 结束时处理</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">内置函数{</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    gsub(</span><span style="color:#E06C75;--shiki-dark:#E06C75;">r</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;">s</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)          </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 在整个$0中用s替代r   相当于 sed &#39;s///g&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    gsub(</span><span style="color:#E06C75;--shiki-dark:#E06C75;">r</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;">s</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;">t</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)        </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 在整个t中用s替代r</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    index(</span><span style="color:#E06C75;--shiki-dark:#E06C75;">s</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;">t</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)         </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 返回s中字符串t的第一位置</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    length(</span><span style="color:#E06C75;--shiki-dark:#E06C75;">s</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)          </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 返回s长度</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    match(</span><span style="color:#E06C75;--shiki-dark:#E06C75;">s</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;">r</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)         </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 测试s是否包含匹配r的字符串</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    split(</span><span style="color:#E06C75;--shiki-dark:#E06C75;">s</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;">a</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;">fs</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 在fs上将s分成序列a</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    sprint(</span><span style="color:#E06C75;--shiki-dark:#E06C75;">fmt</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;">exp</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)    </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 返回经fmt格式化后的exp</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    sub(</span><span style="color:#E06C75;--shiki-dark:#E06C75;">r</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;">s</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)           </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 用$0中最左边最长的子串代替s   相当于 sed &#39;s///&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    substr(</span><span style="color:#E06C75;--shiki-dark:#E06C75;">s</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;">p</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)        </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 返回字符串s中从p开始的后缀部分</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    substr(</span><span style="color:#E06C75;--shiki-dark:#E06C75;">s</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;">p</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">,</span><span style="color:#E06C75;--shiki-dark:#E06C75;">n</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 返回字符串s中从p开始长度为n的后缀部分</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk判断{</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{print ($1&gt;$2)?&quot;第一排&quot;$1:&quot;第二排&quot;$2}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 条件判断 括号代表if语句判断 &quot;?&quot;代表then &quot;:&quot;代表else</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{max=($1&gt;$2)? $1 : $2; print max}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 条件判断 如果$1大于$2,max值为为$1,否则为$2</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{if ( $6 &gt; 50) print $1 &quot; Too high&quot; ;\\</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    else print &quot;Range is OK&quot;}&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> file</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{if ( $6 &gt; 50) { count++;print $3 } \\</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    else { x+5; print $2 } }&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> file</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk循环{</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{i = 1; while ( i &lt;= NF ) { print NF, $i ; i++ } }&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> file</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{ for ( i = 1; i &lt;= NF; i++ ) print NF,$i }&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> file</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/Tom/&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> file               </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 打印匹配到得行</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/^Tom/{print $1}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 匹配Tom开头的行 打印第一个字段</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;$1 !~ /ly$/&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 显示所有第一个字段不是以ly结尾的行</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;$3 &lt;40&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 如果第三个字段值小于40才打印</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;$4==90{print $5}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 取出第四列等于90的第五列</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/^(no|so)/&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> test          </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 打印所有以模式no或so开头的行</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;$3 * $4 &gt; 500&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 算术运算(第三个字段和第四个字段乘积大于500则显示)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{print NR&quot; &quot;$0}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 加行号</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/tom/,/suz/&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 打印tom到suz之间的行</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{a+=$1}END{print a}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 列求和</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;sum+=$1{print sum}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 将$1的值叠加后赋给sum</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{a+=$1}END{print a/NR}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 列求平均值</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;!s[$1 $3]++&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> file         </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 根据第一列和第三列过滤重复行</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk -F</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;[ :\\t]&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{print $1,$2}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 以空格、:、制表符Tab为分隔符</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{print &quot;&#39;&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$a</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;&#39;&quot;,&quot;&#39;&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$b</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;&#39;&quot;}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 引用外部变量</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{if(NR==52){print;exit}}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 显示第52行</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/关键字/{a=NR+2}a==NR {print}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 取关键字下第几行</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;gsub(/liu/,&quot;aaaa&quot;,$1){print $0}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 只打印匹配替换后的行</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">ll | awk -F</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;[ ]+|[ ][ ]+&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/^$/{print $8}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 提取时间,空格不固定</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{$1=&quot;&quot;;$2=&quot;&quot;;$3=&quot;&quot;;print}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 去掉前三列</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">echo aada:aba|awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/d/||/b/{print}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # 匹配两内容之一</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">echo aada:abaa|awk -F: </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;$1~/d/||$2~/b/{print}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 关键列匹配两内容之一</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">echo Ma asdas|awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;$1~/^[a-Z][a-Z]$/{print }&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 第一个域匹配正则</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">echo aada:aaba|awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/d/&amp;&amp;/b/{print}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 同时匹配两条件</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;length($1)==&quot;4&quot;{print $1}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 字符串位数</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{if($2&gt;3){system (&quot;touch &quot;$1)}}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 执行系统命令</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{sub(/Mac/,&quot;Macintosh&quot;,$0);print}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 用Macintosh替换Mac</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{gsub(/Mac/,&quot;MacIntosh&quot;,$1); print}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 第一个域内用Macintosh替换Mac</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk -F </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{ for(i=1;i&lt;NF+1;i++)a+=$i  ;print a}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 多位数算出其每位数的总和.比如 1234， 得到 10</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{ i=$1%10;if ( i == 0 ) {print i}}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 判断$1是否整除(awk中定义变量引用时不能带 $ )</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;BEGIN{a=0}{if ($1&gt;a) a=$1 fi}END{print a}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 列求最大值  设定一个变量开始为0，遇到比该数大的值，就赋值给该变量，直到结束</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;BEGIN{a=11111}{if ($1&lt;a) a=$1 fi}END{print a}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 求最小值</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{if(A)print;A=0}/regexp/{A=1}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # 查找字符串并将匹配行的下一行显示出来，但并不显示匹配行</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/regexp/{print A}{A=$0}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                          # 查找字符串并将匹配行的上一行显示出来，但并不显示匹配行</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{if(!/mysql/)gsub(/1/,&quot;a&quot;);print $0}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 将1替换成a，并且只在行中未出现字串mysql的情况下替换</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;BEGIN{srand();fr=int(100*rand());print fr;}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 获取随机数</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{if(NR==3)F=1}{if(F){i++;if(i%7==1)print}}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 从第3行开始，每7行显示一次</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{if(NF&lt;1){print i;i=0} else {i++;print $0}}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 显示空行分割各段的行数</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">echo +null:null  |awk -F: </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;$1!~&quot;^+&quot;&amp;&amp;$2!=&quot;null&quot;{print $0}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 关键列同时匹配</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk -v RS</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">@ </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;NF{for(i=1;i&lt;=NF;i++)if($i) printf $i;print &quot;&quot;}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 指定记录分隔符</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{b[$1]=b[$1]$2}END{for(i in b){print i,b[i]}}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 列叠加</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{ i=($1%100);if ( $i &gt;= 0 ) {print $0,$i}}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 求余数</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{b=a;a=$1; if(NR&gt;1){print a-b}}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                            # 当前行减上一行</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{a[NR]=$1}END{for (i=1;i&lt;=NR;i++){print a[i]-a[i-1]}}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 当前行减上一行</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk -F: </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{name[x++]=$1};END{for(i=0;i&lt;NR;i++)print i,name[i]}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # END只打印最后的结果,END块里面处理数组内容</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{sum2+=$2;count=count+1}END{print sum2,sum2/count}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # $2的总和  $2总和除个数(平均值)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk -v a</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> -F </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;B&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{for (i=1;i&lt;NF;i++){ a=a+length($i)+1;print a  }}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 打印所以B的所在位置</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;BEGIN{ &quot;date&quot; | getline d; split(d,mon) ; print mon[2]}&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> file        </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将date值赋给d，并将d设置为数组mon，打印mon数组中第2个元素</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;BEGIN{info=&quot;this is a test2010test!&quot;;print substr(info,4,10);}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 截取字符串(substr使用)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;BEGIN{info=&quot;this is a test2010test!&quot;;print index(info,&quot;test&quot;)?&quot;ok&quot;:&quot;no found&quot;;}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 匹配字符串(index使用)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;BEGIN{info=&quot;this is a test2010test!&quot;;print match(info,/[0-9]+/)?&quot;ok&quot;:&quot;no found&quot;;}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 正则表达式匹配查找(match使用)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{for(i=1;i&lt;=4;i++)printf $i&quot;&quot;FS; for(y=10;y&lt;=13;y++)  printf $y&quot;&quot;FS;print &quot;&quot;}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 打印前4列和后4列</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;BEGIN{for(n=0;n++&lt;9;){for(i=0;i++&lt;n;)printf i&quot;x&quot;n&quot;=&quot;i*n&quot; &quot;;print &quot;&quot;}}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 乘法口诀</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;BEGIN{info=&quot;this is a test&quot;;split(info,tA,&quot; &quot;);print length(tA);for(k in tA){print k,tA[k];}}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 字符串分割(split使用)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{if (system (&quot;grep &quot;$2&quot; tmp/* &gt; /dev/null 2&gt;&amp;1&quot;) == 0 ) {print $1,&quot;Y&quot;} else {print $1,&quot;N&quot;} }&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> a            </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 执行系统命令判断返回状态</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk  </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{for(i=1;i&lt;=NF;i++) a[i,NR]=$i}END{for(i=1;i&lt;=NF;i++) {for(j=1;j&lt;=NR;j++) printf a[i,j] &quot; &quot;;print &quot;&quot;}}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 将多行转多列</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">netstat -an|awk -v A</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$IP</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> -v B</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$PORT</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;BEGIN{print &quot;Clients\\tGuest_ip&quot;}$4~A&quot;:&quot;B{split($5,ip,&quot;:&quot;);a[ip[1]]++}END{for(i in a)print a[i]&quot;\\t&quot;i|&quot;sort -nr&quot;}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 统计IP连接个数</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">cat 1.txt|awk -F</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot; # &quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{print &quot;insert into user (user,password,email)values(&quot;&quot;&#39;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;&quot;$1&quot;&#39;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&#39;\\,</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;&quot;&quot;&#39;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;&quot;$2&quot;&#39;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&#39;\\,</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;&quot;&quot;&#39;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;&quot;$3&quot;&#39;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&#39;\\)\\;</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;&quot;}&#39;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> &gt;&gt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">insert_1.txt     </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 处理sql语句</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;BEGIN{printf &quot;what is your name?&quot;;getline name &lt; &quot;/dev/tty&quot; } $1 ~name {print &quot;FOUND&quot; name &quot; on line &quot;, NR &quot;.&quot;} END{print &quot;see you,&quot; name &quot;.&quot;}&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> file  </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 两文件匹配</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">取本机IP{</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    /sbin/ifconfig |awk -v RS</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Bcast:&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{print $NF}&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|awk -F: </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/addr/{print $2}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    /sbin/ifconfig |awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/inet/&amp;&amp;$2!~&quot;127.0.0.1&quot;{split($2,a,&quot;:&quot;);print a[2]}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    /sbin/ifconfig |awk -v RS</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;inet addr:&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;$1!=&quot;eth0&quot;&amp;&amp;$1!=&quot;127.0.0.1&quot;{print $1}&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{printf&quot;%s|&quot;,$0}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    /sbin/ifconfig |awk  </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{printf(&quot;line %d,%s\\n&quot;,NR,$0)}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 指定类型(%d数字,%s字符)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">查看磁盘空间{</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    df </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|awk -F</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;[ ]+|%&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;$5&gt;14{print $5}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    df </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;NR!=1{if ( NF == 6 ) {print $5} else if ( NF == 5) {print $4} }&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    df </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;NR!=1 &amp;&amp; /%/{sub(/%/,&quot;&quot;);print $(NF-1)}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    df </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|sed </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;1d;/ /!N;s/\\n//;s/ \\+/ /;&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #将磁盘分区整理成一行   可直接用 df -P</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">排列打印{</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;END{printf &quot;%-10s%-10s\\n%-10s%-10s\\n%-10s%-10s\\n&quot;,&quot;server&quot;,&quot;name&quot;,&quot;123&quot;,&quot;12345&quot;,&quot;234&quot;,&quot;1234&quot;}&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> txt</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;BEGIN{printf &quot;|%-10s|%-10s|\\n|%-10s|%-10s|\\n|%-10s|%-10s|\\n&quot;,&quot;server&quot;,&quot;name&quot;,&quot;123&quot;,&quot;12345&quot;,&quot;234&quot;,&quot;1234&quot;}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;BEGIN{</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    print &quot;   *** 开 始 ***   &quot;;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    print &quot;+-----------------+&quot;;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    printf &quot;|%-5s|%-5s|%-5s|\\n&quot;,&quot;id&quot;,&quot;name&quot;,&quot;ip&quot;;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    $1!=1 &amp;&amp; NF==4{printf &quot;|%-5s|%-5s|%-5s|\\n&quot;,$1,$2,$3&quot; &quot;$11}</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    END{</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    print &quot;+-----------------+&quot;;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    print &quot;   *** 结 束 ***   &quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    }&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> txt</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk经典题{</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    分析图片服务日志，把日志（每个图片访问次数*图片大小的总和）排行，也就是计算每个url的总访问大小</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    说明：本题生产环境应用：这个功能可以用于IDC网站流量带宽很高，然后通过分析服务器日志哪些元素占用流量过大，进而进行优化或裁剪该图片，压缩js等措施。</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    本题需要输出三个指标： 【被访问次数】    【访问次数*单个被访问文件大小】   【文件名（带URL）】</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    测试数据</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    59.33.26.105</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> - - [08/Dec/2010:15:43:56 +0800] </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;GET /static/images/photos/2.jpg HTTP/1.1&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 200</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 11299</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{array_num[$7]++;array_size[$7]+=$10}END{for(i in array_num) {print array_num[i]&quot; &quot;array_size[i]&quot; &quot;i}}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk练习题{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    wang     </span><span style="color:#D19A66;--shiki-dark:#D19A66;">4</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    cui      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    zhao     </span><span style="color:#D19A66;--shiki-dark:#D19A66;">4</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    liu      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    liu      </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    chang    </span><span style="color:#D19A66;--shiki-dark:#D19A66;">5</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    li       </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 通过第一个域找出字符长度为4的</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 当第二列值大于3时，创建空白文件，文件名为当前行第一个域</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#E06C75;--shiki-dark:#E06C75;">touch</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> $1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 将文档中 liu 字符串替换为 hong</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 求第二列的和</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 求第二列的平均值</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 求第二列中的最大值</span></span>
<span class="line"><span style="color:#D19A66;--shiki-dark:#D19A66;">    7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 将第一列过滤重复后，列出每一项，每一项的出现次数，每一项的大小总和</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    1、字符串长度</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;length($1)==&quot;4&quot;{print $1}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    2、执行系统命令</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{if($2&gt;3){system (&quot;touch &quot;$1)}}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    3、gsub(</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">/</span><span style="color:#E06C75;--shiki-dark:#E06C75;">r</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">/,</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;s&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">,</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">域) 在指定域(默认</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)中用s替代r  (</span><span style="color:#E06C75;--shiki-dark:#E06C75;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s///g&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{gsub(/liu/,&quot;hong&quot;,$1);print $0}&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> a.txt</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    4、列求和</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{a+=$2}END{print a}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    5、列求平均值</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{a+=$2}END{print a/NR}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{a+=$2;b++}END{print a,a/b}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    6、列求最大值</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;BEGIN{a=0}{if($2&gt;a) a=$2 }END{print a}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    7、将第一列过滤重复列出每一项，每一项的出现次数，每一项的大小总和</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        awk </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;{a[$1]++;b[$1]+=$2}END{for(i in a){print i,a[i],b[i]}}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">awk处理复杂日志{</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    6.19：</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    DHB_014_号百总机服务业务日报：广州 到达数异常！</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    DHB_023_号百漏话提醒日报：珠海 到达数异常！</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    6.20：</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    DHB_014_号百总机服务业务日报：广州 到达数异常！到</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    awk -F </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;[_ ：]+&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;NF&gt;2{print $4,$1&quot;_&quot;$2,b |&quot;sort&quot;;next}{b=$1}&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 当前行NF小于等于2 只针对{print $4,$1&quot;_&quot;$2,b |&quot;sort&quot;;next} 有效 即 6.19：行跳过此操作,  {b=$1} 仍然执行</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 当前行NF大于2 执行到 next 强制跳过本行，即跳过后面的 {b=$1}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    广州 DHB_014 </span><span style="color:#D19A66;--shiki-dark:#D19A66;">6.19</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="sed" tabindex="-1"><a class="header-anchor" href="#sed"><span>sed</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 先读取资料、存入模式空间、对其进行编辑、再输出、再用下一行替换模式空间内容</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 调试工具sedsed (参数 -d)   http://aurelio.net/sedsed/sedsed-1.0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 输出由编辑指令控制(取消默认的输出,必须与编辑指令一起配合)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-i</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 直接对文件操作</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-e</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 多重编辑</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-r</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 正则可不转移特殊字符</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">b</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 跳过匹配的行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">p</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 打印</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">d</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 删除</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">s</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 替换</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">g</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 配合s全部替换</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">i</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 行前插入</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 行后插入</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">r</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 读</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">y</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 转换</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">q</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 退出</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&amp;    </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 代表查找的串内容</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">*    </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 任意多个 前驱字符(前导符)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">?    </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 0或1个 最小匹配 没加-r参数需转义 \\?</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">$</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 最后一行</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">.</span><span style="color:#98C379;--shiki-dark:#98C379;">*</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 匹配任意多个字符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">\\(a\\</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)   </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 保存a作为标签1(\\1)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">模式空间</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 模式空间(两行两行处理) 模式匹配的范围，一般而言，模式空间是输入文本中某一行，但是可以通过使用N函数把多于一行读入模式空间</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 暂存空间里默认存储一个空行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    n</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 读入下一行(覆盖上一行)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    h</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 把模式空间里的行拷贝到暂存空间</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    H</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 把模式空间里的行追加到暂存空间</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    g</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 用暂存空间的内容替换模式空间的行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    G</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 把暂存空间的内容追加到模式空间的行后</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    x</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 将暂存空间的内容于模式空间里的当前行互换</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    ！</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 对其前面的要匹配的范围取反</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    D</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 删除当前模式空间中直到并包含第一个换行符的所有字符(/.*/匹配模式空间中所有内容，匹配到就执行D,没匹配到就结束D)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    N</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 追加下一个输入行到模式空间后面并在第二者间嵌入一个换行符，改变当前行号码,模式匹配可以延伸跨域这个内嵌换行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    p</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 打印模式空间中的直到并包含第一个换行的所有字符</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">标签函数</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    :</span><span style="color:#98C379;--shiki-dark:#98C379;"> lable</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 建立命令标记，配合b，t函数使用跳转</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    b</span><span style="color:#98C379;--shiki-dark:#98C379;"> lable</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 分支到脚本中带有标记的地方，如果分支不存在则分支到脚本的末尾。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    t</span><span style="color:#98C379;--shiki-dark:#98C379;"> labe</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 判断分支，从最后一行开始，条件一旦满足或者T,t命令，将导致分支到带有标号的命令出，或者到脚本末尾。与b函数不同在于t在执行跳转前会先检查其前一个替换命令是否成功，如成功，则执行跳转。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{:p1;/A/s/A/AA/;/B/s/B/BB/;/[AB]\\{10\\}/b;b p1;}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 文件内容第一行A第二行B:建立标签p1;两个替换函数(A替换成AA,B替换成BB)当A或者B达到10个以后调用b,返回</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;sd  f   f   [a    b      c    cddd    eee]&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;:n;s#\\(\\[[^ ]*\\)  *#\\1#;tn&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 标签函数t使用方法,替换[]里的空格</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;198723124.03&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -r</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;:a;s/([0-9]+)([0-9]{3})/\\1,\\2/;ta&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 每三个字符加一个逗号</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">引用外部变量</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$a</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;,10p&#39;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$a</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;,10p&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> 10q</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                       # 显示文件中的前10行 (模拟&quot;head&quot;)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;$=&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                   # 计算行数(模拟 &quot;wc -l&quot;)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;5,/^no/p&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                             # 打印从第5行到以no开头行之间的所有行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;/^</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$f</span><span style="color:#98C379;--shiki-dark:#98C379;">/d&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     　　                  　 # 删除匹配行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/aaa/,$d&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                             # 删除匹配行到末尾</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;s/=/:/&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> c</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                             # 直接对文本替换</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;/^pearls/s/$/j/&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 找到pearls开头在行尾加j</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/1/,/3/p&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                           # 打印1和3之间的行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;1p&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                              # 取出指定行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;5i\\aaa&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                             # 在第5行之前插入行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;5a\\aaa&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                             # 在第5行之后抽入行</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/a/i\\b&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 在匹配行前插入一行</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/a/a\\b&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 在匹配行后插入一行</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/a/&amp;\\nb/g&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 在匹配行后插入一行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">| </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1,3}</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&#39;s/./a/&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 匹配1和3行替换</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/regexp/!p&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                           # 只显示不匹配正则表达式的行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/regexp/d&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                               # 只显示不匹配正则表达式的行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;$!N;s/\\n//&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                              # 将每两行连接成一行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/baz/s/foo/bar/g&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 只在行中出现字串&quot;baz&quot;的情况下将&quot;foo&quot;替换成&quot;bar&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/baz/!s/foo/bar/g&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 将&quot;foo&quot;替换成&quot;bar&quot;，并且只在行中未出现字串&quot;baz&quot;的情况下替换</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/a/#&amp;/g&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 在a前面加#号</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/foo/bar/4&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                             # 只替换每一行中的第四个字串</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/\\(.*\\)foo/\\1bar/&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 替换每行最后一个字符串</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/\\(.*\\)foo\\(.*foo\\)/\\1bar\\2/&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 替换倒数第二个字符串</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/[0-9][0-9]$/&amp;5&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 在以[0-9][0-9]结尾的行后加5</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39; /^eth\\|em[01][^:]/{n;p;}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 匹配多个关键字</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -r</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39; /eth|em[01][^:]/{n;p;}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 匹配多个关键字</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;1\\n2&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">xargs</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#98C379;--shiki-dark:#98C379;"> sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/^/1/&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> {}</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 同时处理多个文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/west/,/east/s/$/*VACA*/&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 修改west和east之间的所有行，在结尾处加*VACA*</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;">  &#39;s/[^1-9]*\\([0-9]\\+\\).*/\\1/&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 取出第一组数字，并且忽略掉开头的0</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/regexp/{g;1!p;};h&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 查找字符串并将匹配行的上一行显示出来，但并不显示匹配行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39; /regexp/{n;p;}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 查找字符串并将匹配行的下一行显示出来，但并不显示匹配行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/\\(mar\\)got/\\1ianne/p&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # 保存\\(mar\\)作为标签1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/\\([0-9]\\+\\).*\\(t\\)/\\2\\1/p&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 保存多个标签</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;1,3d&#39;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/1/2/&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 多重编辑(先删除1-3行，在将1替换成2)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/@.*//g&#39;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/^$/d&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 删除掉@后面所有字符，和空行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;{s/^ *[0-9]*//p}&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 打印并删除正则表达式的那部分内容</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> abcd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;y/bd/BE/&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 匹配字符替换</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/^#/b;y/y/P/&#39;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                          # 非#号开头的行替换字符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/suan/r readfile&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                        # 找到含suan的行，在后面加上读入的文件内容</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/no/w writefile&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 找到含no的行，写入到指定文件中</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/regex/G&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                # 在匹配式样行之后插入一空行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/regex/{x;p;x;G;}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 在匹配式样行之前和之后各插入一空行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;n;d&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                     # 删除所有偶数行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;G;G&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                     # 在每一行后面增加两空行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/^$/d;G&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                 # 在输出的文本中每一行后面将有且只有一空行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;n;n;n;n;G;&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                              # 在每5行后增加一空白行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;5~5p&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                 # 只打印行号为5的倍数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 30</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;">  &#39;5~5s/.*/a/&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # 倍数行执行替换</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;3,\${p;n;n;n;n;n;n;}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 从第3行开始，每7行显示一次</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;h;n;G;p&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                              # 奇偶调换</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;1!G;h;$!d&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 倒叙排列</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ls</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/^.rwx.*/p&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     # 查找属主权限为7的文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> =</span><span style="color:#98C379;--shiki-dark:#98C379;"> filename</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;N;s/\\n/\\t/&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 为文件中的每一行进行编号(简单的左对齐方式)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/^[ \\t]*//&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                             # 将每一行前导的&quot;空白字符&quot;(空格，制表符)删除,使之左对齐</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/^[ \\t]*//;s/[ \\t]*$//&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 将每一行中的前导和拖尾的空白字符删除</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/{abc,def\\}\\/\\[111,222]/s/^/00000/&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 匹配需要转行的字符: } / [</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> abcd</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\\\</span><span style="color:#98C379;--shiki-dark:#98C379;">nabcde</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/\\\\n/@/g&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;@&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;\\n&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 将换行符转换为换行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> tmp</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{print $1}&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sort</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;$p&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 取一列最大值</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{s/^[^\\/]*//;s/\\:.*//;p}&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc/passwd</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 取用户家目录(匹配不为/的字符和匹配:到结尾的字符全部删除)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> =</span><span style="color:#98C379;--shiki-dark:#98C379;"> filename</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;N;s/^/      /; s/ *\\(.\\{6,\\}\\)\\n/\\1   /&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 对文件中的所有行编号(行号在左，文字右端对齐)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">/sbin/ifconfig</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/.*inet addr:\\(.*\\) Bca.*/\\1/g&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/eth/{n;p}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 取所有IP</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">修改keepalive配置剔除后端服务器</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/real_server.*10.0.1.158.*8888/,+8 s/^/#/&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> keepalived.conf</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/real_server.*10.0.1.158.*8888/,+8 s/^#//&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> keepalived.conf</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">模仿rev功能</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 123</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/\\n/!G;s/\\(.\\)\\(.*\\n\\)/&amp;\\2\\1/;//D;s/.//;&#39;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    /\\n/!G</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;         </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">　　　　　　#</span><span style="color:#98C379;--shiki-dark:#98C379;"> 没有</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\n</span><span style="color:#98C379;--shiki-dark:#98C379;">换行符，要执行G,因为保留空间中为空，所以在模式空间追加一空行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    s/\\(.\\</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\(</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">.*</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\n\\)</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">/&amp;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">\\2\\1/</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;     </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 标签替换 &amp;\\n23\\n1$ (关键在于&amp; ,可以让后面//匹配到空行)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    //D</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;            </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">　　　　　　#</span><span style="color:#98C379;--shiki-dark:#98C379;"> D</span><span style="color:#98C379;--shiki-dark:#98C379;"> 命令会引起循环删除模式空间中的第一部分，如果删除后，模式空间中还有剩余行，则返回</span><span style="color:#98C379;--shiki-dark:#98C379;"> D</span><span style="color:#98C379;--shiki-dark:#98C379;"> 之前的命令，重新执行，如果</span><span style="color:#98C379;--shiki-dark:#98C379;"> D</span><span style="color:#98C379;--shiki-dark:#98C379;"> 后，模式空间中没有任何内容，则将退出。</span><span style="color:#98C379;--shiki-dark:#98C379;">  //D</span><span style="color:#98C379;--shiki-dark:#98C379;"> 匹配空行执行D,如果上句s没有匹配到,//也无法匹配到空行,</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;//D;&quot;命令结束</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    s/.//</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;          </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">　　　　　　#</span><span style="color:#98C379;--shiki-dark:#98C379;"> D结束后,删除开头的</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> \\n</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="xargs" tabindex="-1"><a class="header-anchor" href="#xargs"><span>xargs</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 命令替换</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-t</span><span style="color:#98C379;--shiki-dark:#98C379;"> 先打印命令，然后再执行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-i</span><span style="color:#98C379;--shiki-dark:#98C379;"> 用每项替换</span><span style="color:#98C379;--shiki-dark:#98C379;"> {}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">find</span><span style="color:#98C379;--shiki-dark:#98C379;"> /</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -perm</span><span style="color:#98C379;--shiki-dark:#98C379;"> +7000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">xargs</span><span style="color:#98C379;--shiki-dark:#98C379;"> ls</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # 将前面的内容，作为后面命令的参数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">xargs</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> date</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;{} days &quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> +%Y-%m-%d</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 列出10天日期</span></span></code></pre></div><h3 id="dialog菜单" tabindex="-1"><a class="header-anchor" href="#dialog菜单"><span>dialog菜单</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 默认将所有输出用 stderr 输出，不显示到屏幕   使用参数  --stdout 可将选择赋给变量</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 退出状态  0正确  1错误</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">窗体类型</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --calendar</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 日历</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --checklist</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 允许你显示一个选项列表，每个选项都可以被单独的选择 (复选框)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --form</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 表单,允许您建立一个带标签的文本字段，并要求填写</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --fselect</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 提供一个路径，让你选择浏览的文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --gauge</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 显示一个表，呈现出完成的百分比，就是显示出进度条。</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --infobox</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 显示消息后，（没有等待响应）对话框立刻返回，但不清除屏幕(信息框)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --inputbox</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 让用户输入文本(输入框)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --inputmenu</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 提供一个可供用户编辑的菜单（可编辑的菜单框）</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --menu</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 显示一个列表供用户选择(菜单框)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --msgbox(message</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)   </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 显示一条消息,并要求用户选择一个确定按钮(消息框)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --password</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 密码框，显示一个输入框，它隐藏文本</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --pause</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 显示一个表格用来显示一个指定的暂停期的状态</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --radiolist</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 提供一个菜单项目组，但是只有一个项目，可以选择(单选框)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --tailbox</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 在一个滚动窗口文件中使用tail命令来显示文本</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --tailboxbg</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 跟tailbox类似，但是在background模式下操作</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --textbox</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 在带有滚动条的文本框中显示文件的内容  (文本框)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --timebox</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 提供一个窗口，选择小时，分钟，秒</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --yesno(yes/no</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)     </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 提供一个带有yes和no按钮的简单信息框</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">窗体参数</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --separate-output</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 对于chicklist组件,输出结果一次输出一行,得到结果不加引号</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --ok-label</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;提交&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">          # 确定按钮名称</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --cancel-label</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;取消&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 取消按钮名称</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --title</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;标题&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 标题名称</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --stdout</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 将所有输出用 stdout 输出</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --backtitle</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;上标&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 窗体上标</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --no-shadow</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 去掉窗体阴影</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --menu</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;菜单名&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 20</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 60</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 14</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 菜单及窗口大小</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --clear</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # 完成后清屏操作</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --no-cancel</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 不显示取消项</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --insecure</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 使用星号来代表每个字符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --begin</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt;y&gt; &lt;x&gt;            </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 指定对话框左上角在屏幕的上的做坐标</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --timeout</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt;秒&gt;             </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 超时,返回的错误代码255,如果用户在指定的时间内没有给出相应动作,就按超时处理</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --defaultno</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 使选择默认为no</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --default-item</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt;</span><span style="color:#98C379;--shiki-dark:#98C379;">st</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">r&gt;       </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 设置在一份清单，表格或菜单中的默认项目。通常在框中的第一项是默认</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --sleep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 5</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 在处理完一个对话框后静止(延迟)的时间(秒)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --max-input</span><span style="color:#98C379;--shiki-dark:#98C379;"> size</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 限制输入的字符串在给定的大小之内。如果没有指定，默认是2048</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    --keep-window</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 退出时不清屏和重绘窗口。当几个组件在同一个程序中运行时，对于保留窗口内容很有用的</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dialog</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --title</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Check me&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --checklist</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Pick Numbers&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 15</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 25</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;one&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;off&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;two&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;on&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 多选界面[方括号]</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dialog</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --title</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;title&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --radiolist</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;checklist&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 20</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 60</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 14</span><span style="color:#98C379;--shiki-dark:#98C379;"> tag1</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;item1&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> on</span><span style="color:#98C379;--shiki-dark:#98C379;"> tag2</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;item2&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> off</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 单选界面(圆括号)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dialog</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --title</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;title&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --menu</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;MENU&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 20</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 60</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 14</span><span style="color:#98C379;--shiki-dark:#98C379;"> tag1</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;item1&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> tag2</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;item2&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                         # 单选界面</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dialog</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --title</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Installation&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --backtitle</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Star Linux&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --gauge</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Linux Kernel&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  10</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 60</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 50</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 进度条</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dialog</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --title</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;标题&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --backtitle</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Dialog&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --yesno</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;说明&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 20</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 60</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                 # 选择yes/no</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dialog</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --title</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;公告标题&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --backtitle</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Dialog&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --msgbox</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;内容&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 20</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 60</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                            # 公告</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dialog</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --title</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;hey&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --backtitle</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Dialog&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --infobox</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Is everything okay?&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 60</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                 # 显示讯息后立即离开</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dialog</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --title</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;hey&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --backtitle</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Dialog&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --inputbox</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Is okay?&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 60</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;yes&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     # 输入对话框</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dialog</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --title</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Array 30&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --backtitle</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;All &quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --textbox</span><span style="color:#98C379;--shiki-dark:#98C379;"> /root/txt</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 20</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 75</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                          # 显示文档内容</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dialog</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --title</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Add&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --form</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;input&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 12</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 40</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 4</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;user&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 15</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 15</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;name&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 15</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 15</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 多条输入对话框</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dialog</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --title</span><span style="color:#98C379;--shiki-dark:#98C379;">  &quot;Password&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  --insecure</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  --passwordbox</span><span style="color:#98C379;--shiki-dark:#98C379;">  &quot;请输入密码&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  10</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  35</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                     # 星号显示输入--insecure</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dialog</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --stdout</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --title</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;日历&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  --calendar</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;请选择&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 9</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2010</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                                # 选择日期</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dialog</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --title</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;title&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --menu</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;MENU&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 20</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 60</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 14</span><span style="color:#98C379;--shiki-dark:#98C379;"> tag1</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;item1&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> tag2</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;item2&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 2&gt;</span><span style="color:#98C379;--shiki-dark:#98C379;">tmp</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 取到结果放到文件中(以标准错误输出结果)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">a</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dialog</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --title</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;title&quot;  </span><span style="color:#D19A66;--shiki-dark:#D19A66;">--stdout</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --menu</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;MENU&quot; </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 60</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 14</span><span style="color:#98C379;--shiki-dark:#98C379;"> tag1 &quot;item1&quot; tag2 &quot;item2&quot;\`</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 选择操作赋给变量(使用标准输出)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dialog菜单实例</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    while</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> :</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    do</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    clear</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    menu</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dialog</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --title</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;title&quot;  </span><span style="color:#D19A66;--shiki-dark:#D19A66;">--stdout</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --menu</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;MENU&quot; </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 60</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 14</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#98C379;--shiki-dark:#98C379;"> system </span><span style="color:#D19A66;--shiki-dark:#D19A66;">2</span><span style="color:#98C379;--shiki-dark:#98C379;"> custom\`</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    [ </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$?</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -eq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ] &amp;&amp; </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$menu</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> || </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">exit</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 判断dialog执行,取消退出</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        while</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> :</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        do</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">            case</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $menu</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                list</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;1a &quot;item1&quot; 2a &quot;item2&quot;&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 定义菜单列表变量</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            ;;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                list</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;1b &quot;item3&quot; 2b &quot;item4&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            ;;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">            esac</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            result</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dialog</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --title</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;title&quot;  </span><span style="color:#D19A66;--shiki-dark:#D19A66;">--stdout</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --menu</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;MENU&quot; </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 60</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 14</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $list</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            [ </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$?</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -eq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ] &amp;&amp; </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$result</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> || </span><span style="color:#C678DD;--shiki-dark:#C678DD;">break</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 判断dialog执行,取消返回菜单,注意:配合上层菜单循环</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            read</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        done</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    done</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="select菜单" tabindex="-1"><a class="header-anchor" href="#select菜单"><span>select菜单</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 输入项不在菜单自动会提示重新输入</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        select</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> menuitem</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> in pick1 pick2 pick3 退出</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        do</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $menuitem</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">            case</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $menuitem</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            退出</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                exit</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            ;;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            *)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                select</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> area</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> in area1 area2 area3 返回</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                do</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                    echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $area</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                    case</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $area</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                    返回</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                        break</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                    ;;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                    *)</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                        echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;对</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$area操作</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                    ;;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                    esac</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                done</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            ;;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">            esac</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        done</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="shift" tabindex="-1"><a class="header-anchor" href="#shift"><span>shift</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">./cs.sh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/sh</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">until</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$#</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -eq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ]</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;第一个参数为: </span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$1</span><span style="color:#98C379;--shiki-dark:#98C379;"> 参数个数为: </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$#</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #shift 命令执行前变量 $1 的值在shift命令执行后不可用</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    shift</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span></code></pre></div><h3 id="getopts" tabindex="-1"><a class="header-anchor" href="#getopts"><span>getopts</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/sh</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">while</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> getopts</span><span style="color:#98C379;--shiki-dark:#98C379;"> :ab:</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    case</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $name</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    a</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        aflag</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ;;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    b</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        bflag</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">1</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        bval</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$OPTARG</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ;;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    \\?</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;USAGE:\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">basename</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> $0</span><span style="color:#98C379;--shiki-dark:#98C379;">\` [-a] [-b value]&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        exit</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ;;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    esac</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">!</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -z</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $aflag</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ] ; </span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;option -a specified&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$aflag</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$OPTIND</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">fi</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">!</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -z</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $bflag</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ] ; </span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;">  &quot;option -b specified&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;">  &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$bflag</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;">  &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$bval</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;">  &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$OPTIND</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">fi</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;here  </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$OPTIND</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">shift</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> $((</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$OPTIND</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> -1))</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$OPTIND</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot; \`</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">shift</span><span style="color:#98C379;--shiki-dark:#98C379;"> $((</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$OPTIND</span><span style="color:#98C379;--shiki-dark:#98C379;"> -1))\`  &quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="tclsh" tabindex="-1"><a class="header-anchor" href="#tclsh"><span>tclsh</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">set</span><span style="color:#98C379;--shiki-dark:#98C379;"> foo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;a bc&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 定义变量</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">set</span><span style="color:#98C379;--shiki-dark:#98C379;"> b</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$a</span><span style="color:#98C379;--shiki-dark:#98C379;">}</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;                      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 转义  b的值为&quot; $a &quot; ,而不是变量结果</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">set</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">; </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">incr</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;               </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 数字的自增.  将a加3,如果要减3,则为 incr a –3;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">set</span><span style="color:#98C379;--shiki-dark:#98C379;"> c</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [expr </span><span style="color:#98C379;--shiki-dark:#98C379;">20/5]</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;               </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 计算  c的值为4</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">puts</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $foo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;                       </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 打印变量</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">set</span><span style="color:#98C379;--shiki-dark:#98C379;"> qian</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">123</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">f</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;                 </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 定义数组</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">set</span><span style="color:#98C379;--shiki-dark:#98C379;"> qian</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1,1,1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">fs</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;              </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 多维数组</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">parray</span><span style="color:#98C379;--shiki-dark:#98C379;"> qian</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;                     </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 打印数组的所有信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">string</span><span style="color:#98C379;--shiki-dark:#98C379;"> length</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $qian</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;             </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将返回变量qian的长度</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">string</span><span style="color:#98C379;--shiki-dark:#98C379;"> option</span><span style="color:#98C379;--shiki-dark:#98C379;"> string1</span><span style="color:#98C379;--shiki-dark:#98C379;"> string2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;   </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 字符相关串操作</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># option 的操作选项:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># compare           按照字典的排序方式进行比较。根据string1 &lt;,=,&gt;string2分别返回-1,0,1</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># first             返回string2中第一次出现string1的位置，如果没有出现string1则返回-1</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># last              和first相反</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># trim              从string1中删除开头和结尾的出现在string2中的字符</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># tolower           返回string1中的所有字符被转换为小写字符后的新字符串</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># toupper           返回string1中的所有字符串转换为大写后的字符串</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># length            返回string1的长度</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">set</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#C678DD;--shiki-dark:#C678DD;">while</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$a</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt; 3} { </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">set</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [incr </span><span style="color:#98C379;--shiki-dark:#98C379;">a</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;]; };puts $a    # 判断变量a小于3既循环</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">initialization}</span><span style="color:#98C379;--shiki-dark:#98C379;"> {condition}</span><span style="color:#98C379;--shiki-dark:#98C379;"> {increment}</span><span style="color:#98C379;--shiki-dark:#98C379;"> {body}</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 初始化变量,条件,增量,具体操作</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">set</span><span style="color:#98C379;--shiki-dark:#98C379;"> i</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#98C379;--shiki-dark:#98C379;">}</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$i</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt; </span><span style="color:#D19A66;--shiki-dark:#D19A66;">10</span><span style="color:#98C379;--shiki-dark:#98C379;">}</span><span style="color:#98C379;--shiki-dark:#98C379;"> {incr</span><span style="color:#98C379;--shiki-dark:#98C379;"> i}</span><span style="color:#98C379;--shiki-dark:#98C379;"> {puts</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $i</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;}              </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将打印出0到9</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> { </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">表达式</span><span style="color:#98C379;--shiki-dark:#98C379;"> }</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        #运算;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">} </span><span style="color:#C678DD;--shiki-dark:#C678DD;">else</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        #其他运算;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">switch</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $x</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    字符串1</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span><span style="color:#98C379;--shiki-dark:#98C379;"> 操作1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ;}</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    字符串2</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span><span style="color:#98C379;--shiki-dark:#98C379;"> 操作2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ;}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">f</span><span style="color:#98C379;--shiki-dark:#98C379;">oreach</span><span style="color:#98C379;--shiki-dark:#98C379;"> element</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0</span><span style="color:#98C379;--shiki-dark:#98C379;"> m</span><span style="color:#98C379;--shiki-dark:#98C379;"> n</span><span style="color:#98C379;--shiki-dark:#98C379;"> b</span><span style="color:#98C379;--shiki-dark:#98C379;"> v}</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将在一组变元中进行循环，并且每次都将执行他的循环体</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        switch</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $element</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                # 判断element的值</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        }</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="expect交互" tabindex="-1"><a class="header-anchor" href="#expect交互"><span>expect交互</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">exp_continue</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 多个spawn命令时并行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">interact</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 执行完成后保持交互状态，把控制权交给控制台</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">expect</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;password:&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 判断关键字符</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">send</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;passwd\\r&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # 执行交互动作，与手工输入密码的动作等效。字符串结尾加&quot;\\r&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ssh后sudo</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #!/bin/bash</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #sudo注释下行允许后台运行</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #Defaults requiretty</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #sudo去掉!允许远程</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #Defaults !visiblepw</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    /usr/bin/expect</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -c</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    set timeout 5</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    spawn ssh -o StrictHostKeyChecking=no xuesong1@192.168.42.128 &quot;sudo grep xuesong1 /etc/passwd&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    expect {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        &quot;passphrase&quot; {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            send_user &quot;sshkey\\n&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            send &quot;xuesong\\r&quot;;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            expect {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                &quot;sudo&quot; {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send_user &quot;sudo\\n&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send &quot;xuesong\\r&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                interact</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                eof {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send_user &quot;sudo eof\\n&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        &quot;password:&quot; {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            send_user &quot;ssh\\n&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            send &quot;xuesong\\r&quot;;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            expect {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                &quot;sudo&quot; {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send_user &quot;sudo\\n&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send &quot;xuesong\\r&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                interact</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                eof {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send_user &quot;sudo eof\\n&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        &quot;sudo&quot; {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send_user &quot;sudo\\n&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send &quot;xuesong\\r&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                interact</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        eof {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            send_user &quot;ssh eof\\n&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    &#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ssh执行命令操作</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    /usr/bin/expect</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -c</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    proc jiaohu {} {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        send_user expect_start</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        expect {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            password {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">RemotePasswd</span><span style="color:#98C379;--shiki-dark:#98C379;">}\\r;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send_user expect_eof</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                expect {</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                    \\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">does not exist</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        send_user expect_failure</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        exit 10</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    password {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        send_user expect_failure</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        exit 5</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    Password {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        send \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">RemoteRootPasswd</span><span style="color:#98C379;--shiki-dark:#98C379;">}\\r;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        send_user expect_eof</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        expect {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                            incorrect {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                                send_user expect_failure</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                                exit 6</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                            }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                            eof</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    eof</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            passphrase {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">KeyPasswd</span><span style="color:#98C379;--shiki-dark:#98C379;">}\\r;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send_user expect_eof</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                expect {</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                    \\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">does not exist</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        send_user expect_failure</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        exit 10</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    passphrase{</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        send_user expect_failure</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        exit 7</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    Password {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        send \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">RemoteRootPasswd</span><span style="color:#98C379;--shiki-dark:#98C379;">}\\r;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        send_user expect_eof</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        expect {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                            incorrect {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                                send_user expect_failure</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                                exit 6</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                            }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                            eof</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    eof</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            Password {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">RemoteRootPasswd</span><span style="color:#98C379;--shiki-dark:#98C379;">}\\r;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send_user expect_eof</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                expect {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    incorrect {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        send_user expect_failure</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        exit 6</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    eof</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            }</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            \\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">No route to host</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send_user expect_failure</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                exit 4</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            }</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            \\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">Invalid argument</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send_user expect_failure</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                exit 8</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            }</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            \\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">Connection refused</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send_user expect_failure</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                exit 9</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            }</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            \\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">does not exist</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send_user expect_failure</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                exit 10</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            \\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">Connection timed out</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send_user expect_failure</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                exit 11</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            timeout {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                send_user expect_failure</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                exit 3</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            eof</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    set timeout </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$TimeOut</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    switch </span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$1</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        Ssh_Cmd {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            spawn ssh -t -p </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Port</span><span style="color:#98C379;--shiki-dark:#98C379;"> -o StrictHostKeyChecking=no </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$RemoteUser</span><span style="color:#98C379;--shiki-dark:#98C379;">@</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Ip</span><span style="color:#98C379;--shiki-dark:#98C379;"> /bin/su - root -c </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\\\\\&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Cmd</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\\\\\&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            jiaohu</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        Ssh_Script {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            spawn scp -P </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Port</span><span style="color:#98C379;--shiki-dark:#98C379;"> -o StrictHostKeyChecking=no </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$ScriptPath</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $RemoteUser</span><span style="color:#98C379;--shiki-dark:#98C379;">@</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Ip</span><span style="color:#98C379;--shiki-dark:#98C379;">:/tmp/\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">ScriptPath</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">##*/</span><span style="color:#98C379;--shiki-dark:#98C379;">};</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            jiaohu</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            spawn ssh -t -p </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Port</span><span style="color:#98C379;--shiki-dark:#98C379;"> -o StrictHostKeyChecking=no </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$RemoteUser</span><span style="color:#98C379;--shiki-dark:#98C379;">@</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Ip</span><span style="color:#98C379;--shiki-dark:#98C379;"> /bin/su - root -c  </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\\\\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">/bin/sh /tmp/\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">ScriptPath</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">##*/</span><span style="color:#98C379;--shiki-dark:#98C379;">}</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\\\\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> ;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            jiaohu</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        Scp_File {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            spawn scp -P </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Port</span><span style="color:#98C379;--shiki-dark:#98C379;"> -o StrictHostKeyChecking=no -r </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$ScpPath</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $RemoteUser</span><span style="color:#98C379;--shiki-dark:#98C379;">@</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Ip</span><span style="color:#98C379;--shiki-dark:#98C379;">:\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">ScpRemotePath</span><span style="color:#98C379;--shiki-dark:#98C379;">};</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            jiaohu</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    &quot;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    state</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> $?</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">交互双引号引用较长变量</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #!/bin/bash</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    RemoteUser</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">xuesong12</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    Ip</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">192.168.1.2</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    RemotePasswd</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">xuesong</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    Cmd</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;/bin/echo &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$PubKey</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot; &gt; &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$RemoteKey</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;/authorized_keys&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    /usr/bin/expect</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -c</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    set timeout 10</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    spawn ssh -o StrictHostKeyChecking=no </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$RemoteUser</span><span style="color:#98C379;--shiki-dark:#98C379;">@</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Ip</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Cmd</span><span style="color:#98C379;--shiki-dark:#98C379;">};</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    expect {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        password: {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            send_user RemotePasswd\\n</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            send \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">RemotePasswd</span><span style="color:#98C379;--shiki-dark:#98C379;">}\\r;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            interact;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        eof {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            send_user eof\\n</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    &quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">telnet交互</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #!/bin/bash</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    Ip</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;10.0.1.53&quot;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    a</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;\\{\\&#39;method\\&#39;\\:\\&#39;doLogin\\&#39;\\,\\&#39;params\\&#39;\\:\\{\\&#39;uName\\&#39;\\:\\&#39;bobbietest\\&#39;\\}&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    /usr/bin/expect</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -c</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            set timeout 15</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            spawn telnet \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">Ip</span><span style="color:#98C379;--shiki-dark:#98C379;">} 8000</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            expect &quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;">Escape</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            send &quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;">\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">a</span><span style="color:#D19A66;--shiki-dark:#D19A66;">}</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\\\</span><span style="color:#D19A66;--shiki-dark:#D19A66;">r</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            expect {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    -re &quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;">err.</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">*</span><span style="color:#D19A66;--shiki-dark:#D19A66;">none</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot; {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                            exit 0</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    timeout {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                            exit 1</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    eof {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                            exit 2</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    &quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> $?</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">模拟ssh登录</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #好处:可加载环境变量</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #!/bin/bash</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    Ip</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;192.168.1.6&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 循环就行</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    RemoteUser</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;user&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 普通用户</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    RemotePasswd</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;userpasswd&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 普通用户的密码</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    RemoteRootPasswd</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;rootpasswd&#39;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    /usr/bin/expect</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -c</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    set timeout -1</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    spawn ssh -t -p </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Port</span><span style="color:#98C379;--shiki-dark:#98C379;"> -o StrictHostKeyChecking=no </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$RemoteUser</span><span style="color:#98C379;--shiki-dark:#98C379;">@</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Ip</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    expect {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        password {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            send_user RemotePasswd</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            send \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">RemotePasswd</span><span style="color:#98C379;--shiki-dark:#98C379;">}\\r;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            expect {</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                \\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">does not exist</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    send_user </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">root user does not exist\\n</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    exit 10</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                password {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    send_user </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">user passwd error\\n</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    exit 5</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                Last {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    send </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">su - batch\\n</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    expect {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        Password {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                            send_user RemoteRootPasswd</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                            send \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">RemoteRootPasswd</span><span style="color:#98C379;--shiki-dark:#98C379;">}\\r;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                            expect {</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                                \\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">]#</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                                    send </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">sh /tmp/update.sh update\\n </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                                    expect {</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                                        \\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">]#</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                                            send_user \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">Ip</span><span style="color:#98C379;--shiki-dark:#98C379;">}_Update_Done\\n</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                                        }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                                        eof</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                                    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                                }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                            }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                        }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        }</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        \\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">No route to host</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            send_user </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">host not found\\n</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            exit 4</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        }</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        \\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">Invalid argument</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            send_user </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">incorrect parameter\\n</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            exit 8</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        }</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        \\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">Connection refused</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            send_user </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">invalid port parameters\\n</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            exit 9</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        }</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        \\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">does not exist</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            send_user </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">root user does not exist</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            exit 10</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        timeout {</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            send_user </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;">connection timeout \\n</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">            exit 3</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        eof</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    }</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    &quot;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    state</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> $?</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="实例" tabindex="-1"><a class="header-anchor" href="#实例"><span>实例</span></a></h2><h3 id="从1叠加到100" tabindex="-1"><a class="header-anchor" href="#从1叠加到100"><span>从1叠加到100</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> $</span><span style="color:#98C379;--shiki-dark:#98C379;">[</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">$(</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> +{1..100}</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#98C379;--shiki-dark:#98C379;">]</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> $</span><span style="color:#98C379;--shiki-dark:#98C379;">[</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">100+1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">100/2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#98C379;--shiki-dark:#98C379;">]</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;+&#39;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 100</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">bc</span></span></code></pre></div><h3 id="判断参数是否为空-空退出并打印null" tabindex="-1"><a class="header-anchor" href="#判断参数是否为空-空退出并打印null"><span>判断参数是否为空-空退出并打印null</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/sh</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> $1</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">name</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">\${1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:?</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;null&quot;</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">}</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $name</span></span></code></pre></div><h3 id="循环数组" tabindex="-1"><a class="header-anchor" href="#循环数组"><span>循环数组</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ((</span><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&lt;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">\${#</span><span style="color:#E06C75;--shiki-dark:#E06C75;">o</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[*]};</span><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">++</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">o</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$i</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">]}</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span></code></pre></div><h3 id="判断路径" tabindex="-1"><a class="header-anchor" href="#判断路径"><span>判断路径</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-d</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> /root/Desktop/text/123 ];</span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;找到了123&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-d</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> /root/Desktop/text ]</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    then</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;找到了text&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    else</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;没找到text&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    fi</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">else</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;没找到123文件夹&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">fi</span></span></code></pre></div><h3 id="找出出现次数最多" tabindex="-1"><a class="header-anchor" href="#找出出现次数最多"><span>找出出现次数最多</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{print $1}&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sort</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">uniq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -c</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sort</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -k1r</span></span></code></pre></div><h3 id="判断脚本参数是否正确" tabindex="-1"><a class="header-anchor" href="#判断脚本参数是否正确"><span>判断脚本参数是否正确</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">./test.sh</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  -p</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 123</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -P</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3306</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -h</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 127.0.0.1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -u</span><span style="color:#98C379;--shiki-dark:#98C379;"> root</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/sh</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$#</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -ne</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 8</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ];</span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;USAGE: </span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$0</span><span style="color:#98C379;--shiki-dark:#98C379;"> -u user -p passwd -P port -h host&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    exit</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">while</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> getopts</span><span style="color:#98C379;--shiki-dark:#98C379;"> :u:p:P:h:</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    case</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $name</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    u</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        mysql_user</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$OPTARG</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ;;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    p</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        mysql_passwd</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$OPTARG</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ;;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    P</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        mysql_port</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$OPTARG</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ;;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    h</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        mysql_host</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$OPTARG</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ;;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    *)</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;USAGE: </span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$0</span><span style="color:#98C379;--shiki-dark:#98C379;"> -u user -p passwd -P port -h host&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        exit</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ;;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    esac</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-z</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $mysql_user</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ] || [ </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-z</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $mysql_passwd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ] || [ </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-z</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $mysql_port</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ] || [ </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-z</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $mysql_host</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ]</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;USAGE: </span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$0</span><span style="color:#98C379;--shiki-dark:#98C379;"> -u user -p passwd -P port -h host&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    exit</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $mysql_user</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $mysql_passwd</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $mysql_port</span><span style="color:#E06C75;--shiki-dark:#E06C75;">  $mysql_host</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#结果 root 123 3306 127.0.0.1</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="正则匹配邮箱" tabindex="-1"><a class="header-anchor" href="#正则匹配邮箱"><span>正则匹配邮箱</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        ^[_a-z0-9-]+(\\.[_a-z0-9-]+</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)*@[a-z0-9-]+(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">\\.[a-z0-9-]+</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)*(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">\\.[a-z]</span><span style="color:#98C379;--shiki-dark:#98C379;">{2,4}</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)$</span></span></code></pre></div><h3 id="打印表格" tabindex="-1"><a class="header-anchor" href="#打印表格"><span>打印表格</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/sh</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">clear</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;BEGIN{</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">print &quot;+--------------------+--------------------+&quot;;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">printf &quot;|%-20s|%-20s|\\n&quot;,&quot;Name&quot;,&quot;Number&quot;;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">print &quot;+--------------------+--------------------+&quot;;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">}&#39;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">a</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;^[A-Z]&quot; a.txt </span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sort</span><span style="color:#98C379;--shiki-dark:#98C379;"> +1 </span><span style="color:#D19A66;--shiki-dark:#D19A66;">-n</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{print $1&quot;:&quot;$2}&#39;\`</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#cat a.txt |sort +1 -n |while read list</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> list</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $a</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    name</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $list</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -F:</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{print $1}&#39;\`</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    number</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $list</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -F:</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{print $2}&#39;\`</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;BEGIN{printf &quot;|%-20s|%-20s|\\n&quot;,&quot;&#39;&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$name</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;&#39;&quot;,&quot;&#39;&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$number</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;&#39;&quot;;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    print &quot;+--------------------+--------------------+&quot;;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    }&#39;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;BEGIN{</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">print &quot;              *** The End ***              &quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">print &quot;                                           &quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">}&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="判断日期是否合法" tabindex="-1"><a class="header-anchor" href="#判断日期是否合法"><span>判断日期是否合法</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/sh</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">while</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> read</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $a</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -q</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;-&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &amp;&amp; </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">date</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $a</span><span style="color:#98C379;--shiki-dark:#98C379;"> +%Y%m%d</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">/dev/null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 2&gt;&amp;1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    then</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $a</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;^[0-9]\\{4\\}-[01][0-9]-[0-3][0-9]$&#39;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    then</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        break</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    else</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;您输入的日期不合法，请从新输入！&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    fi</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    else</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;您输入的日期不合法，请从新输入！&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    fi</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;日期为</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$a</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="打印日期段所有日期" tabindex="-1"><a class="header-anchor" href="#打印日期段所有日期"><span>打印日期段所有日期</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">qsrq</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">20010101</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">jsrq</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">20010227</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">n</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">0</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;tmp</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">while</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> :</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">current</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">$(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">date</span><span style="color:#98C379;--shiki-dark:#98C379;"> +%Y%m%d</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$n</span><span style="color:#98C379;--shiki-dark:#98C379;"> day </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$qsrq</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [[ </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$current</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> ==</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $jsrq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ]];</span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $current</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt;&gt;</span><span style="color:#98C379;--shiki-dark:#98C379;">tmp</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#C678DD;--shiki-dark:#C678DD;">break</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">else</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $current</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt;&gt;</span><span style="color:#98C379;--shiki-dark:#98C379;">tmp</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ((</span><span style="color:#E06C75;--shiki-dark:#E06C75;">n</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">++</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">fi</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">rq</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;NR==1{print}&#39; tmp\`</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="数学计算的小算法" tabindex="-1"><a class="header-anchor" href="#数学计算的小算法"><span>数学计算的小算法</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/sh</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">A</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">1</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">B</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">while</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$A</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -le</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ]</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    SUM</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">expr</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $A</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> \\*</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $B</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$SUM</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$A</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ]</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    then</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        B</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">expr</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $B</span><span style="color:#98C379;--shiki-dark:#98C379;"> + </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        A</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    fi</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    A</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">expr</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $A</span><span style="color:#98C379;--shiki-dark:#98C379;"> + </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span></code></pre></div><h3 id="多行合并" tabindex="-1"><a class="header-anchor" href="#多行合并"><span>多行合并</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{N;s/\\n//}&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                   # 将两行合并一行(去掉换行符)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{printf(NR%2!=0)?$0&quot; &quot;:$0&quot; \\n&quot;}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 将两行合并一行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{printf&quot;%s &quot;,$0}&#39;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                  # 将所有行合并</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{if (NR%4==0){print $0} else {printf&quot;%s &quot;,$0}}&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 将4行合并为一行(可扩展)</span></span></code></pre></div><h3 id="横竖转换" tabindex="-1"><a class="header-anchor" href="#横竖转换"><span>横竖转换</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> a.txt</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">xargs</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 列转行</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> a.txt</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">xargs</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n1</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 行转列</span></span></code></pre></div><h3 id="竖行转横行" tabindex="-1"><a class="header-anchor" href="#竖行转横行"><span>竖行转横行</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;\\n&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39; &#39;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> $(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> file</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/sh</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> i</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span><span style="color:#98C379;--shiki-dark:#98C379;"> \`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> file\`</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        a</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">a</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot; &quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $a</span></span></code></pre></div><h3 id="取用户的根目录" tabindex="-1"><a class="header-anchor" href="#取用户的根目录"><span>取用户的根目录</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#! /bin/bash</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">while</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> read</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#98C379;--shiki-dark:#98C379;"> pass</span><span style="color:#98C379;--shiki-dark:#98C379;"> uid</span><span style="color:#98C379;--shiki-dark:#98C379;"> gid</span><span style="color:#98C379;--shiki-dark:#98C379;"> gecos</span><span style="color:#98C379;--shiki-dark:#98C379;"> home</span><span style="color:#98C379;--shiki-dark:#98C379;"> shell</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $home</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt; /etc/passwd</span></span></code></pre></div><h3 id="远程打包" tabindex="-1"><a class="header-anchor" href="#远程打包"><span>远程打包</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ssh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $ip</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;find &#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$path</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39; /data /opt -type f  -name &quot;*.sh&quot; -or -name &quot;*.py&quot; -or -name &quot;*.pl&quot; |xargs tar zcvpf /tmp/data_backup.tar.gz&#39;</span></span></code></pre></div><h3 id="把汉字转成encode格式" tabindex="-1"><a class="header-anchor" href="#把汉字转成encode格式"><span>把汉字转成encode格式</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> 论坛</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\\n&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">xxd</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;s/ 0x/%/g&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot; ,\\n&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%c2%db%cc%b3</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> 论坛</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\\n&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">xxd</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;s/ 0x/%/g&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot; ,\\n&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;[a-f]&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;[A-F]&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 大写的</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">%C2%DB%CC%B3</span></span></code></pre></div><h3 id="把目录带有大写字母的文件名改为全部小写" tabindex="-1"><a class="header-anchor" href="#把目录带有大写字母的文件名改为全部小写"><span>把目录带有大写字母的文件名改为全部小写</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> f</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span><span style="color:#98C379;--shiki-dark:#98C379;"> *</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    mv</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $f</span><span style="color:#98C379;--shiki-dark:#98C379;"> \`</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $f</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;[A-Z]&quot; &quot;[a-z]&quot;\`</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span></code></pre></div><h3 id="查找连续多行-在不连续的行前插入" tabindex="-1"><a class="header-anchor" href="#查找连续多行-在不连续的行前插入"><span>查找连续多行，在不连续的行前插入</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#/bin/bash</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">lastrow</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">null</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">0</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> incl</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|while read line</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">expr</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $i</span><span style="color:#98C379;--shiki-dark:#98C379;"> + </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">if</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$lastrow</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;#include &lt;[A-Z].h&gt;&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$line</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -v</span><span style="color:#98C379;--shiki-dark:#98C379;">  &quot;#include &lt;[A-Z].h&gt;&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    then</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$i</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;i\\\\/\\/All header files are include&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> incl</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">expr</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $i</span><span style="color:#98C379;--shiki-dark:#98C379;"> + </span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    fi</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">fi</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">lastrow</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$line</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="查询数据库其它引擎" tabindex="-1"><a class="header-anchor" href="#查询数据库其它引擎"><span>查询数据库其它引擎</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#/bin/bash</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">path1</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">/data/mysql/data/</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">dbpasswd</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">db123</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#MyISAM或InnoDB</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">engine</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">InnoDB</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">-d</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $path1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ];</span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">dir</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ls</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $path1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/\\/$/&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -F</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/&#39; &#39;{print $1}&#39;\`</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> db</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $dir</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    do</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    number</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mysql</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -uroot</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$dbpasswd</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -S</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$path1</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;mysql.sock </span><span style="color:#D19A66;--shiki-dark:#D19A66;">-e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;use \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">db</span><span style="color:#98C379;--shiki-dark:#98C379;">};show table status;&quot; </span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -c</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $engine</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$number</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -ne</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ];</span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">db</span><span style="color:#98C379;--shiki-dark:#98C379;">}&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        fi</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    done</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">fi</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="批量修改数据库引擎" tabindex="-1"><a class="header-anchor" href="#批量修改数据库引擎"><span>批量修改数据库引擎</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#/bin/bash</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> db</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span><span style="color:#98C379;--shiki-dark:#98C379;"> test</span><span style="color:#98C379;--shiki-dark:#98C379;"> test1</span><span style="color:#98C379;--shiki-dark:#98C379;"> test3</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    tables</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mysql</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -uroot</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -pdb123</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -S</span><span style="color:#98C379;--shiki-dark:#98C379;"> /data/mysql/data/mysql.sock </span><span style="color:#D19A66;--shiki-dark:#D19A66;">-e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;use </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$db</span><span style="color:#98C379;--shiki-dark:#98C379;">;show tables;&quot; </span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;NR != 1{print}&#39;\`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> table</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $tables</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    do</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        mysql</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -uroot</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -pdb123</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -S</span><span style="color:#98C379;--shiki-dark:#98C379;"> /data/mysql/data/mysql.sock</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;use </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$db</span><span style="color:#98C379;--shiki-dark:#98C379;">;alter table </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$table</span><span style="color:#98C379;--shiki-dark:#98C379;"> engine=MyISAM;&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    done</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span></code></pre></div><h3 id="将shell取到的数据插入mysql数据库" tabindex="-1"><a class="header-anchor" href="#将shell取到的数据插入mysql数据库"><span>将shell取到的数据插入mysql数据库</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mysql</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -u</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$username</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$passwd</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -h</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$dbhost</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -P</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$dbport</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -A</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">use </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$dbname</span><span style="color:#98C379;--shiki-dark:#98C379;">;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">insert into data values (&#39;&#39;,&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$ip</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;,&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$date</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;,&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$time</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;,&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$data</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;)</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span></code></pre></div><h3 id="两日期间隔天数" tabindex="-1"><a class="header-anchor" href="#两日期间隔天数"><span>两日期间隔天数</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">D1</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">date</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;20070409&#39; +&quot;%s&quot;\`</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">D2</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">date</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;20070304 &#39; +&quot;%s&quot;\`</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">D3</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">$((</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$D1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> - </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$D2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> $((</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$D3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">/60/60/24))</span></span></code></pre></div><h3 id="while执行ssh只循环一次" tabindex="-1"><a class="header-anchor" href="#while执行ssh只循环一次"><span>while执行ssh只循环一次</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> -</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 让cat读连接文件stdin的信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#C678DD;--shiki-dark:#C678DD;">while</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> read</span><span style="color:#98C379;--shiki-dark:#98C379;"> line</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">; </span><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> ssh</span><span style="color:#98C379;--shiki-dark:#98C379;"> localhost</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;cat -&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">; </span><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 显示的9次是被ssh吃掉的</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#C678DD;--shiki-dark:#C678DD;">while</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> read</span><span style="color:#98C379;--shiki-dark:#98C379;"> line</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">; </span><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> ssh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> localhost</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;cat -&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">; </span><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # ssh加上-n参数可避免只循环一次</span></span></code></pre></div><h3 id="ssh批量执行命令" tabindex="-1"><a class="header-anchor" href="#ssh批量执行命令"><span>ssh批量执行命令</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#版本1</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">while</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> read</span><span style="color:#98C379;--shiki-dark:#98C379;"> line</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">Ip</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $line</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{print $1}&#39;\`</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">Passwd</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $line</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{print $2}&#39;\`</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ssh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> localhost</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;cat -&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sshpass</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Passwd</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> ssh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -o</span><span style="color:#98C379;--shiki-dark:#98C379;"> StrictHostKeyChecking=no</span><span style="color:#98C379;--shiki-dark:#98C379;"> root@</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Ip</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;id&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">done&lt;iplist.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#版本2</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">Iplist</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{print $1}&#39; iplist.txt\`</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> Ip</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $Iplist</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">Passwd</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Ip</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/{print $2}&#39; iplist.txt\`</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sshpass</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Passwd</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> ssh</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -t</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -o</span><span style="color:#98C379;--shiki-dark:#98C379;"> StrictHostKeyChecking=no</span><span style="color:#98C379;--shiki-dark:#98C379;"> root@</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Ip</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;id&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="在同一位置打印字符" tabindex="-1"><a class="header-anchor" href="#在同一位置打印字符"><span>在同一位置打印字符</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -ne</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\\t&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> i</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span><span style="color:#98C379;--shiki-dark:#98C379;"> \`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -w</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 100</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -ne</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$i</span><span style="color:#98C379;--shiki-dark:#98C379;">\\b\\b\\b&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 关键\\b退格</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    sleep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span></code></pre></div><h3 id="多进程后台并发简易控制" tabindex="-1"><a class="header-anchor" href="#多进程后台并发简易控制"><span>多进程后台并发简易控制</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        #!/bin/bash</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        test</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $a</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">            sleep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 5</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> a</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span><span style="color:#98C379;--shiki-dark:#98C379;"> \`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 30</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        do</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            test</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &amp;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            echo</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> $!</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            ((</span><span style="color:#E06C75;--shiki-dark:#E06C75;">num</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">++</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">            if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$num</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -eq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ];</span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;wait...&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            wait</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            num</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">0</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">            fi</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        done</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        wait</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="shell并发" tabindex="-1"><a class="header-anchor" href="#shell并发"><span>shell并发</span></a></h2><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">tmpfile</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$$</span><span style="color:#98C379;--shiki-dark:#98C379;">.fifo</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 创建管道名称</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">mkfifo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $tmpfile</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 创建管道</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">exec</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$tmpfile</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 创建文件标示4，以读写方式操作管道$tmpfile</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rm</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $tmpfile</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 将创建的管道文件清除</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">thred</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">4</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           # 指定并发个数</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">seq</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 4</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 5</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 7</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 8</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 9</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 21</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 22</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 23</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 24</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 25</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 31</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 32</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 33</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 34</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 35</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建任务列表</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 为并发线程创建相应个数的占位</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (( </span><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&lt;=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">thred</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">};</span><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">++</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ))</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;  </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 因为read命令一次读取一行，一个echo默认输出一个换行符，所以为每个线程输出一个占位换行</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">} &gt;&amp;4      </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 将占位信息写入管道</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> id</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">seq</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}  </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 从任务列表 seq 中按次序获取每一个任务</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    read</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 读取一行，即fd4中的一个占位符</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    (</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">./ur_command</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">};</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt;&amp;4 ) &amp;   </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 在后台执行任务ur_command 并将任务 \${id} 赋给当前任务；任务执行完后在fd4种写入一个占位符</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &lt;&amp;</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">4</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 指定fd4为整个for的标准输入</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">wait</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 等待所有在此shell脚本中启动的后台任务完成</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">exec</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 4&gt;&amp;</span><span style="color:#98C379;--shiki-dark:#98C379;">-</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 关闭管道</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="shell并发函数" tabindex="-1"><a class="header-anchor" href="#shell并发函数"><span>shell并发函数</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">function</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> ConCurrentCmd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #进程数</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    Thread</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">30</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #列表文件</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    CurFileName</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">iplist.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #定义fifo文件</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    FifoFile</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$$</span><span style="color:#98C379;--shiki-dark:#98C379;">.fifo&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #新建一个fifo类型的文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    mkfifo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $FifoFile</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #将fd6与此fifo类型文件以读写的方式连接起来</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    exec</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$FifoFile</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    rm</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $FifoFile</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #事实上就是在文件描述符6中放置了$Thread个回车符</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ((</span><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&lt;=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Thread</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">++</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">));</span><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> echo;</span><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt;&amp;6</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #此后标准输入将来自fd5</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    exec</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$CurFileName</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #开始循环读取文件列表中的行</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    Count</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">0</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    while</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> read</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -u5</span><span style="color:#98C379;--shiki-dark:#98C379;"> line</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    do</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        read</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -u6</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        let</span><span style="color:#98C379;--shiki-dark:#98C379;"> Count+=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 此处定义一个子进程放到后台执行</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # 一个read -u6命令执行一次,就从fd6中减去一个回车符，然后向下执行</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # fd6中没有回车符的时候,就停在这了,从而实现了进程数量控制</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        {</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $Count</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            #这段代码框就是执行具体的操作了</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            function</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            echo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt;&amp;6</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            #当进程结束以后,再向fd6中追加一个回车符,即补上了read -u6减去的那个</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        } &amp;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    done</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #等待所有后台子进程结束</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    wait</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #关闭fd6</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    exec</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 6&gt;&amp;</span><span style="color:#98C379;--shiki-dark:#98C379;">-</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #关闭fd5</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    exec</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 5&gt;&amp;</span><span style="color:#98C379;--shiki-dark:#98C379;">-</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">并发例子</span><span style="color:#98C379;--shiki-dark:#98C379;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    #!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    pnum</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    task</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$u</span><span style="color:#98C379;--shiki-dark:#98C379;"> start&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        sleep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 5</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$u</span><span style="color:#98C379;--shiki-dark:#98C379;"> done&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    FifoFile</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$$</span><span style="color:#98C379;--shiki-dark:#98C379;">.fifo&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    mkfifo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $FifoFile</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    exec</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&lt;&gt;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$FifoFile</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    rm</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $FifoFile</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    for</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ((</span><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#D19A66;--shiki-dark:#D19A66;">0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">&lt;=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$pnum</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">i</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">++</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">));</span><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> echo;</span><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt;&amp;6</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> u</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span><span style="color:#98C379;--shiki-dark:#98C379;"> \`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 20</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    do</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        read</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -u6</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">            task</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            [ </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$?</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -eq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ] &amp;&amp; </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">u</span><span style="color:#98C379;--shiki-dark:#98C379;">} 次成功&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> || </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">u</span><span style="color:#98C379;--shiki-dark:#98C379;">} 次失败&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            echo</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt;&amp;6</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        } &amp;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    done</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    wait</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    exec</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 6&gt;&amp;</span><span style="color:#98C379;--shiki-dark:#98C379;">-</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="函数" tabindex="-1"><a class="header-anchor" href="#函数"><span>函数</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ip</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(){</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;a 1&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;$1==&quot;&#39;&quot;</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$1</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;&#39;&quot;{print $2}&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">web</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">a</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ip</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $web</span></span></code></pre></div><h3 id="检测软件包是否存在" tabindex="-1"><a class="header-anchor" href="#检测软件包是否存在"><span>检测软件包是否存在</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rpm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -q</span><span style="color:#98C379;--shiki-dark:#98C379;"> dialog</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt;</span><span style="color:#98C379;--shiki-dark:#98C379;">/dev/null</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$?</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -ge</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ];</span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;install dialog,Please wait...&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    yum</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -y</span><span style="color:#98C379;--shiki-dark:#98C379;"> install</span><span style="color:#98C379;--shiki-dark:#98C379;"> dialog</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    rpm</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -q</span><span style="color:#98C379;--shiki-dark:#98C379;"> dialog</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt;</span><span style="color:#98C379;--shiki-dark:#98C379;">/dev/null</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    [ </span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">$?</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -ge</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ] &amp;&amp; </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;dialog installation failure,exit&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &amp;&amp; </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">exit</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;dialog done&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    read</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">fi</span></span></code></pre></div><h3 id="游戏维护菜单-修改配置文件" tabindex="-1"><a class="header-anchor" href="#游戏维护菜单-修改配置文件"><span>游戏维护菜单-修改配置文件</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">conf</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">serverlist.xml</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">AreaList</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -F</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;&quot;&#39; &#39;/&lt;s/{print $2}&#39; </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$conf</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">s</span><span style="color:#98C379;--shiki-dark:#98C379;">elect</span><span style="color:#98C379;--shiki-dark:#98C379;"> area</span><span style="color:#98C379;--shiki-dark:#98C379;"> in</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $AreaList</span><span style="color:#98C379;--shiki-dark:#98C379;"> 全部</span><span style="color:#98C379;--shiki-dark:#98C379;"> 退出</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $area</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    case</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $area</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    退出</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        exit</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ;;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    *)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        select</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> operate</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> in </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;修改版本号&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;添加维护中&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;删除维护中&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;返回菜单&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        do</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">            echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $operate</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">            case</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $operate</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            修改版本号</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> 请输入版本号</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                while</span><span style="color:#98C379;--shiki-dark:#98C379;"> read</span><span style="color:#98C379;--shiki-dark:#98C379;"> version</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                do</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                    if</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $version</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -w</span><span style="color:#98C379;--shiki-dark:#98C379;"> 10[12][0-9][0-9][0-9][0-9][0-9][0-9]</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                    then</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                        break</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                    fi</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> 请从新输入正确的版本号</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                done</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                case</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $area</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                全部</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                    case</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $version</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                    101</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                        echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;请确认操作对 </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$area</span><span style="color:#98C379;--shiki-dark:#98C379;"> 体验区 </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$operate</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                        read</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                        sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/101[0-9][0-9][0-9][0-9][0-9][0-9]/&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$version</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $conf</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                    ;;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                    102</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">*</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                        echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;请确认操作对 </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$area</span><span style="color:#98C379;--shiki-dark:#98C379;"> 正式区 </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$operate</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                        read</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                        sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/102[0-9][0-9][0-9][0-9][0-9][0-9]/&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$version</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $conf</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                    ;;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                    esac</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                ;;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                *)</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                    type</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">\`awk -F &#39;&quot;&#39; &#39;/&#39;$area&#39;/{print $14}&#39; $conf |cut -c1-3\`</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    readtype=</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">\`echo $version |cut -c1-3\`</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">                    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$type</span><span style="color:#98C379;--shiki-dark:#98C379;"> !=</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $readtype</span><span style="color:#98C379;--shiki-dark:#98C379;"> ]</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                    then</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                        echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;版本号不对应，请从新操作&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                        continue</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                    fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;请确认操作对 </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$area</span><span style="color:#98C379;--shiki-dark:#98C379;"> 区 </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$operate</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                    read</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                    awk</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -F</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;&quot;&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$area</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/{print $12}&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $conf</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">xargs</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/&#39;{}&#39;/s/10[12][0-9][0-9][0-9][0-9][0-9][0-9]/&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$version</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $conf</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                ;;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                esac</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            ;;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            添加维护中</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                case</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $area</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                全部</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;请确认操作对 </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$area</span><span style="color:#98C379;--shiki-dark:#98C379;"> 区 </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$operate</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                    read</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                    awk</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -F</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;&quot;&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/&lt;s/{print $2}&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $conf</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">xargs</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/&#39;{}&#39;/&amp;维护中/&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $conf</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                ;;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                *)</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;请确认操作对 </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$area</span><span style="color:#98C379;--shiki-dark:#98C379;"> 区 </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$operate</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                    read</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                    sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$area</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/&amp;维护中/&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $conf</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                ;;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                esac</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            ;;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            删除维护中</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                case</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $area</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">                全部</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;请确认操作对 </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$area</span><span style="color:#98C379;--shiki-dark:#98C379;"> 区 </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$operate</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                    read</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                    sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/维护中//&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $conf</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                ;;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                *)</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;请确认操作对 </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$area</span><span style="color:#98C379;--shiki-dark:#98C379;"> 区 </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$operate</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">                    read</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">                    sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$area</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;/s/维护中//&#39;</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $conf</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                ;;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                esac</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            ;;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            返回菜单</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">                break</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">            ;;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">            esac</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        done</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    ;;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    esac</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;回车重新选择区&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="keepalive剔除后端服务" tabindex="-1"><a class="header-anchor" href="#keepalive剔除后端服务"><span>keepalive剔除后端服务</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#行数请自定义,默认8行</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ X</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$2</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> ==</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> X ];</span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;error: IP null&quot;</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    read</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    exit</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">fi</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">case</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> $1</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">del</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/real_server.*&#39;</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$2</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;.*8888/,+8 s/^/#/&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc/keepalived/keepalived.conf</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    /etc/init.d/keepalived</span><span style="color:#98C379;--shiki-dark:#98C379;"> reload</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">add</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -i</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;/real_server.*&#39;</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$2</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;.*8888/,+8 s/^#//&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc/keepalived/keepalived.conf</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    /etc/init.d/keepalived</span><span style="color:#98C379;--shiki-dark:#98C379;"> reload</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">*)</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Parameter error&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">;;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">esac</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="抓取系统中负载最高的进程" tabindex="-1"><a class="header-anchor" href="#抓取系统中负载最高的进程"><span>抓取系统中负载最高的进程</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">LANG</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">C</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">PATH</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">/sbin:/usr/sbin:/bin:/usr/bin</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">interval</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">1</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">length</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">86400</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> i</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> $(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> $(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">expr</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">length</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">} </span><span style="color:#98C379;--shiki-dark:#98C379;">/</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">interval</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}));</span><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">date</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">LANG</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">C</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> ps</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -eT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -o%cpu,pid,tid,ppid,comm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -v</span><span style="color:#98C379;--shiki-dark:#98C379;"> CPU</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sort</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -r</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">head</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -20</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">date</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">LANG</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">C</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> cat</span><span style="color:#98C379;--shiki-dark:#98C379;"> /proc/loadavg</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{ </span><span style="color:#E06C75;--shiki-dark:#E06C75;">LANG</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">C</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> ps</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -eT</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -o%cpu,pid,tid,ppid,comm</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sed</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -e</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;s/^ *//&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">tr</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -s</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39; &#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -v</span><span style="color:#98C379;--shiki-dark:#98C379;"> CPU</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sort</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -r</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cut</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39; &#39;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -f</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">xargs</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -I</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{} echo -n </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;{} + &quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &amp;&amp; </span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39; 0&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">; } | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">bc</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sleep</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> \${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">interval</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">fuser</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -k</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> $0</span></span></code></pre></div><h3 id="申诉中国反垃圾邮件联盟黑名单" tabindex="-1"><a class="header-anchor" href="#申诉中国反垃圾邮件联盟黑名单"><span>申诉中国反垃圾邮件联盟黑名单</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">IpList</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">awk</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;$1!~&quot;^#&quot;&amp;&amp;$1!=&quot;&quot;{print $1}&#39; host.list\`</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">QueryAdd</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;http://www.anti-spam.org.cn/Rbl/Query/Result&#39;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">ComplaintAdd</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;http://www.anti-spam.org.cn/Rbl/Getout/Submit&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">CONTENT</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;我们是一家正规的XXX。xxxxxxx。恳请将我们的发送服务器IP移出黑名单。谢谢！</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">处理措施：</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">1.XXXX。</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">2.XXXX。&#39;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">CORP</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;abc.com&#39;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">WWW</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;www.abc.cm&#39;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">NAME</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;def&#39;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">MAIL</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;def@163.com.cn&#39;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">TEL</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;010-50000000&#39;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">LEVEL</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;0&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> Ip</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $IpList</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    Status</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">curl</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;IP=</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Ip</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot; </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$QueryAdd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;Getout/ShowForm?IP=&#39; </span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">|</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -wc</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;申诉脱离&#39;\`</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [ </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Status</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> -ge</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ];</span><span style="color:#C678DD;--shiki-dark:#C678DD;">then</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        IpStatus</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;黑名单中&quot;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        results</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">\`</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">curl</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;IP=\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">Ip</span><span style="color:#98C379;--shiki-dark:#98C379;">}&amp;CONTENT=\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">CONTENT</span><span style="color:#98C379;--shiki-dark:#98C379;">}&amp;CORP=\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">CORP</span><span style="color:#98C379;--shiki-dark:#98C379;">}&amp;WWW=\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">WWW</span><span style="color:#98C379;--shiki-dark:#98C379;">}&amp;NAME=\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">NAME</span><span style="color:#98C379;--shiki-dark:#98C379;">}&amp;MAIL=\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">MAIL</span><span style="color:#98C379;--shiki-dark:#98C379;">}&amp;TEL=\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">TEL</span><span style="color:#98C379;--shiki-dark:#98C379;">}&amp;LEVEL=\${</span><span style="color:#E06C75;--shiki-dark:#E06C75;">LEVEL</span><span style="color:#98C379;--shiki-dark:#98C379;">}&quot; </span><span style="color:#E06C75;--shiki-dark:#E06C75;">$ComplaintAdd</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -E</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;您的黑名单脱离申请已提交|该IP的脱离申请已被他人提交|申请由于近期内有被拒绝的记录&#39;\`</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $results</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $results</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;您的黑名单脱离申请已提交&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  &gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">/dev/null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 2&gt;&amp;1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        then</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            complaint</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;申诉成功&#39;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        elif</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $results</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;该IP的脱离申请已被他人提交&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  &gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">/dev/null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 2&gt;&amp;1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        then</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            complaint</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;申诉重复&#39;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        elif</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;"> echo</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> $results</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> | </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">grep</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;申请由于近期内有被拒绝的记录&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  &gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">/dev/null</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 2&gt;&amp;1</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        then</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            complaint</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;申诉拒绝&#39;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        else</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">            complaint</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;异常&#39;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        fi</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    else</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        IpStatus</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;正常&#39;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">        complaint</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">=</span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;无需申诉&#39;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    fi</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    echo</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;</span><span style="color:#E06C75;--shiki-dark:#E06C75;">$Ip</span><span style="color:#E06C75;--shiki-dark:#E06C75;">    $IpStatus</span><span style="color:#E06C75;--shiki-dark:#E06C75;">    $complaint</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> &gt;&gt; $(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">date</span><span style="color:#98C379;--shiki-dark:#98C379;"> +%Y%m%d_%H%M%S</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span><span style="color:#98C379;--shiki-dark:#98C379;">.log</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="web-server-in-awk" tabindex="-1"><a class="header-anchor" href="#web-server-in-awk"><span>Web Server in Awk</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#gawk -f file</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">BEGIN</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    x</span><span style="color:#98C379;--shiki-dark:#98C379;">        =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                         # script exits if x &lt; 1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    port</span><span style="color:#98C379;--shiki-dark:#98C379;">     =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 8080</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # port number</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    host</span><span style="color:#98C379;--shiki-dark:#98C379;">     =</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;/inet/tcp/&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> port</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;/0/0&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # host string</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    url</span><span style="color:#98C379;--shiki-dark:#98C379;">      =</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;http://localhost:&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> port</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # server url</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    status</span><span style="color:#98C379;--shiki-dark:#98C379;">   =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 200</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # 200 == OK</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    reason</span><span style="color:#98C379;--shiki-dark:#98C379;">   =</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;OK&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # server response</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    RS</span><span style="color:#98C379;--shiki-dark:#98C379;"> =</span><span style="color:#98C379;--shiki-dark:#98C379;"> ORS</span><span style="color:#98C379;--shiki-dark:#98C379;"> =</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;\\r\\n&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                    # header line terminators</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    doc</span><span style="color:#98C379;--shiki-dark:#98C379;">      =</span><span style="color:#98C379;--shiki-dark:#98C379;"> Setup</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()                   </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># html document</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    len</span><span style="color:#98C379;--shiki-dark:#98C379;">      =</span><span style="color:#98C379;--shiki-dark:#98C379;"> length</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">doc</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">+</span><span style="color:#98C379;--shiki-dark:#98C379;"> length</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ORS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># length of document</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    while</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">x</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#E06C75;font-style:italic;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">$1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> == </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;GET&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">RunApp(substr($2,</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">        if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (! </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">x</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#C678DD;--shiki-dark:#C678DD;">break</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        print</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;HTTP/1.0&quot;,</span><span style="color:#98C379;--shiki-dark:#98C379;"> status,</span><span style="color:#98C379;--shiki-dark:#98C379;"> reason</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |&amp; </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">host</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        print</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Connection: Close&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        |&amp; </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">host</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        print</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Pragma: no-cache&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">         |&amp; </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">host</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        print</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Content-length:&quot;,</span><span style="color:#98C379;--shiki-dark:#98C379;"> len</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">     |&amp; </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">host</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">        print</span><span style="color:#98C379;--shiki-dark:#98C379;"> ORS</span><span style="color:#98C379;--shiki-dark:#98C379;"> doc</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                    |&amp; </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">host</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        close(host</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)     </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># close client connection</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        host</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |&amp; </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">getline</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # wait for new client request</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # server terminated...</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    doc</span><span style="color:#98C379;--shiki-dark:#98C379;"> =</span><span style="color:#98C379;--shiki-dark:#98C379;"> Bye</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    len</span><span style="color:#98C379;--shiki-dark:#98C379;"> =</span><span style="color:#98C379;--shiki-dark:#98C379;"> length</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">doc</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">+</span><span style="color:#98C379;--shiki-dark:#98C379;"> length</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ORS</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    print</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;HTTP/1.0&quot;,</span><span style="color:#98C379;--shiki-dark:#98C379;"> status,</span><span style="color:#98C379;--shiki-dark:#98C379;"> reason</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> |&amp; </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">host</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    print</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Connection: Close&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">        |&amp; </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">host</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    print</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Pragma: no-cache&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">         |&amp; </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">host</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    print</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Content-length:&quot;,</span><span style="color:#98C379;--shiki-dark:#98C379;"> len</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">     |&amp; </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">host</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">    print</span><span style="color:#98C379;--shiki-dark:#98C379;"> ORS</span><span style="color:#98C379;--shiki-dark:#98C379;"> doc</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">                    |&amp; </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">host</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    close(host</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">function</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Setup</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    tmp</span><span style="color:#98C379;--shiki-dark:#98C379;"> =</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;&lt;html&gt;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    &lt;head&gt;&lt;title&gt;Simple gawk server&lt;/title&gt;&lt;/head&gt;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    &lt;body&gt;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    &lt;p&gt;&lt;a href=&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> url</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;/xterm&gt;xterm&lt;/a&gt;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    &lt;p&gt;&lt;a href=&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> url</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;/xcalc&gt;xcalc&lt;/a&gt;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    &lt;p&gt;&lt;a href=&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> url</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;/xload&gt;xload&lt;/a&gt;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    &lt;p&gt;&lt;a href=&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> url</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;/exit&gt;terminate script&lt;/a&gt;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    &lt;/body&gt;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    &lt;/html&gt;&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    return</span><span style="color:#98C379;--shiki-dark:#98C379;"> tmp</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">function</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> Bye</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    tmp</span><span style="color:#98C379;--shiki-dark:#98C379;"> =</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;&lt;html&gt;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    &lt;head&gt;&lt;title&gt;Simple gawk server&lt;/title&gt;&lt;/head&gt;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    &lt;body&gt;&lt;p&gt;Script Terminated...&lt;/body&gt;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">\\</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    &lt;/html&gt;&quot;</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    return</span><span style="color:#98C379;--shiki-dark:#98C379;"> tmp</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">function</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> RunApp</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">app</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">app</span><span style="color:#98C379;--shiki-dark:#98C379;"> ==</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;xterm&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)  {</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">system(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;xterm&amp;&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">); </span><span style="color:#C678DD;--shiki-dark:#C678DD;">return</span><span style="color:#98C379;--shiki-dark:#98C379;">}</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">app</span><span style="color:#98C379;--shiki-dark:#98C379;"> ==</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;xcalc&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) {</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">system(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;xcalc&amp;&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">); </span><span style="color:#C678DD;--shiki-dark:#C678DD;">return</span><span style="color:#98C379;--shiki-dark:#98C379;">}</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">app</span><span style="color:#98C379;--shiki-dark:#98C379;"> ==</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;xload&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> ) {</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">system(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;xload&amp;&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">); </span><span style="color:#C678DD;--shiki-dark:#C678DD;">return</span><span style="color:#98C379;--shiki-dark:#98C379;">}</span></span>
<span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">    if</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">app</span><span style="color:#98C379;--shiki-dark:#98C379;"> ==</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;exit&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)   {</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">x</span><span style="color:#98C379;--shiki-dark:#98C379;"> =</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#98C379;--shiki-dark:#98C379;">}</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="经验" tabindex="-1"><a class="header-anchor" href="#经验"><span>经验</span></a></h2><p>1.服务上线,在启动注册流量时大量报错, 下游服务摘除,重启后, 上游还用原有的链接去链接, 导致请求失败.</p><p>2.systemd守护的进程,在tmp下找不到对应文件, 配置安全tmp项PrivateTmp改为false PrivateTmp=false</p><p>3.统一服务内部调用关系,一个服务对应一个域名</p><p>4.统一服务服务返回的状态码,报警只需要针对5xx就可以发现问题.</p><p>5.在服务雪崩后,恢复服务,用户可能有大量重试,所以放流量也要小比例放流量,逐步恢复</p><h2 id="原文" tabindex="-1"><a class="header-anchor" href="#原文"><span>原文</span></a></h2><p><a href="https://github.com/liquanzhou/ops_doc" target="_blank" rel="noopener noreferrer">https://github.com/liquanzhou/ops_doc</a></p>`,224);function k(c,d){return p(),i("div",null,[o,n("more"),t])}const y=a(r,[["render",k],["__file","shell.html.vue"]]),F=JSON.parse(`{"path":"/guide/shell.html","title":"Shell","lang":"zh-CN","frontmatter":{"article":false,"title":"Shell","order":11,"category":["linux"],"tag":["shell"],"description":"🔔 个人在线查询使用，原文地址 文件 基础命令 sort排序 find查找 vim编辑 归档压缩 文件ACL控制 git操作 rm删除文件恢复 软件 rpm yum 编译 系统 基础命令 开机启动脚本顺序 进程管理 常用 top ps 列出占用sawp的进程 系统信号 系统性能状态 日志管理 selinux 系统信息 硬件信息 limits.conf...","head":[["meta",{"property":"og:url","content":"https://docs.lizili.online/guide/shell.html"}],["meta",{"property":"og:site_name","content":"lzz's Blog"}],["meta",{"property":"og:title","content":"Shell"}],["meta",{"property":"og:description","content":"🔔 个人在线查询使用，原文地址 文件 基础命令 sort排序 find查找 vim编辑 归档压缩 文件ACL控制 git操作 rm删除文件恢复 软件 rpm yum 编译 系统 基础命令 开机启动脚本顺序 进程管理 常用 top ps 列出占用sawp的进程 系统信号 系统性能状态 日志管理 selinux 系统信息 硬件信息 limits.conf..."}],["meta",{"property":"og:type","content":"website"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-07-24T02:04:28.000Z"}],["meta",{"property":"article:author","content":"z"}],["meta",{"property":"article:tag","content":"shell"}],["meta",{"property":"article:modified_time","content":"2023-07-24T02:04:28.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"WebPage\\",\\"name\\":\\"Shell\\",\\"description\\":\\"🔔 个人在线查询使用，原文地址 文件 基础命令 sort排序 find查找 vim编辑 归档压缩 文件ACL控制 git操作 rm删除文件恢复 软件 rpm yum 编译 系统 基础命令 开机启动脚本顺序 进程管理 常用 top ps 列出占用sawp的进程 系统信号 系统性能状态 日志管理 selinux 系统信息 硬件信息 limits.conf...\\"}"]]},"headers":[{"level":2,"title":"文件","slug":"文件","link":"#文件","children":[{"level":3,"title":"基础命令","slug":"基础命令","link":"#基础命令","children":[]},{"level":3,"title":"sort排序","slug":"sort排序","link":"#sort排序","children":[]},{"level":3,"title":"find查找","slug":"find查找","link":"#find查找","children":[]},{"level":3,"title":"vim编辑","slug":"vim编辑","link":"#vim编辑","children":[]},{"level":3,"title":"归档压缩","slug":"归档压缩","link":"#归档压缩","children":[]},{"level":3,"title":"文件ACL控制","slug":"文件acl控制","link":"#文件acl控制","children":[]},{"level":3,"title":"git操作","slug":"git操作","link":"#git操作","children":[]},{"level":3,"title":"rm删除文件恢复","slug":"rm删除文件恢复","link":"#rm删除文件恢复","children":[]}]},{"level":2,"title":"软件","slug":"软件","link":"#软件","children":[{"level":3,"title":"rpm","slug":"rpm","link":"#rpm","children":[]},{"level":3,"title":"yum","slug":"yum","link":"#yum","children":[]},{"level":3,"title":"编译","slug":"编译","link":"#编译","children":[]}]},{"level":2,"title":"系统","slug":"系统","link":"#系统","children":[{"level":3,"title":"基础命令","slug":"基础命令-1","link":"#基础命令-1","children":[]},{"level":3,"title":"开机启动脚本顺序","slug":"开机启动脚本顺序","link":"#开机启动脚本顺序","children":[]},{"level":3,"title":"进程管理","slug":"进程管理","link":"#进程管理","children":[]},{"level":3,"title":"日志管理","slug":"日志管理","link":"#日志管理","children":[]},{"level":3,"title":"selinux","slug":"selinux","link":"#selinux","children":[]},{"level":3,"title":"系统信息","slug":"系统信息","link":"#系统信息","children":[]},{"level":3,"title":"硬件信息","slug":"硬件信息","link":"#硬件信息","children":[]},{"level":3,"title":"limits.conf","slug":"limits-conf","link":"#limits-conf","children":[]},{"level":3,"title":"libc.so故障修复","slug":"libc-so故障修复","link":"#libc-so故障修复","children":[]},{"level":3,"title":"sudo","slug":"sudo","link":"#sudo","children":[]},{"level":3,"title":"iptables","slug":"iptables","link":"#iptables","children":[]}]},{"level":2,"title":"网络","slug":"网络","link":"#网络","children":[{"level":3,"title":"常用","slug":"常用-1","link":"#常用-1","children":[]},{"level":3,"title":"网卡流量查看","slug":"网卡流量查看","link":"#网卡流量查看","children":[]},{"level":3,"title":"ss","slug":"ss","link":"#ss","children":[]},{"level":3,"title":"ssh","slug":"ssh","link":"#ssh","children":[]},{"level":3,"title":"路由","slug":"路由","link":"#路由","children":[]}]},{"level":2,"title":"磁盘","slug":"磁盘","link":"#磁盘","children":[{"level":3,"title":"常用","slug":"常用-2","link":"#常用-2","children":[]},{"level":3,"title":"IO系能","slug":"io系能","link":"#io系能","children":[]},{"level":3,"title":"iotop","slug":"iotop","link":"#iotop","children":[]},{"level":3,"title":"新硬盘挂载","slug":"新硬盘挂载","link":"#新硬盘挂载","children":[]},{"level":3,"title":"2T和16T分区","slug":"_2t和16t分区","link":"#_2t和16t分区","children":[]},{"level":3,"title":"raid原理","slug":"raid原理","link":"#raid原理","children":[]}]},{"level":2,"title":"用户","slug":"用户","link":"#用户","children":[{"level":3,"title":"恢复密码","slug":"恢复密码","link":"#恢复密码","children":[]},{"level":3,"title":"特殊权限","slug":"特殊权限","link":"#特殊权限","children":[]}]},{"level":2,"title":"脚本","slug":"脚本","link":"#脚本","children":[{"level":3,"title":"正则表达式","slug":"正则表达式","link":"#正则表达式","children":[]},{"level":3,"title":"流程结构","slug":"流程结构","link":"#流程结构","children":[]},{"level":3,"title":"变量","slug":"变量","link":"#变量","children":[]},{"level":3,"title":"test判断","slug":"test判断","link":"#test判断","children":[]},{"level":3,"title":"重定向","slug":"重定向","link":"#重定向","children":[]},{"level":3,"title":"运算符","slug":"运算符","link":"#运算符","children":[]},{"level":3,"title":"数学运算","slug":"数学运算","link":"#数学运算","children":[]},{"level":3,"title":"grep","slug":"grep","link":"#grep","children":[]},{"level":3,"title":"tr","slug":"tr","link":"#tr","children":[]},{"level":3,"title":"seq","slug":"seq","link":"#seq","children":[]},{"level":3,"title":"trap","slug":"trap","link":"#trap","children":[]},{"level":3,"title":"awk","slug":"awk","link":"#awk","children":[]},{"level":3,"title":"sed","slug":"sed","link":"#sed","children":[]},{"level":3,"title":"xargs","slug":"xargs","link":"#xargs","children":[]},{"level":3,"title":"dialog菜单","slug":"dialog菜单","link":"#dialog菜单","children":[]},{"level":3,"title":"select菜单","slug":"select菜单","link":"#select菜单","children":[]},{"level":3,"title":"shift","slug":"shift","link":"#shift","children":[]},{"level":3,"title":"getopts","slug":"getopts","link":"#getopts","children":[]},{"level":3,"title":"tclsh","slug":"tclsh","link":"#tclsh","children":[]},{"level":3,"title":"expect交互","slug":"expect交互","link":"#expect交互","children":[]}]},{"level":2,"title":"实例","slug":"实例","link":"#实例","children":[{"level":3,"title":"从1叠加到100","slug":"从1叠加到100","link":"#从1叠加到100","children":[]},{"level":3,"title":"判断参数是否为空-空退出并打印null","slug":"判断参数是否为空-空退出并打印null","link":"#判断参数是否为空-空退出并打印null","children":[]},{"level":3,"title":"循环数组","slug":"循环数组","link":"#循环数组","children":[]},{"level":3,"title":"判断路径","slug":"判断路径","link":"#判断路径","children":[]},{"level":3,"title":"找出出现次数最多","slug":"找出出现次数最多","link":"#找出出现次数最多","children":[]},{"level":3,"title":"判断脚本参数是否正确","slug":"判断脚本参数是否正确","link":"#判断脚本参数是否正确","children":[]},{"level":3,"title":"正则匹配邮箱","slug":"正则匹配邮箱","link":"#正则匹配邮箱","children":[]},{"level":3,"title":"打印表格","slug":"打印表格","link":"#打印表格","children":[]},{"level":3,"title":"判断日期是否合法","slug":"判断日期是否合法","link":"#判断日期是否合法","children":[]},{"level":3,"title":"打印日期段所有日期","slug":"打印日期段所有日期","link":"#打印日期段所有日期","children":[]},{"level":3,"title":"数学计算的小算法","slug":"数学计算的小算法","link":"#数学计算的小算法","children":[]},{"level":3,"title":"多行合并","slug":"多行合并","link":"#多行合并","children":[]},{"level":3,"title":"横竖转换","slug":"横竖转换","link":"#横竖转换","children":[]},{"level":3,"title":"竖行转横行","slug":"竖行转横行","link":"#竖行转横行","children":[]},{"level":3,"title":"取用户的根目录","slug":"取用户的根目录","link":"#取用户的根目录","children":[]},{"level":3,"title":"远程打包","slug":"远程打包","link":"#远程打包","children":[]},{"level":3,"title":"把汉字转成encode格式","slug":"把汉字转成encode格式","link":"#把汉字转成encode格式","children":[]},{"level":3,"title":"把目录带有大写字母的文件名改为全部小写","slug":"把目录带有大写字母的文件名改为全部小写","link":"#把目录带有大写字母的文件名改为全部小写","children":[]},{"level":3,"title":"查找连续多行，在不连续的行前插入","slug":"查找连续多行-在不连续的行前插入","link":"#查找连续多行-在不连续的行前插入","children":[]},{"level":3,"title":"查询数据库其它引擎","slug":"查询数据库其它引擎","link":"#查询数据库其它引擎","children":[]},{"level":3,"title":"批量修改数据库引擎","slug":"批量修改数据库引擎","link":"#批量修改数据库引擎","children":[]},{"level":3,"title":"将shell取到的数据插入mysql数据库","slug":"将shell取到的数据插入mysql数据库","link":"#将shell取到的数据插入mysql数据库","children":[]},{"level":3,"title":"两日期间隔天数","slug":"两日期间隔天数","link":"#两日期间隔天数","children":[]},{"level":3,"title":"while执行ssh只循环一次","slug":"while执行ssh只循环一次","link":"#while执行ssh只循环一次","children":[]},{"level":3,"title":"ssh批量执行命令","slug":"ssh批量执行命令","link":"#ssh批量执行命令","children":[]},{"level":3,"title":"在同一位置打印字符","slug":"在同一位置打印字符","link":"#在同一位置打印字符","children":[]},{"level":3,"title":"多进程后台并发简易控制","slug":"多进程后台并发简易控制","link":"#多进程后台并发简易控制","children":[]}]},{"level":2,"title":"shell并发","slug":"shell并发","link":"#shell并发","children":[{"level":3,"title":"shell并发函数","slug":"shell并发函数","link":"#shell并发函数","children":[]},{"level":3,"title":"函数","slug":"函数","link":"#函数","children":[]},{"level":3,"title":"检测软件包是否存在","slug":"检测软件包是否存在","link":"#检测软件包是否存在","children":[]},{"level":3,"title":"游戏维护菜单-修改配置文件","slug":"游戏维护菜单-修改配置文件","link":"#游戏维护菜单-修改配置文件","children":[]},{"level":3,"title":"keepalive剔除后端服务","slug":"keepalive剔除后端服务","link":"#keepalive剔除后端服务","children":[]},{"level":3,"title":"抓取系统中负载最高的进程","slug":"抓取系统中负载最高的进程","link":"#抓取系统中负载最高的进程","children":[]},{"level":3,"title":"申诉中国反垃圾邮件联盟黑名单","slug":"申诉中国反垃圾邮件联盟黑名单","link":"#申诉中国反垃圾邮件联盟黑名单","children":[]},{"level":3,"title":"Web Server in Awk","slug":"web-server-in-awk","link":"#web-server-in-awk","children":[]}]},{"level":2,"title":"经验","slug":"经验","link":"#经验","children":[]},{"level":2,"title":"原文","slug":"原文","link":"#原文","children":[]}],"git":{"createdTime":1690126442000,"updatedTime":1690164268000,"contributors":[{"name":"lizili","email":"cn.zili.lee@outlook.com","commits":2}]},"readingTime":{"minutes":93.49,"words":28047},"filePathRelative":"guide/shell.md","localizedDate":"2023年7月23日","excerpt":"<div class=\\"hint-container info\\">\\n<p class=\\"hint-container-title\\">🔔</p>\\n<p>个人在线查询使用，<a href=\\"https://github.com/liquanzhou/ops_doc\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">原文地址</a></p>\\n</div>\\n<!--more-->\\n<h1></h1>\\n<h2>文件</h2>\\n<h3>基础命令</h3>\\n<div class=\\"language-shell line-numbers-mode\\" data-ext=\\"shell\\" data-title=\\"shell\\"><pre class=\\"shiki shiki-themes one-dark-pro one-dark-pro vp-code\\" style=\\"background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf\\" tabindex=\\"0\\"><code><span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    ls</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -rtl</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                 # 按时间倒叙列出所有目录和文件 ll -rt</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    touch</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> file</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">              # 创建空白文件</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    rm</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -rf</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> 目录名</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">            # 不提示删除非空目录(-r:递归删除 -f强制)</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    dos2unix</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                # windows文本转linux文本</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    unix2dos</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                # linux文本转windows文本</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    enca</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> filename</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">           # 查看编码  安装 yum install -y enca</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    md5sum</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                  # 查看md5值</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    ln</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> 源文件</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> 目标文件</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">         # 硬链接</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    ln</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -s</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> 源文件</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> 目标文件</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">      # 符号连接</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    readlink</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -f</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> /data</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">       # 查看连接真实目录</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    cat</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> file</span><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\"> | </span><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">nl</span><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\"> |</span><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">less</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">     # 查看上下翻页且显示行号  q退出</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    head</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                    # 查看文件开头内容</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    head</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -c</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> 10m</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">             # 截取文件中10M内容</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    split</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -C</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> 10M</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">            # 将文件切割大小为10M -C按行</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    tail</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -f</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> file</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">            # 查看结尾 监视日志文件</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    tail</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -F</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> file</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">            # 监视日志并重试, 针对文件被mv的情况可以持续读取</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    file</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                    # 检查文件类型</span></span>\\n<span class=\\"line\\"><span style=\\"color:#56B6C2;--shiki-dark:#56B6C2\\">    umask</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                   # 更改默认权限</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    uniq</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                    # 删除重复的行</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    uniq</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -c</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                 # 重复的行出现次数</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    uniq</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -u</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                 # 只显示不重复行</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    paste</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> a</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> b</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">               # 将两个文件合并用tab键分隔开</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    paste</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -d</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\">'+'</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> a</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> b</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">         # 将两个文件合并指定'+'符号隔开</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    paste</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -s</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> a</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">              # 将多行数据合并到一行用tab键隔开</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    chattr</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> +i</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> /etc/passwd</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">   # 不得任意改变文件或目录 -i去掉锁 -R递归</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    more</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                    # 向下分面器</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    locate</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> 字符串</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">            # 搜索</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    wc</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -l</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> file</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">              # 查看行数</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    cp</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> filename{,.bak}</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">      # 快速备份一个文件</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    \\\\cp</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> a</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> b</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                 # 拷贝不提示 既不使用别名 cp -i</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    rev</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                     # 将行中的字符逆序排列</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    comm</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -12</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> 2</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> 3</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">            # 行和行比较匹配</span></span>\\n<span class=\\"line\\"><span style=\\"color:#56B6C2;--shiki-dark:#56B6C2\\">    echo</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> \\"10.45aa\\"</span><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\"> |</span><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">cksum</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                   # 字符串转数字编码，可做校验，也可用于文件校验</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    iconv</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -f</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> gbk</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -t</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> utf8</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> 原.txt</span><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\"> &gt; </span><span style=\\"color:#98C379;--shiki-dark:#98C379\\">新.txt</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">     # 转换编码</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    xxd</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> /boot/grub/stage1</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                   # 16进制查看</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    hexdump</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -C</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> /boot/grub/stage1</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">            # 16进制查看</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    rename</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> 原模式</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> 目标模式</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> 文件</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                 # 重命名 可正则</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    watch</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -d</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -n</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> 1</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> 'df; ls -FlAt /path'</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">      # 实时某个目录下查看最新改动过的文件</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    cp</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -v</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\">  /dev/dvd</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\">  /rhel4.6.iso9660</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">       # 制作镜像</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    diff</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> suzu.c</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> suzu2.c</span><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\">  &gt; </span><span style=\\"color:#98C379;--shiki-dark:#98C379\\">sz.patch</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">         # 制作补丁</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">    patch</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> suzu.c</span><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\"> &lt; </span><span style=\\"color:#98C379;--shiki-dark:#98C379\\">sz.patch</span><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                 # 安装补丁</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}`);export{y as comp,F as data};

import{_ as s,c as a,o as n,f as i}from"./app-BfCDUtKQ.js";const l="/assets/2024-05-13-20-30-58-BGD1fPWQ.png",e="/assets/2024-05-14-18-45-27-DjeRv0ga.png",p="/assets/2024-05-14-20-17-05-BgoOCKCE.png",r={},o=i(`<h1 id="" tabindex="-1"><a class="header-anchor" href="#"><span></span></a></h1><h2 id="常用类型和操作" tabindex="-1"><a class="header-anchor" href="#常用类型和操作"><span>常用类型和操作</span></a></h2><h3 id="认证登录" tabindex="-1"><a class="header-anchor" href="#认证登录"><span>认证登录</span></a></h3><p>客户端工具redis-di登录</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis-cli</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -h</span><span style="color:#98C379;--shiki-dark:#98C379;"> redisd</span><span style="color:#98C379;--shiki-dark:#98C379;"> ip</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -h</span><span style="color:#98C379;--shiki-dark:#98C379;"> xxx</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#98C379;--shiki-dark:#98C379;"> xxx</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># redis的认证</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;auth password</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span></span></code></pre></div><h3 id="数据类型" tabindex="-1"><a class="header-anchor" href="#数据类型"><span>数据类型</span></a></h3><p>常见的有字符串、列表、集合、等</p><h4 id="字符串" tabindex="-1"><a class="header-anchor" href="#字符串"><span>字符串</span></a></h4><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">›set</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#98C379;--shiki-dark:#98C379;"> aaa</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">›keys</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> *</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;get name</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;set name bbb</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; del name</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#增加key并赋值 #混示所有的key #获取key的佶 ＃重新绘key赋佶 #别除key</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">命令不区分大小写：</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#98C379;--shiki-dark:#98C379;">GET</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">key区分大小写：</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span><span style="color:#98C379;--shiki-dark:#98C379;">get</span><span style="color:#98C379;--shiki-dark:#98C379;"> Name</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="列表" tabindex="-1"><a class="header-anchor" href="#列表"><span>列表</span></a></h4><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">rpush</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#98C379;--shiki-dark:#98C379;"> aaa</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # rpush 依次在右边添加，lpush反之</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">rpush</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#98C379;--shiki-dark:#98C379;"> bbb</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">rpush</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#98C379;--shiki-dark:#98C379;"> vvv</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">3</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">rpush</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#98C379;--shiki-dark:#98C379;"> ccc</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">4</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">get</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">error</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">WRONGTYPE</span><span style="color:#98C379;--shiki-dark:#98C379;"> Operation</span><span style="color:#98C379;--shiki-dark:#98C379;"> against</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#98C379;--shiki-dark:#98C379;"> key</span><span style="color:#98C379;--shiki-dark:#98C379;"> holding</span><span style="color:#98C379;--shiki-dark:#98C379;"> the</span><span style="color:#98C379;--shiki-dark:#98C379;"> wrong</span><span style="color:#98C379;--shiki-dark:#98C379;"> kind</span><span style="color:#98C379;--shiki-dark:#98C379;"> of</span><span style="color:#98C379;--shiki-dark:#98C379;"> value</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">scan</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;0&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) 1) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;name&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">llen</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">4</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">lrange</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 4</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 列表需要使用lrange查看</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;aaa&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;bbb&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;vvv&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;ccc&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 删除第三个值</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">lrem</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#98C379;--shiki-dark:#98C379;"> vvv</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">lrange</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 4</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;aaa&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;bbb&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;ccc&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 弹出</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">lpop</span><span style="color:#98C379;--shiki-dark:#98C379;"> 左弹出</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">rpop</span><span style="color:#98C379;--shiki-dark:#98C379;"> 右弹出</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="集合" tabindex="-1"><a class="header-anchor" href="#集合"><span>集合</span></a></h4><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">sadd</span><span style="color:#98C379;--shiki-dark:#98C379;"> set</span><span style="color:#98C379;--shiki-dark:#98C379;"> s1</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">SMEMBERS</span><span style="color:#98C379;--shiki-dark:#98C379;"> set</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 列出集合的元素</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;s1&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">sadd</span><span style="color:#98C379;--shiki-dark:#98C379;"> set</span><span style="color:#98C379;--shiki-dark:#98C379;"> s2</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">SMEMBERS</span><span style="color:#98C379;--shiki-dark:#98C379;"> set</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;s1&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;s2&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">srem</span><span style="color:#98C379;--shiki-dark:#98C379;"> set</span><span style="color:#98C379;--shiki-dark:#98C379;"> s1</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 删除</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">SMEMBERS</span><span style="color:#98C379;--shiki-dark:#98C379;"> set</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;s2&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">spop</span><span style="color:#98C379;--shiki-dark:#98C379;"> 随机删除1个</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="hash哈希" tabindex="-1"><a class="header-anchor" href="#hash哈希"><span>hash哈希</span></a></h4><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">hset</span><span style="color:#98C379;--shiki-dark:#98C379;"> hash</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#98C379;--shiki-dark:#98C379;"> zhangsan</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">hset</span><span style="color:#98C379;--shiki-dark:#98C379;"> hash</span><span style="color:#98C379;--shiki-dark:#98C379;"> age</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 18</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">hgetall</span><span style="color:#98C379;--shiki-dark:#98C379;"> hash</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 获取全部值</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;name&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;zhangsan&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;age&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;18&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">hget</span><span style="color:#98C379;--shiki-dark:#98C379;"> hash</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 获取单个值</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;zhangsan&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 删除</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">hdel</span><span style="color:#98C379;--shiki-dark:#98C379;"> hash</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">hgetall</span><span style="color:#98C379;--shiki-dark:#98C379;"> hash</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;age&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;18&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">del</span><span style="color:#98C379;--shiki-dark:#98C379;"> hash</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">hgetall</span><span style="color:#98C379;--shiki-dark:#98C379;"> hash</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">empty</span><span style="color:#98C379;--shiki-dark:#98C379;"> array</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="发布和订阅" tabindex="-1"><a class="header-anchor" href="#发布和订阅"><span>发布和订阅</span></a></h4><figure><img src="`+l+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="切库-运维命令" tabindex="-1"><a class="header-anchor" href="#切库-运维命令"><span>切库&amp;运维命令</span></a></h2><p>redis 有 0~15 共16个数据库，默认登录的为 0，不同的数据库，数据相互之前是独立的</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">select</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379[1]</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">select</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 16</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">error</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ERR</span><span style="color:#98C379;--shiki-dark:#98C379;"> DB</span><span style="color:#98C379;--shiki-dark:#98C379;"> index</span><span style="color:#98C379;--shiki-dark:#98C379;"> is</span><span style="color:#98C379;--shiki-dark:#98C379;"> out</span><span style="color:#98C379;--shiki-dark:#98C379;"> of</span><span style="color:#98C379;--shiki-dark:#98C379;"> range</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379[1]</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">select</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre></div><h3 id="运维命令" tabindex="-1"><a class="header-anchor" href="#运维命令"><span>运维命令</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; RANDOMKEY </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#随机获取一个key</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; KEYS * </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#查看所有key，注意阻寨，如果key量特别大时候，容易卡死阻塞，上千万上百万时候容易阻塞 #建议使用，每次获取11个key，可以循环获取，直到获取所有key</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; SCAN O </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#从编号0开始，中间会有一个编号提示（类似索引编号），按编号提示依次循环获取，直到编号为0即表示获取完所有的key</span></span></code></pre></div><p>查看当前状态</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; root@c93f2576f844:/data# redis-cli -a 123456 --stat</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Warning:</span><span style="color:#98C379;--shiki-dark:#98C379;"> Using</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#98C379;--shiki-dark:#98C379;"> with</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;-a&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> or</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;-u&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> option</span><span style="color:#98C379;--shiki-dark:#98C379;"> on</span><span style="color:#98C379;--shiki-dark:#98C379;"> the</span><span style="color:#98C379;--shiki-dark:#98C379;"> command</span><span style="color:#98C379;--shiki-dark:#98C379;"> line</span><span style="color:#98C379;--shiki-dark:#98C379;"> interface</span><span style="color:#98C379;--shiki-dark:#98C379;"> may</span><span style="color:#98C379;--shiki-dark:#98C379;"> not</span><span style="color:#98C379;--shiki-dark:#98C379;"> be</span><span style="color:#98C379;--shiki-dark:#98C379;"> safe.</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-------</span><span style="color:#98C379;--shiki-dark:#98C379;"> data</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> ------</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> ---------------------</span><span style="color:#98C379;--shiki-dark:#98C379;"> load</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --------------------</span><span style="color:#98C379;--shiki-dark:#98C379;"> -</span><span style="color:#98C379;--shiki-dark:#98C379;"> child</span><span style="color:#98C379;--shiki-dark:#98C379;"> -</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">keys</span><span style="color:#98C379;--shiki-dark:#98C379;">       mem</span><span style="color:#98C379;--shiki-dark:#98C379;">      clients</span><span style="color:#98C379;--shiki-dark:#98C379;"> blocked</span><span style="color:#98C379;--shiki-dark:#98C379;"> requests</span><span style="color:#98C379;--shiki-dark:#98C379;">            connections</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">0</span><span style="color:#98C379;--shiki-dark:#98C379;">          907.06K</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  2</span><span style="color:#D19A66;--shiki-dark:#D19A66;">       0</span><span style="color:#D19A66;--shiki-dark:#D19A66;">       139</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (+0)            18</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">0</span><span style="color:#98C379;--shiki-dark:#98C379;">          907.06K</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  2</span><span style="color:#D19A66;--shiki-dark:#D19A66;">       0</span><span style="color:#D19A66;--shiki-dark:#D19A66;">       140</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (+1)            18</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">0</span><span style="color:#98C379;--shiki-dark:#98C379;">          907.06K</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  2</span><span style="color:#D19A66;--shiki-dark:#D19A66;">       0</span><span style="color:#D19A66;--shiki-dark:#D19A66;">       141</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (+1)            18</span></span></code></pre></div><p>DB操作监控</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">root@c93f2576f844:/data#</span><span style="color:#98C379;--shiki-dark:#98C379;"> redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> 123qweASD</span><span style="color:#98C379;--shiki-dark:#98C379;"> monitor</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Warning:</span><span style="color:#98C379;--shiki-dark:#98C379;"> Using</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#98C379;--shiki-dark:#98C379;"> with</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;-a&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> or</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;-u&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> option</span><span style="color:#98C379;--shiki-dark:#98C379;"> on</span><span style="color:#98C379;--shiki-dark:#98C379;"> the</span><span style="color:#98C379;--shiki-dark:#98C379;"> command</span><span style="color:#98C379;--shiki-dark:#98C379;"> line</span><span style="color:#98C379;--shiki-dark:#98C379;"> interface</span><span style="color:#98C379;--shiki-dark:#98C379;"> may</span><span style="color:#98C379;--shiki-dark:#98C379;"> not</span><span style="color:#98C379;--shiki-dark:#98C379;"> be</span><span style="color:#98C379;--shiki-dark:#98C379;"> safe.</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1715600382.635851</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [0 </span><span style="color:#98C379;--shiki-dark:#98C379;">127.0.0.1:55854]</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;auth&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;(redacted)&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1715600402.673287</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [0 </span><span style="color:#98C379;--shiki-dark:#98C379;">127.0.0.1:55854]</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;set&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;monitor&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;test&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1715600419.683035</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [0 </span><span style="color:#98C379;--shiki-dark:#98C379;">127.0.0.1:55854]</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;del&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;monitor&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1715600424.181185</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [0 </span><span style="color:#98C379;--shiki-dark:#98C379;">127.0.0.1:55854]</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;scan&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;0&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1715600426.952836</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [0 </span><span style="color:#98C379;--shiki-dark:#98C379;">127.0.0.1:55854]</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;get&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;1&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1715600430.453308</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [0 </span><span style="color:#98C379;--shiki-dark:#98C379;">127.0.0.1:55854]</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;get&quot;</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;name&quot;</span></span></code></pre></div><p>redis info查询</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">root@c93f2576f844:/data#</span><span style="color:#98C379;--shiki-dark:#98C379;"> redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 123456</span><span style="color:#98C379;--shiki-dark:#98C379;"> info</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 查看所有</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Warning:</span><span style="color:#98C379;--shiki-dark:#98C379;"> Using</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#98C379;--shiki-dark:#98C379;"> with</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;-a&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> or</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;-u&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> option</span><span style="color:#98C379;--shiki-dark:#98C379;"> on</span><span style="color:#98C379;--shiki-dark:#98C379;"> the</span><span style="color:#98C379;--shiki-dark:#98C379;"> command</span><span style="color:#98C379;--shiki-dark:#98C379;"> line</span><span style="color:#98C379;--shiki-dark:#98C379;"> interface</span><span style="color:#98C379;--shiki-dark:#98C379;"> may</span><span style="color:#98C379;--shiki-dark:#98C379;"> not</span><span style="color:#98C379;--shiki-dark:#98C379;"> be</span><span style="color:#98C379;--shiki-dark:#98C379;"> safe.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Server</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis_version:6.2.6</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis_git_sha1:00000000</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis_git_dirty:0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">root@c93f2576f844:/data#</span><span style="color:#98C379;--shiki-dark:#98C379;"> redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 123456</span><span style="color:#98C379;--shiki-dark:#98C379;"> info</span><span style="color:#98C379;--shiki-dark:#98C379;"> cpu</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 查看某一个</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Warning:</span><span style="color:#98C379;--shiki-dark:#98C379;"> Using</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#98C379;--shiki-dark:#98C379;"> with</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;-a&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> or</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;-u&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> option</span><span style="color:#98C379;--shiki-dark:#98C379;"> on</span><span style="color:#98C379;--shiki-dark:#98C379;"> the</span><span style="color:#98C379;--shiki-dark:#98C379;"> command</span><span style="color:#98C379;--shiki-dark:#98C379;"> line</span><span style="color:#98C379;--shiki-dark:#98C379;"> interface</span><span style="color:#98C379;--shiki-dark:#98C379;"> may</span><span style="color:#98C379;--shiki-dark:#98C379;"> not</span><span style="color:#98C379;--shiki-dark:#98C379;"> be</span><span style="color:#98C379;--shiki-dark:#98C379;"> safe.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># CPU</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">used_cpu_sys:14.208219</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">used_cpu_user:12.923262</span></span></code></pre></div><h2 id="配置动态更新" tabindex="-1"><a class="header-anchor" href="#配置动态更新"><span>配置动态更新</span></a></h2><p>无需重启，修改配置并生效</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">config</span><span style="color:#98C379;--shiki-dark:#98C379;"> get</span><span style="color:#98C379;--shiki-dark:#98C379;"> requirepass</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;requirepass&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;123xxxxxx&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">config</span><span style="color:#98C379;--shiki-dark:#98C379;"> set</span><span style="color:#98C379;--shiki-dark:#98C379;"> requirepass</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 123456</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">config</span><span style="color:#98C379;--shiki-dark:#98C379;"> rewrite</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 写入配置文件 避免服务重启，配置丢失</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">error</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">ERR</span><span style="color:#98C379;--shiki-dark:#98C379;"> Rewriting</span><span style="color:#98C379;--shiki-dark:#98C379;"> config</span><span style="color:#98C379;--shiki-dark:#98C379;"> file:</span><span style="color:#98C379;--shiki-dark:#98C379;"> Permission</span><span style="color:#98C379;--shiki-dark:#98C379;"> denied</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 出现这个错误，需要对redis.conf赋权 chown USRE:USER redis.conf</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 测试一下</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">root@c93f2576f844:/data#</span><span style="color:#98C379;--shiki-dark:#98C379;"> redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> 123xxxx</span><span style="color:#98C379;--shiki-dark:#98C379;"> info</span><span style="color:#98C379;--shiki-dark:#98C379;"> cpu</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Warning:</span><span style="color:#98C379;--shiki-dark:#98C379;"> Using</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#98C379;--shiki-dark:#98C379;"> with</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;-a&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> or</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;-u&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> option</span><span style="color:#98C379;--shiki-dark:#98C379;"> on</span><span style="color:#98C379;--shiki-dark:#98C379;"> the</span><span style="color:#98C379;--shiki-dark:#98C379;"> command</span><span style="color:#98C379;--shiki-dark:#98C379;"> line</span><span style="color:#98C379;--shiki-dark:#98C379;"> interface</span><span style="color:#98C379;--shiki-dark:#98C379;"> may</span><span style="color:#98C379;--shiki-dark:#98C379;"> not</span><span style="color:#98C379;--shiki-dark:#98C379;"> be</span><span style="color:#98C379;--shiki-dark:#98C379;"> safe.</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">AUTH</span><span style="color:#98C379;--shiki-dark:#98C379;"> failed:</span><span style="color:#98C379;--shiki-dark:#98C379;"> WRONGPASS</span><span style="color:#98C379;--shiki-dark:#98C379;"> invalid</span><span style="color:#98C379;--shiki-dark:#98C379;"> username-password</span><span style="color:#98C379;--shiki-dark:#98C379;"> pair</span><span style="color:#98C379;--shiki-dark:#98C379;"> or</span><span style="color:#98C379;--shiki-dark:#98C379;"> user</span><span style="color:#98C379;--shiki-dark:#98C379;"> is</span><span style="color:#98C379;--shiki-dark:#98C379;"> disabled.</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">root@c93f2576f844:/data#</span><span style="color:#98C379;--shiki-dark:#98C379;"> redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 123456</span><span style="color:#98C379;--shiki-dark:#98C379;"> info</span><span style="color:#98C379;--shiki-dark:#98C379;"> cpu</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Warning:</span><span style="color:#98C379;--shiki-dark:#98C379;"> Using</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#98C379;--shiki-dark:#98C379;"> with</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;-a&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> or</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;-u&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> option</span><span style="color:#98C379;--shiki-dark:#98C379;"> on</span><span style="color:#98C379;--shiki-dark:#98C379;"> the</span><span style="color:#98C379;--shiki-dark:#98C379;"> command</span><span style="color:#98C379;--shiki-dark:#98C379;"> line</span><span style="color:#98C379;--shiki-dark:#98C379;"> interface</span><span style="color:#98C379;--shiki-dark:#98C379;"> may</span><span style="color:#98C379;--shiki-dark:#98C379;"> not</span><span style="color:#98C379;--shiki-dark:#98C379;"> be</span><span style="color:#98C379;--shiki-dark:#98C379;"> safe.</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># CPU</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">used_cpu_sys:7.469806</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">used_cpu_user:6.857815</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">used_cpu_sys_children:0.012113</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">used_cpu_user_children:0.002291</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">used_cpu_sys_main_thread:7.467573</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">used_cpu_user_main_thread:6.857429</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">root@c93f2576f844:/data#</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">注意</p><p>所有配置操作结束，记得<code>config rewrite</code></p></div><h2 id="多用户管理" tabindex="-1"><a class="header-anchor" href="#多用户管理"><span>多用户管理</span></a></h2><p>redis6 默认已有用户名，默认为default（超级用户）</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">acl</span><span style="color:#98C379;--shiki-dark:#98C379;"> list</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 列出所有用户</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;user default on #8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92 ~* &amp;* +@all&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">acl</span><span style="color:#98C379;--shiki-dark:#98C379;"> getuser</span><span style="color:#98C379;--shiki-dark:#98C379;"> default</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 查看某个用户</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;flags&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) 1) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;on&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;allkeys&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;allchannels&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;allcommands&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;passwords&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) 1) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;commands&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;+@all&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;keys&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 8</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) 1) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;*&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 9</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;channels&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) 1) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;*&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>权限查看</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">acl</span><span style="color:#98C379;--shiki-dark:#98C379;"> cat</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 查看 权限列表</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;keyspace&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;read&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;write&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;set&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;sortedset&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;list&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;hash&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 8</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;string&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 9</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;bitmap&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;hyperloglog&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">11</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;geo&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">12</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;stream&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">13</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;pubsub&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">14</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;admin&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">15</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;fast&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">16</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;slow&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">17</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;blocking&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">18</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;dangerous&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">19</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;connection&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">20</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;transaction&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">21</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;scripting&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>创建用户</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#创建test用户，密码：testpwd 赋给get命令的权限，只对name开头的有get权限 </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;ACL SETUSER test on testpwd name* +get</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#给test用户增加read权限，设置只对name开头的key有read权限</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">›ACL</span><span style="color:#98C379;--shiki-dark:#98C379;"> SETUSER</span><span style="color:#98C379;--shiki-dark:#98C379;"> test</span><span style="color:#98C379;--shiki-dark:#98C379;"> on</span><span style="color:#98C379;--shiki-dark:#98C379;"> testpwd</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">*</span><span style="color:#98C379;--shiki-dark:#98C379;"> +</span><span style="color:#98C379;--shiki-dark:#98C379;"> @read</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> #查看test用户的相关信息</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">›ACL</span><span style="color:#98C379;--shiki-dark:#98C379;"> getuser</span><span style="color:#98C379;--shiki-dark:#98C379;"> test</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#对所有key都有get权限</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;ACL SETUSER t1 on &gt;t1pwd ~* +get</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#对所有key都有read权限</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;ACL SETUSER t1 on &gt;t1pwd ~* +@read</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;ACL Getuser t1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 删除用户</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;ACL DELUSRE t1</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>常见赋权</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建用户赋给所有权限：</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ACL SETUSER testl on &gt;testipwd ~* +@all </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#用户名：test1密码：testlpwd </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ACL GETUSER test1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 去除config命令后的所有权限</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ACL SETUSER test2 on &gt;test2pwd ~* +@all -config</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; ACL GETUSER test2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建一个用户，只给info和momitoy命令权限</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;ACL SETUSER monitor on &gt;monitorpwd ~* +info +monitor</span></span></code></pre></div><h2 id="慢日志-key有效期" tabindex="-1"><a class="header-anchor" href="#慢日志-key有效期"><span>慢日志&amp;key有效期</span></a></h2><p>系统慢常见外题：</p><ol><li>内存使用情况</li><li>CPU负载</li><li>磁盘空间</li><li>慢日志</li></ol><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">CONFIG</span><span style="color:#98C379;--shiki-dark:#98C379;"> GET</span><span style="color:#98C379;--shiki-dark:#98C379;"> slow</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">*</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;slowlog-max-len&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;128&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;slowlog-log-slower-than&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;10000&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 模拟慢日志，调整时间 slowlog-log-slower-than</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">config</span><span style="color:#98C379;--shiki-dark:#98C379;"> set</span><span style="color:#98C379;--shiki-dark:#98C379;"> slowlog-log-slower-than</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1000</span></span></code></pre></div><p>模拟大量key插入</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#C678DD;--shiki-dark:#C678DD;">for</span><span style="color:#E06C75;--shiki-dark:#E06C75;"> i</span><span style="color:#C678DD;--shiki-dark:#C678DD;"> in</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> $(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">seq</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -w</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 100000</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">);</span><span style="color:#C678DD;--shiki-dark:#C678DD;">do</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> redis-cli -a 123456 set name$(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">i</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) test$(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">i</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">); </span><span style="color:#C678DD;--shiki-dark:#C678DD;">done</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> 2&gt;/dev/null</span></span></code></pre></div><p>慢日志查询</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;SLOWLOG get  </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#默认获取最近10条</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;SLOWLOG get 5 </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#获取5条</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;SLOWLOG len   </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#慢日志量，查看慢日志的条数 </span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;SLOWLOG reset </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#清空慢日志</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#产生慢日志的命令，一般是当数据量太多时候，运行keys *命令会比较慢</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">SLOWLOG</span><span style="color:#98C379;--shiki-dark:#98C379;"> get</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) 1) (</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) 2 </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#慢日志的id，从0开始，第2个id</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">   2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) (</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) 1715676722 </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#时间戳，慢日志产生的时间点，可以通过 date -d @1668215297 获取慢日志产生的时间</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">   3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) (</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) 3143  </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#慢日志运行的时间3毫秒</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">   4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) 1) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;keys&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">      2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;*&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">   5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;127.0.0.1:55966&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">   6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="有效期" tabindex="-1"><a class="header-anchor" href="#有效期"><span>有效期</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">set</span><span style="color:#98C379;--shiki-dark:#98C379;"> exk</span><span style="color:#98C379;--shiki-dark:#98C379;"> test</span><span style="color:#98C379;--shiki-dark:#98C379;"> ex</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 10秒有效</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">get</span><span style="color:#98C379;--shiki-dark:#98C379;"> exk</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;test&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">ttl</span><span style="color:#98C379;--shiki-dark:#98C379;"> exk</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">4</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">ttl</span><span style="color:#98C379;--shiki-dark:#98C379;"> exk</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">ttl</span><span style="color:#98C379;--shiki-dark:#98C379;"> exk</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 失效</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-2</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">set</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#98C379;--shiki-dark:#98C379;"> zz</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">get</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">&quot;zz&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">ttl</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # -1 永久有效</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">-1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">EXPIRE</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 22</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 给已存在的key 设置有效时间</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">ttl</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">19</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">ttl</span><span style="color:#98C379;--shiki-dark:#98C379;"> name</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">(</span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">integer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#61AFEF;--shiki-dark:#61AFEF;">17</span><span style="color:#98C379;--shiki-dark:#98C379;">\`\`\`</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="持久化" tabindex="-1"><a class="header-anchor" href="#持久化"><span>持久化</span></a></h2><h3 id="rdb" tabindex="-1"><a class="header-anchor" href="#rdb"><span>RDB</span></a></h3><p>RDB即RedisDB的缩写，即将整个Redis内存数据持久化到一个文件。</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">save</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 阻塞保存</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">OK</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">bgsave</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 后台保存</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Background</span><span style="color:#98C379;--shiki-dark:#98C379;"> saving</span><span style="color:#98C379;--shiki-dark:#98C379;"> started</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">root@c93f2576f844:/data#</span><span style="color:#98C379;--shiki-dark:#98C379;"> ls</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 保存后，会多出个dump.rdb文件</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">access.log</span><span style="color:#98C379;--shiki-dark:#98C379;">  appendonly.aof</span><span style="color:#98C379;--shiki-dark:#98C379;">  dump.rdb</span><span style="color:#98C379;--shiki-dark:#98C379;">  s.sh</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">root@c93f2576f844:/data#</span></span></code></pre></div><p>另外一种方式就是配置文件，Redis默认开启。</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> save</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 900</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#98C379;--shiki-dark:#98C379;">  //900s有一个key被修改时保存</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> save</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 300</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10</span><span style="color:#98C379;--shiki-dark:#98C379;">  //300s内有10个key被修改时保存</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> save</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 60</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 10000</span><span style="color:#98C379;--shiki-dark:#98C379;"> //60s内有10000个key被修改时保存</span></span></code></pre></div><p>RBD的优点是，全量数据二进制文件，数据恢复快。 缺点是，可能会丢数据。</p><h3 id="aof" tabindex="-1"><a class="header-anchor" href="#aof"><span>AOF</span></a></h3><p>将redis中每一步对数据修改的操作记录（日志）append到相应的文件中</p><p>配置文件</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">appendonly</span><span style="color:#98C379;--shiki-dark:#98C379;"> yes</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># The name of the append only file (default: &quot;appendonly.aof&quot;)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">appendfilename</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;appendonly.aof&quot;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查看配置</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">CONFIG</span><span style="color:#98C379;--shiki-dark:#98C379;"> GET</span><span style="color:#98C379;--shiki-dark:#98C379;"> appen</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">*</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;appendonly&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;yes&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;appendfilename&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;appendonly.aof&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;appendfsync&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;everysec&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 可通过config set 更改配置</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>为了降低IO消耗，AOF写文件时，会先将数据写到缓冲区，然后再把缓冲区的内容 flush 到磁盘，这个过程叫做 fsync。</p><p>频率有三种：</p><blockquote><p>appendfsync always //每次写操作都flush，影响性能<br> appendfsync everysec //每秒flush<br> appendfsync no //消极等待OS刷新(一般30s),可能丢失数据</p></blockquote><h3 id="重写" tabindex="-1"><a class="header-anchor" href="#重写"><span>重写</span></a></h3><p>当AOF文件增大到一定程度，我们可以对他进行重写，重写AOF文件可以减小AOF文件的大小，数据不会减少</p><figure><img src="`+e+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">CONFIG</span><span style="color:#98C379;--shiki-dark:#98C379;"> GET</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;"> *</span><span style="color:#98C379;--shiki-dark:#98C379;">aof</span><span style="color:#E5C07B;--shiki-dark:#E5C07B;">*</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 1</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;aof-rewrite-incremental-fsync&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 2</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;yes&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 3</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;aof-load-truncated&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;yes&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 5</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;aof-use-rdb-preamble&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 6</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;no&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 7</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;aof_rewrite_cpulist&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 8</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;"> 9</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;auto-aof-rewrite-percentage&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 达到100增量的时候，触发AOF重写</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">10</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;100&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">11</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;auto-aof-rewrite-min-size&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # &gt; 64M ,触发重写</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">12</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;67108864&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">13</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">) </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;replicaof&quot;</span></span></code></pre></div><h3 id="混合模式" tabindex="-1"><a class="header-anchor" href="#混合模式"><span>混合模式</span></a></h3><p>bgrewirteof（background+rewrite+aof），可以解决，文件过大的问题，但对历史命令的合并是非常耗费性能的，尤其是数据量非的情况下。因此，4.0后，出现混合模式。即执行bgrewirteof之后，将当前数据全量以RDB的方式写入appendonly文件的前半部分，之后的命令再以 append 的方式进行追加。</p><p>配置文件</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">aof-use-rdb-preamble</span><span style="color:#98C379;--shiki-dark:#98C379;"> yes</span></span></code></pre></div><p>触发条件</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">auto-aof-rewrite-percentage</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 100</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">auto-aof-rewrite-min-size</span><span style="color:#98C379;--shiki-dark:#98C379;"> 64mb</span></span></code></pre></div><h2 id="bigkey" tabindex="-1"><a class="header-anchor" href="#bigkey"><span>bigkey</span></a></h2><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">root@2318c3d768a7:/data#</span><span style="color:#98C379;--shiki-dark:#98C379;"> redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> 123qweASD</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --bigkeys</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Warning:</span><span style="color:#98C379;--shiki-dark:#98C379;"> Using</span><span style="color:#98C379;--shiki-dark:#98C379;"> a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#98C379;--shiki-dark:#98C379;"> with</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;-a&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> or</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;-u&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> option</span><span style="color:#98C379;--shiki-dark:#98C379;"> on</span><span style="color:#98C379;--shiki-dark:#98C379;"> the</span><span style="color:#98C379;--shiki-dark:#98C379;"> command</span><span style="color:#98C379;--shiki-dark:#98C379;"> line</span><span style="color:#98C379;--shiki-dark:#98C379;"> interface</span><span style="color:#98C379;--shiki-dark:#98C379;"> may</span><span style="color:#98C379;--shiki-dark:#98C379;"> not</span><span style="color:#98C379;--shiki-dark:#98C379;"> be</span><span style="color:#98C379;--shiki-dark:#98C379;"> safe.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Scanning the entire keyspace to find biggest keys as well as</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># average sizes per key type.  You can use -i 0.1 to sleep 0.1 sec</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># per 100 SCAN commands (not usually needed).</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">[00.00%] Biggest string found so far </span><span style="color:#98C379;--shiki-dark:#98C379;">&#39;&quot;name&quot;&#39;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> with 3 bytes</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">--------</span><span style="color:#98C379;--shiki-dark:#98C379;"> summary</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -------</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Sampled</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span><span style="color:#98C379;--shiki-dark:#98C379;"> keys</span><span style="color:#98C379;--shiki-dark:#98C379;"> in</span><span style="color:#98C379;--shiki-dark:#98C379;"> the</span><span style="color:#98C379;--shiki-dark:#98C379;"> keyspace!</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Total</span><span style="color:#98C379;--shiki-dark:#98C379;"> key</span><span style="color:#98C379;--shiki-dark:#98C379;"> length</span><span style="color:#98C379;--shiki-dark:#98C379;"> in</span><span style="color:#98C379;--shiki-dark:#98C379;"> bytes</span><span style="color:#98C379;--shiki-dark:#98C379;"> is</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 4</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (avg </span><span style="color:#98C379;--shiki-dark:#98C379;">len</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 4.00</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Biggest</span><span style="color:#98C379;--shiki-dark:#98C379;"> string</span><span style="color:#98C379;--shiki-dark:#98C379;"> found</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;&quot;name&quot;&#39;</span><span style="color:#98C379;--shiki-dark:#98C379;"> has</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#98C379;--shiki-dark:#98C379;"> bytes</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">1</span><span style="color:#98C379;--shiki-dark:#98C379;"> strings</span><span style="color:#98C379;--shiki-dark:#98C379;"> with</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span><span style="color:#98C379;--shiki-dark:#98C379;"> bytes</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (100.00% </span><span style="color:#98C379;--shiki-dark:#98C379;">of</span><span style="color:#98C379;--shiki-dark:#98C379;"> keys,</span><span style="color:#98C379;--shiki-dark:#98C379;"> avg</span><span style="color:#98C379;--shiki-dark:#98C379;"> size</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3.00</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">0</span><span style="color:#98C379;--shiki-dark:#98C379;"> lists</span><span style="color:#98C379;--shiki-dark:#98C379;"> with</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#98C379;--shiki-dark:#98C379;"> items</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (00.00% </span><span style="color:#98C379;--shiki-dark:#98C379;">of</span><span style="color:#98C379;--shiki-dark:#98C379;"> keys,</span><span style="color:#98C379;--shiki-dark:#98C379;"> avg</span><span style="color:#98C379;--shiki-dark:#98C379;"> size</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0.00</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">0</span><span style="color:#98C379;--shiki-dark:#98C379;"> hashs</span><span style="color:#98C379;--shiki-dark:#98C379;"> with</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#98C379;--shiki-dark:#98C379;"> fields</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (00.00% </span><span style="color:#98C379;--shiki-dark:#98C379;">of</span><span style="color:#98C379;--shiki-dark:#98C379;"> keys,</span><span style="color:#98C379;--shiki-dark:#98C379;"> avg</span><span style="color:#98C379;--shiki-dark:#98C379;"> size</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0.00</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">0</span><span style="color:#98C379;--shiki-dark:#98C379;"> streams</span><span style="color:#98C379;--shiki-dark:#98C379;"> with</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#98C379;--shiki-dark:#98C379;"> entries</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (00.00% </span><span style="color:#98C379;--shiki-dark:#98C379;">of</span><span style="color:#98C379;--shiki-dark:#98C379;"> keys,</span><span style="color:#98C379;--shiki-dark:#98C379;"> avg</span><span style="color:#98C379;--shiki-dark:#98C379;"> size</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0.00</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">0</span><span style="color:#98C379;--shiki-dark:#98C379;"> sets</span><span style="color:#98C379;--shiki-dark:#98C379;"> with</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#98C379;--shiki-dark:#98C379;"> members</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (00.00% </span><span style="color:#98C379;--shiki-dark:#98C379;">of</span><span style="color:#98C379;--shiki-dark:#98C379;"> keys,</span><span style="color:#98C379;--shiki-dark:#98C379;"> avg</span><span style="color:#98C379;--shiki-dark:#98C379;"> size</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0.00</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">0</span><span style="color:#98C379;--shiki-dark:#98C379;"> zsets</span><span style="color:#98C379;--shiki-dark:#98C379;"> with</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0</span><span style="color:#98C379;--shiki-dark:#98C379;"> members</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> (00.00% </span><span style="color:#98C379;--shiki-dark:#98C379;">of</span><span style="color:#98C379;--shiki-dark:#98C379;"> keys,</span><span style="color:#98C379;--shiki-dark:#98C379;"> avg</span><span style="color:#98C379;--shiki-dark:#98C379;"> size</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0.00</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">root@2318c3d768a7:/data#</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="主从" tabindex="-1"><a class="header-anchor" href="#主从"><span>主从</span></a></h2><p>从redis需要增加下面这两项：</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">slave</span><span style="color:#98C379;--shiki-dark:#98C379;"> of</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 192.168.27.128</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6379</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> #指定主redis的ip和端口 </span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">masterauth</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;password&quot;</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # #指定主redis的密码</span></span></code></pre></div><p>角色查看</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">127.0.0.1:6379</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#98C379;--shiki-dark:#98C379;">info</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 通过info命令可查看出，当前的节点是什么角色等信息</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">...</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">...</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">Replication</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">role:</span><span style="color:#98C379;--shiki-dark:#98C379;"> slave</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">master_host:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 192.168.27.128</span><span style="color:#98C379;--shiki-dark:#98C379;"> master_port:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6379</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">master_link_status:up</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">master_last.</span><span style="color:#98C379;--shiki-dark:#98C379;"> _io_seconds_ago:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6</span><span style="color:#98C379;--shiki-dark:#98C379;"> master_sync_in_progress:0</span></span>
<span class="line"><span style="color:#56B6C2;--shiki-dark:#56B6C2;">...</span></span></code></pre></div><h2 id="哨兵" tabindex="-1"><a class="header-anchor" href="#哨兵"><span>哨兵</span></a></h2><p>Redis提供Sentinel工具实现主从自动切换，实现redis的高可用</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis-sentinel</span><span style="color:#98C379;--shiki-dark:#98C379;"> /etc/sentinel.conf</span></span></code></pre></div><p>主挂掉后，从库自动提升为主库，主生恢复后，自动转为从库</p><p>要求主从都需要设置<code>masterauth</code> 连接主redis的密码</p><blockquote><p>因为是高可用模式，主也有可能宕机，当它宿机后，即使再恢复后也是作为从角色，为了防止作为从角色时候， 连接主时候认证不了，需要提前加上连接主服务器的认证密码</p></blockquote><p>为了防止哨兵的单节点故障，一般哨兵也做成高可用形式，即多个哨兵同时监控redis的状态，当其中一个哨兵故障时候，其他哨兵也能继续监控。</p><p>为了方便哨兵的选举，一般哨兵也是设置成奇数个。一般3个哨兵就没问题。</p><p>注意：一般哨兵的部署尽量不要和redis部署在同一台，防止这一台机器挂了后，redis和哨兵同时挂掉，哨兵起不到哨兵的作用了。当然多台机器， 多个哨兵时候也不影响，一台哨兵挂了，还有其它哨兵。</p><h3 id="配置哨兵" tabindex="-1"><a class="header-anchor" href="#配置哨兵"><span>配置哨兵</span></a></h3><p>sentinel.conf</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">bind</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 0.0.0.0</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">daemonize</span><span style="color:#98C379;--shiki-dark:#98C379;"> yes</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">port</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 26379</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> #服务端口</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">dir</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;/tmp&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">logfile</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;sentinel.log&quot;</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sentinel</span><span style="color:#98C379;--shiki-dark:#98C379;"> monitor</span><span style="color:#98C379;--shiki-dark:#98C379;"> testmaster</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 192.168.27.128</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 6379</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # master地址，2代表至少2个哨兵认为有问题，才进行切换</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sentinel</span><span style="color:#98C379;--shiki-dark:#98C379;"> auth-pass</span><span style="color:#98C379;--shiki-dark:#98C379;"> testmaster</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sentinel</span><span style="color:#98C379;--shiki-dark:#98C379;"> down-after-milliseconds</span><span style="color:#98C379;--shiki-dark:#98C379;"> testmaster</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 5000</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 5s未响应，则认为故障</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">sentinel</span><span style="color:#98C379;--shiki-dark:#98C379;"> failover-timeout</span><span style="color:#98C379;--shiki-dark:#98C379;"> testmaster</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 20000</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 20秒内，完成切换操作。</span></span></code></pre></div><h2 id="集群" tabindex="-1"><a class="header-anchor" href="#集群"><span>集群</span></a></h2><p>分片存储，提高redis吞吐量。建议最少三主三从</p><h3 id="主节点" tabindex="-1"><a class="header-anchor" href="#主节点"><span>主节点</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --cluster</span><span style="color:#98C379;--shiki-dark:#98C379;"> create</span><span style="color:#98C379;--shiki-dark:#98C379;"> 192.168.x.x:7000</span><span style="color:#98C379;--shiki-dark:#98C379;"> 192.168.x.x:7001</span><span style="color:#98C379;--shiki-dark:#98C379;"> 192.168.x.x:7002</span></span></code></pre></div><figure><img src="`+p+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>查看集群状态</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># redis-cli -a password -p 7000 cluster info</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cluster_state:ok</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cluster_slots_assigned:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 16384</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cluster_slots_ok:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 16384</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cluster_slots_pfail:0</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cluster_slots_fail:0</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cluster</span><span style="color:#98C379;--shiki-dark:#98C379;"> _known_nodes:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cluster_size:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cluster_current</span><span style="color:#98C379;--shiki-dark:#98C379;"> _epoch:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 3</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cluster_my_epoch:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cluster_stats_messages_ping_sent:32</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cluster_stats_messages_pong_sent:34</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cluster_stats_messages_sent:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 66</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cluster_stats_messages_ping_received:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 32</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cluster_stats_messages_pong_received:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 32</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cluster_stats_messages_meet_received:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 2</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">cluster_stats_messages_received:</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 66</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">&gt; </span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># redis-cli -a password -p 7000 cluster nodes</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">查看集群节点信息</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>写入数据</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 集群操作需要加-c参数</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 7000</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> #不加-C参数，表示不是以集群方式写入，无法写入 </span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -p</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> 7000</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -c</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> #增加-C参数，表示是以集群方式写入，可以写入</span></span></code></pre></div><h3 id="从节点" tabindex="-1"><a class="header-anchor" href="#从节点"><span>从节点</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --cluster</span><span style="color:#98C379;--shiki-dark:#98C379;"> add-node</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --cluster-slave</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --cluster-master-id</span><span style="color:#98C379;--shiki-dark:#98C379;"> 7001的master-id</span><span style="color:#98C379;--shiki-dark:#98C379;"> 192.168.x.x:8002</span><span style="color:#98C379;--shiki-dark:#98C379;"> 192.168.x.x.:7001</span></span></code></pre></div><div class="hint-container warning"><p class="hint-container-title">注意</p><p>命令中后面两个ip顺序不能颠倒，分别对应的一组主从，ip顺序为：从redis的ip：从端口 主redis的ip：主端口</p></div><blockquote><p>手动将原主库提升为主库，可用命令 CLUSTER FAILOVER</p></blockquote><h3 id="节点增" tabindex="-1"><a class="header-anchor" href="#节点增"><span>节点增</span></a></h3><p>使用add-node命令新增一个主节点</p><p>新增集群主节点</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --cluster</span><span style="color:#98C379;--shiki-dark:#98C379;"> add-node</span><span style="color:#98C379;--shiki-dark:#98C379;"> 新节点IP:端口</span><span style="color:#98C379;--shiki-dark:#98C379;"> 已存在节点IP:端口（任意节点均可）</span></span></code></pre></div><p>新增集群从节点</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --cluster</span><span style="color:#98C379;--shiki-dark:#98C379;"> add-node</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --cluster-slave</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --cluster-master-id</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [MASTER </span><span style="color:#98C379;--shiki-dark:#98C379;">ID]</span><span style="color:#98C379;--shiki-dark:#98C379;"> 新节点IP:端口</span><span style="color:#98C379;--shiki-dark:#98C379;"> 主节点IP:端口</span></span></code></pre></div><p>分配 <code>slot</code> 槽。找到集群中的任意一个主节点，对其进行重新分片工作</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --cluster</span><span style="color:#98C379;--shiki-dark:#98C379;"> reshard</span><span style="color:#98C379;--shiki-dark:#98C379;"> 已存在节点IP:端口</span></span></code></pre></div><h3 id="节点减" tabindex="-1"><a class="header-anchor" href="#节点减"><span>节点减</span></a></h3><p>从库可以直接删除</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --cluster</span><span style="color:#98C379;--shiki-dark:#98C379;"> del-node</span><span style="color:#98C379;--shiki-dark:#98C379;"> 对应主库的ip:端口</span><span style="color:#98C379;--shiki-dark:#98C379;"> 从库的id</span></span></code></pre></div><p>主库的删除，需要做数据的迁移。使用槽位分配即可。</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --cluster</span><span style="color:#98C379;--shiki-dark:#98C379;"> reshard</span><span style="color:#98C379;--shiki-dark:#98C379;"> 已存在节点IP:端口</span></span></code></pre></div><p>删除master节点</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">redis-cli</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -a</span><span style="color:#98C379;--shiki-dark:#98C379;"> password</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --cluster</span><span style="color:#98C379;--shiki-dark:#98C379;"> del-node</span><span style="color:#98C379;--shiki-dark:#98C379;"> 对应主库的ip:端口</span><span style="color:#98C379;--shiki-dark:#98C379;"> 主库的id</span></span></code></pre></div>`,122),k=[o];function t(d,c){return n(),a("div",null,k)}const F=s(r,[["render",t],["__file","redis.html.vue"]]),y=JSON.parse(`{"path":"/ops/linux/redis.html","title":"Redis","lang":"zh-CN","frontmatter":{"article":true,"title":"Redis","order":99,"category":["linux"],"tag":["redis"],"index":true,"description":"常用类型和操作 认证登录 客户端工具redis-di登录 数据类型 常见的有字符串、列表、集合、等 字符串 列表 集合 hash哈希 发布和订阅 切库&运维命令 redis 有 0~15 共16个数据库，默认登录的为 0，不同的数据库，数据相互之前是独立的 运维命令 查看当前状态 DB操作监控 redis info查询 配置动态更新 无需重启，修改配置...","head":[["meta",{"property":"og:url","content":"https://docs.lizili.online/ops/linux/redis.html"}],["meta",{"property":"og:site_name","content":"lzz's Blog"}],["meta",{"property":"og:title","content":"Redis"}],["meta",{"property":"og:description","content":"常用类型和操作 认证登录 客户端工具redis-di登录 数据类型 常见的有字符串、列表、集合、等 字符串 列表 集合 hash哈希 发布和订阅 切库&运维命令 redis 有 0~15 共16个数据库，默认登录的为 0，不同的数据库，数据相互之前是独立的 运维命令 查看当前状态 DB操作监控 redis info查询 配置动态更新 无需重启，修改配置..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-05-24T12:29:50.000Z"}],["meta",{"property":"article:author","content":"z"}],["meta",{"property":"article:tag","content":"redis"}],["meta",{"property":"article:modified_time","content":"2024-05-24T12:29:50.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Redis\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-05-24T12:29:50.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"z\\",\\"url\\":\\"https://docs.lizili.online\\"}]}"]]},"headers":[{"level":2,"title":"常用类型和操作","slug":"常用类型和操作","link":"#常用类型和操作","children":[{"level":3,"title":"认证登录","slug":"认证登录","link":"#认证登录","children":[]},{"level":3,"title":"数据类型","slug":"数据类型","link":"#数据类型","children":[]}]},{"level":2,"title":"切库&运维命令","slug":"切库-运维命令","link":"#切库-运维命令","children":[{"level":3,"title":"运维命令","slug":"运维命令","link":"#运维命令","children":[]}]},{"level":2,"title":"配置动态更新","slug":"配置动态更新","link":"#配置动态更新","children":[]},{"level":2,"title":"多用户管理","slug":"多用户管理","link":"#多用户管理","children":[]},{"level":2,"title":"慢日志&key有效期","slug":"慢日志-key有效期","link":"#慢日志-key有效期","children":[{"level":3,"title":"有效期","slug":"有效期","link":"#有效期","children":[]}]},{"level":2,"title":"持久化","slug":"持久化","link":"#持久化","children":[{"level":3,"title":"RDB","slug":"rdb","link":"#rdb","children":[]},{"level":3,"title":"AOF","slug":"aof","link":"#aof","children":[]},{"level":3,"title":"重写","slug":"重写","link":"#重写","children":[]},{"level":3,"title":"混合模式","slug":"混合模式","link":"#混合模式","children":[]}]},{"level":2,"title":"bigkey","slug":"bigkey","link":"#bigkey","children":[]},{"level":2,"title":"主从","slug":"主从","link":"#主从","children":[]},{"level":2,"title":"哨兵","slug":"哨兵","link":"#哨兵","children":[{"level":3,"title":"配置哨兵","slug":"配置哨兵","link":"#配置哨兵","children":[]}]},{"level":2,"title":"集群","slug":"集群","link":"#集群","children":[{"level":3,"title":"主节点","slug":"主节点","link":"#主节点","children":[]},{"level":3,"title":"从节点","slug":"从节点","link":"#从节点","children":[]},{"level":3,"title":"节点增","slug":"节点增","link":"#节点增","children":[]},{"level":3,"title":"节点减","slug":"节点减","link":"#节点减","children":[]}]}],"git":{"createdTime":1716553790000,"updatedTime":1716553790000,"contributors":[{"name":"lizili","email":"cn.zili.lee@outlook.com","commits":1}]},"readingTime":{"minutes":11.08,"words":3324},"filePathRelative":"ops/linux/redis.md","localizedDate":"2024年5月24日","excerpt":"\\n<h2>常用类型和操作</h2>\\n<h3>认证登录</h3>\\n<p>客户端工具redis-di登录</p>\\n<div class=\\"language-shell\\" data-ext=\\"shell\\" data-title=\\"shell\\"><pre class=\\"shiki shiki-themes one-dark-pro one-dark-pro vp-code\\" style=\\"background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf\\" tabindex=\\"0\\"><code><span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">redis-cli</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">redis-cli</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -h</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> redisd</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> ip</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">redis-cli</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -h</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> xxx</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -p</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> xxx</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># redis的认证</span></span>\\n<span class=\\"line\\"><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\">&gt;auth password</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">redis-cli</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -a</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> password</span></span></code></pre>\\n</div>","autoDesc":true}`);export{F as comp,y as data};

import{_ as s,c as a,o as l,f as e}from"./app-BfCDUtKQ.js";const n="/assets/2023-07-24-11-32-20-Ckpu6f0Q.png",o="/assets/2023-07-25-10-42-55-CDjXybBf.png",i="/assets/2023-07-25-17-43-32-PrNXC_bV.png",r="/assets/2023-07-25-18-02-58-3e5fbAyR.png",t="/assets/2023-07-25-18-03-47-CEresOrH.png",p="/assets/2023-07-25-18-05-10-Aq0VqNa5.png",c={},k=e(`<h1 id="" tabindex="-1"><a class="header-anchor" href="#"><span></span></a></h1><blockquote><p>扫描 Kubernetes 集群、诊断和分类问题的工具,通过 AI 进行的问题诊断。</p></blockquote><h2 id="local-ai部署" tabindex="-1"><a class="header-anchor" href="#local-ai部署"><span>local ai部署</span></a></h2><p>如果openai可以用的话，可以不安装</p><p><a href="https://github.com/go-skynet/LocalAI#run-localai-in-kubernetes" target="_blank" rel="noopener noreferrer">官方 run-localai-in-kubernetes</a></p><h3 id="添加helm-repo" tabindex="-1"><a class="header-anchor" href="#添加helm-repo"><span>添加helm repo</span></a></h3><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">helm</span><span style="color:#98C379;--shiki-dark:#98C379;"> repo</span><span style="color:#98C379;--shiki-dark:#98C379;"> add</span><span style="color:#98C379;--shiki-dark:#98C379;"> go-skynet</span><span style="color:#98C379;--shiki-dark:#98C379;"> https://go-skynet.github.io/helm-charts/</span></span></code></pre></div><h3 id="安装local-ai" tabindex="-1"><a class="header-anchor" href="#安装local-ai"><span>安装local ai</span></a></h3><ul><li>方法1:</li></ul><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">helm</span><span style="color:#98C379;--shiki-dark:#98C379;"> repo</span><span style="color:#98C379;--shiki-dark:#98C379;"> update</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">helm</span><span style="color:#98C379;--shiki-dark:#98C379;"> install</span><span style="color:#98C379;--shiki-dark:#98C379;"> local-ai</span><span style="color:#98C379;--shiki-dark:#98C379;"> go-skynet/local-ai</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -f</span><span style="color:#98C379;--shiki-dark:#98C379;"> values.yaml</span></span></code></pre></div><figure><img src="`+n+'" alt="模型下载" tabindex="0" loading="lazy"><figcaption>模型下载</figcaption></figure><p>这个下载过程比较慢，建议使用离线的方式</p><figure><img src="'+o+'" alt="local-ai启动" tabindex="0" loading="lazy"><figcaption>local-ai启动</figcaption></figure><ul><li>方法2:</li></ul><p>由于网络问题，服务器下载模型，非常慢。所以我将模型和charts都离线了，如果镜像也慢的</p><h4 id="下载charts" tabindex="-1"><a class="header-anchor" href="#下载charts"><span>下载charts</span></a></h4><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">helm</span><span style="color:#98C379;--shiki-dark:#98C379;"> pull</span><span style="color:#98C379;--shiki-dark:#98C379;"> go-skynet/local-ai</span></span></code></pre></div><h4 id="修改value" tabindex="-1"><a class="header-anchor" href="#修改value"><span>修改value</span></a></h4><figure><img src="'+i+`" alt="更换模型下载地址" tabindex="0" loading="lazy"><figcaption>更换模型下载地址</figcaption></figure><h4 id="安装服务" tabindex="-1"><a class="header-anchor" href="#安装服务"><span>安装服务</span></a></h4><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">helm</span><span style="color:#98C379;--shiki-dark:#98C379;"> upgrade</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --install</span><span style="color:#98C379;--shiki-dark:#98C379;"> local-ai</span><span style="color:#98C379;--shiki-dark:#98C379;"> .</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -f</span><span style="color:#98C379;--shiki-dark:#98C379;"> values.yaml</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> ai</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --create-namespace</span></span></code></pre></div><h3 id="问题处理" tabindex="-1"><a class="header-anchor" href="#问题处理"><span>问题处理</span></a></h3><p><a href="https://github.com/go-skynet/LocalAI/issues/181" target="_blank" rel="noopener noreferrer">https://github.com/go-skynet/LocalAI/issues/181</a></p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">curl</span><span style="color:#98C379;--shiki-dark:#98C379;"> http://localhost:8080/models/apply</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -H</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Content-Type: application/json&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{ &quot;url&quot;: &quot;github:go-skynet/model-gallery/gpt4all-j.yaml&quot;, &quot;name&quot;: &quot;gpt4all-j&quot; }&#39;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">curl</span><span style="color:#98C379;--shiki-dark:#98C379;"> http://localhost:8080/v1/chat/completions</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -H</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;Content-Type: application/json&quot;</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -d</span><span style="color:#98C379;--shiki-dark:#98C379;"> &#39;{</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">     &quot;model&quot;: &quot;gpt4all-j&quot;,</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">     &quot;messages&quot;: [{&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;who you are&quot;}],</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">     &quot;temperature&quot;: 0.1</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">   }&#39;</span></span></code></pre></div><p>local ai 接口正常返回信息</p><figure><img src="`+r+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="安装k8sgpt" tabindex="-1"><a class="header-anchor" href="#安装k8sgpt"><span>安装k8sGPT</span></a></h2><p><a href="https://docs.k8sgpt.ai/getting-started/in-cluster-operator/" target="_blank" rel="noopener noreferrer">官方 in-cluster-operator</a></p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">helm</span><span style="color:#98C379;--shiki-dark:#98C379;"> repo</span><span style="color:#98C379;--shiki-dark:#98C379;"> add</span><span style="color:#98C379;--shiki-dark:#98C379;"> k8sgpt</span><span style="color:#98C379;--shiki-dark:#98C379;"> https://charts.k8sgpt.ai/</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">helm</span><span style="color:#98C379;--shiki-dark:#98C379;"> repo</span><span style="color:#98C379;--shiki-dark:#98C379;"> update</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">helm</span><span style="color:#98C379;--shiki-dark:#98C379;"> install</span><span style="color:#98C379;--shiki-dark:#98C379;"> release</span><span style="color:#98C379;--shiki-dark:#98C379;"> k8sgpt/k8sgpt-operator</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> k8sgpt-operator-system</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --create-namespace</span></span></code></pre></div><p>集群多了两个CRD服务</p><figure><img src="`+t+`" alt="crds" tabindex="0" loading="lazy"><figcaption>crds</figcaption></figure><h3 id="部署k8sgpt-resource" tabindex="-1"><a class="header-anchor" href="#部署k8sgpt-resource"><span>部署k8sGPT resource</span></a></h3><div class="language-yaml" data-ext="yaml" data-title="yaml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">apiVersion</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">core.k8sgpt.ai/v1alpha1</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">kind</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">K8sGPT</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">metadata</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  name</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">k8sgpt-local-ai</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  namespace</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">ai</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">spec</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  ai</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    enabled</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#D19A66;--shiki-dark:#D19A66;">true</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    model</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">ggml-gpt4all-j</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    backend</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">localai</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    baseUrl</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">http://local-ai.ai/v1</span><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # local ai 服务地址 这个就是之前安装的服务了</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  noCache</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#D19A66;--shiki-dark:#D19A66;">false</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  version</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">v0.3.8</span></span></code></pre></div><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">kubectl</span><span style="color:#98C379;--shiki-dark:#98C379;"> apply</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -f</span><span style="color:#98C379;--shiki-dark:#98C379;"> k8sGPT.yaml</span></span></code></pre></div><p>安装完后的服务POD</p><figure><img src="`+p+`" alt="所有的POD" tabindex="0" loading="lazy"><figcaption>所有的POD</figcaption></figure><h3 id="查看results" tabindex="-1"><a class="header-anchor" href="#查看results"><span>查看results</span></a></h3><p>没做故障模拟，所以这里就是空了</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">kubectl</span><span style="color:#98C379;--shiki-dark:#98C379;"> get</span><span style="color:#98C379;--shiki-dark:#98C379;"> results</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -o</span><span style="color:#98C379;--shiki-dark:#98C379;"> json</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> ai</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    &quot;apiVersion&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;v1&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    &quot;items&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;"> [],</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    &quot;kind&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;List&quot;,</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">    &quot;metadata&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> {</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">        &quot;resourceVersion&quot;</span><span style="color:#56B6C2;--shiki-dark:#56B6C2;">:</span><span style="color:#98C379;--shiki-dark:#98C379;"> &quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">}</span></span></code></pre></div>`,39),d=[k];function h(y,u){return l(),a("div",null,d)}const g=s(c,[["render",h],["__file","k8sGPT.html.vue"]]),b=JSON.parse(`{"path":"/cloud-native/kubernetes/k8sGPT.html","title":"k8sGPT","lang":"zh-CN","frontmatter":{"article":true,"title":"k8sGPT","order":11,"category":["云原生"],"tag":["GPT"],"description":"扫描 Kubernetes 集群、诊断和分类问题的工具,通过 AI 进行的问题诊断。 local ai部署 如果openai可以用的话，可以不安装 官方 run-localai-in-kubernetes 添加helm repo 安装local ai 方法1: 模型下载模型下载 这个下载过程比较慢，建议使用离线的方式 local-ai启动local-a...","head":[["meta",{"property":"og:url","content":"https://docs.lizili.online/cloud-native/kubernetes/k8sGPT.html"}],["meta",{"property":"og:site_name","content":"lzz's Blog"}],["meta",{"property":"og:title","content":"k8sGPT"}],["meta",{"property":"og:description","content":"扫描 Kubernetes 集群、诊断和分类问题的工具,通过 AI 进行的问题诊断。 local ai部署 如果openai可以用的话，可以不安装 官方 run-localai-in-kubernetes 添加helm repo 安装local ai 方法1: 模型下载模型下载 这个下载过程比较慢，建议使用离线的方式 local-ai启动local-a..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-10-07T13:03:38.000Z"}],["meta",{"property":"article:author","content":"z"}],["meta",{"property":"article:tag","content":"GPT"}],["meta",{"property":"article:modified_time","content":"2024-10-07T13:03:38.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"k8sGPT\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-10-07T13:03:38.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"z\\",\\"url\\":\\"https://docs.lizili.online\\"}]}"]]},"headers":[{"level":2,"title":"local ai部署","slug":"local-ai部署","link":"#local-ai部署","children":[{"level":3,"title":"添加helm repo","slug":"添加helm-repo","link":"#添加helm-repo","children":[]},{"level":3,"title":"安装local ai","slug":"安装local-ai","link":"#安装local-ai","children":[]},{"level":3,"title":"问题处理","slug":"问题处理","link":"#问题处理","children":[]}]},{"level":2,"title":"安装k8sGPT","slug":"安装k8sgpt","link":"#安装k8sgpt","children":[{"level":3,"title":"部署k8sGPT resource","slug":"部署k8sgpt-resource","link":"#部署k8sgpt-resource","children":[]},{"level":3,"title":"查看results","slug":"查看results","link":"#查看results","children":[]}]}],"git":{"createdTime":1690280522000,"updatedTime":1728306218000,"contributors":[{"name":"lizili","email":"cn.zili.lee@outlook.com","commits":1}]},"readingTime":{"minutes":1.48,"words":443},"filePathRelative":"cloud-native/kubernetes/k8sGPT.md","localizedDate":"2023年7月25日","excerpt":"\\n<blockquote>\\n<p>扫描 Kubernetes 集群、诊断和分类问题的工具,通过 AI 进行的问题诊断。</p>\\n</blockquote>\\n<h2>local ai部署</h2>\\n<p>如果openai可以用的话，可以不安装</p>\\n<p><a href=\\"https://github.com/go-skynet/LocalAI#run-localai-in-kubernetes\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">官方 run-localai-in-kubernetes</a></p>\\n<h3>添加helm repo</h3>","autoDesc":true}`);export{g as comp,b as data};

import{_ as s,c as a,o as n,f as i}from"./app-BfCDUtKQ.js";const l="/assets/2023-12-26-15-44-13-Bes39PXv.png",e="/assets/2023-12-28-11-01-53-8E9sai9v.png",r={},o=i('<h1 id="" tabindex="-1"><a class="header-anchor" href="#"><span></span></a></h1><h2 id="安装" tabindex="-1"><a class="header-anchor" href="#安装"><span>安装</span></a></h2><blockquote><p>runner 的安装，在打开runner界面时，即可查看相关的手册</p></blockquote><figure><img src="'+l+`" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="在k8s中安装" tabindex="-1"><a class="header-anchor" href="#在k8s中安装"><span>在K8S中安装</span></a></h3><p>仓库添加</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">helm</span><span style="color:#98C379;--shiki-dark:#98C379;"> repo</span><span style="color:#98C379;--shiki-dark:#98C379;"> add</span><span style="color:#98C379;--shiki-dark:#98C379;"> gitlab</span><span style="color:#98C379;--shiki-dark:#98C379;"> https://charts.gitlab.io</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 查询对应的版本</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">helm</span><span style="color:#98C379;--shiki-dark:#98C379;"> search</span><span style="color:#98C379;--shiki-dark:#98C379;"> repo</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> -l</span><span style="color:#98C379;--shiki-dark:#98C379;"> gitlab/gitlab-runner</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">     </span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 找gitlab版本 对应的版本号</span></span>
<span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">helm</span><span style="color:#98C379;--shiki-dark:#98C379;"> pull</span><span style="color:#98C379;--shiki-dark:#98C379;"> gitlab/gitlab-runner</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --version=0.39.1</span></span></code></pre></div><p>配置</p><div class="language-yaml line-numbers-mode" data-ext="yaml" data-title="yaml"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 镜像用和自己git版本匹配的</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">image</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">gitlab/gitlab-runner:alpine-v14.10.1</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">imagePullPolicy</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">IfNotPresent</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">replicas</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">gitlabUrl</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">http://gitlab.zili.work:8888/</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 这个token 来自 runner界面，如果使用runnerToken 则副本数只能为1</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">runnerRegistrationToken</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;p1fDzwhHbyGeK4XSz7RM&quot;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">terminationGracePeriodSeconds</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#D19A66;--shiki-dark:#D19A66;">3600</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">concurrent</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#D19A66;--shiki-dark:#D19A66;">20</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">checkInterval</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#D19A66;--shiki-dark:#D19A66;">30</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">sessionServer</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  enabled</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#D19A66;--shiki-dark:#D19A66;">false</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">rbac</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  create</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#D19A66;--shiki-dark:#D19A66;">true</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  resources</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: [</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;pods&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;pods/exec&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;pods/attach&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;secrets&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;configmaps&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  verbs</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: [</span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;get&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;list&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;watch&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;create&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;patch&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;delete&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">, </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;update&quot;</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  rules</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: []</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  clusterWideAccess</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#D19A66;--shiki-dark:#D19A66;">true</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  podSecurityPolicy</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    enabled</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#D19A66;--shiki-dark:#D19A66;">false</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">    resourceNames</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">    - </span><span style="color:#98C379;--shiki-dark:#98C379;">gitlab-runner</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">metrics</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  enabled</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#D19A66;--shiki-dark:#D19A66;">false</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">service</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  enabled</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#D19A66;--shiki-dark:#D19A66;">false</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  type</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">ClusterIP</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">runners</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 缓存 https://docs.gitlab.com/runner/install/kubernetes.html#s3</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  config</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#C678DD;--shiki-dark:#C678DD;">|</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">    [[runners]]</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">      [runners.kubernetes]</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        privileged = true</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        namespace = &quot;{{.Release.Namespace}}&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        image = &quot;ubuntu:16.04&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">      [runners.cache]</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        Type = &quot;s3&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        Path = &quot;caches&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        Shared = true</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">        [runners.cache.s3]</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">          ServerAddress = &quot;minio.middleware.svc.cluster.local:9000&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">          BucketName = &quot;gitlab-runner&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">          Insecure = true</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">          AccessKey = &quot;admin&quot;</span></span>
<span class="line"><span style="color:#98C379;--shiki-dark:#98C379;">          SecretKey = &quot;Password@0101&quot;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  executor</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">kubernetes</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  tags</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;Kubernetes,K8S&quot;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  cloneUrl</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#98C379;--shiki-dark:#98C379;">&quot;http://gitlab.zili.work:8888/&quot;</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">securityContext</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  runAsUser</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#D19A66;--shiki-dark:#D19A66;">100</span></span>
<span class="line"><span style="color:#E06C75;--shiki-dark:#E06C75;">  fsGroup</span><span style="color:#ABB2BF;--shiki-dark:#ABB2BF;">: </span><span style="color:#D19A66;--shiki-dark:#D19A66;">65533</span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>安装</p><div class="language-shell" data-ext="shell" data-title="shell"><pre class="shiki shiki-themes one-dark-pro one-dark-pro vp-code" style="background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;--shiki-dark:#61AFEF;">helm</span><span style="color:#98C379;--shiki-dark:#98C379;"> upgrade</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --install</span><span style="color:#98C379;--shiki-dark:#98C379;"> gitlab-runner</span><span style="color:#98C379;--shiki-dark:#98C379;"> .</span><span style="color:#D19A66;--shiki-dark:#D19A66;">  -n</span><span style="color:#98C379;--shiki-dark:#98C379;"> gitlab-runner</span><span style="color:#D19A66;--shiki-dark:#D19A66;"> --create-namespace</span></span></code></pre></div><p>runner 无法注册</p><figure><img src="`+e+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>检查自己 <code>gitlabUrl</code> 是否配置正确</p>',14),p=[o];function t(c,d){return n(),a("div",null,p)}const B=s(r,[["render",t],["__file","gitlab-runner.html.vue"]]),h=JSON.parse(`{"path":"/ops/GitOps/deploy/tool/gitlab-runner.html","title":"gitlab-runner","lang":"zh-CN","frontmatter":{"article":true,"title":"gitlab-runner","order":11,"category":["云原生","gitops"],"tag":["runner","cicd"],"index":true,"description":"安装 runner 的安装，在打开runner界面时，即可查看相关的手册 在K8S中安装 仓库添加 配置 安装 runner 无法注册 检查自己 gitlabUrl 是否配置正确","head":[["meta",{"property":"og:url","content":"https://docs.lizili.online/ops/GitOps/deploy/tool/gitlab-runner.html"}],["meta",{"property":"og:site_name","content":"lzz's Blog"}],["meta",{"property":"og:title","content":"gitlab-runner"}],["meta",{"property":"og:description","content":"安装 runner 的安装，在打开runner界面时，即可查看相关的手册 在K8S中安装 仓库添加 配置 安装 runner 无法注册 检查自己 gitlabUrl 是否配置正确"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-03-12T03:42:17.000Z"}],["meta",{"property":"article:author","content":"z"}],["meta",{"property":"article:tag","content":"runner"}],["meta",{"property":"article:tag","content":"cicd"}],["meta",{"property":"article:modified_time","content":"2024-03-12T03:42:17.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"gitlab-runner\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-03-12T03:42:17.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"z\\",\\"url\\":\\"https://docs.lizili.online\\"}]}"]]},"headers":[{"level":2,"title":"安装","slug":"安装","link":"#安装","children":[{"level":3,"title":"在K8S中安装","slug":"在k8s中安装","link":"#在k8s中安装","children":[]}]}],"git":{"createdTime":1705285557000,"updatedTime":1710214937000,"contributors":[{"name":"lizili","email":"cn.zili.lee@outlook.com","commits":1}]},"readingTime":{"minutes":0.9,"words":270},"filePathRelative":"ops/GitOps/deploy/tool/gitlab-runner.md","localizedDate":"2024年1月15日","excerpt":"\\n<h2>安装</h2>\\n<blockquote>\\n<p>runner 的安装，在打开runner界面时，即可查看相关的手册</p>\\n</blockquote>\\n<figure><figcaption></figcaption></figure>\\n<h3>在K8S中安装</h3>\\n<p>仓库添加</p>\\n<div class=\\"language-shell\\" data-ext=\\"shell\\" data-title=\\"shell\\"><pre class=\\"shiki shiki-themes one-dark-pro one-dark-pro vp-code\\" style=\\"background-color:#282c34;--shiki-dark-bg:#282c34;color:#abb2bf;--shiki-dark:#abb2bf\\" tabindex=\\"0\\"><code><span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">helm</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> repo</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> add</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> gitlab</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> https://charts.gitlab.io</span></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># 查询对应的版本</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">helm</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> search</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> repo</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> -l</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> gitlab/gitlab-runner</span><span style=\\"color:#ABB2BF;--shiki-dark:#ABB2BF\\">     </span></span>\\n<span class=\\"line\\"><span style=\\"color:#7F848E;font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># 找gitlab版本 对应的版本号</span></span>\\n<span class=\\"line\\"><span style=\\"color:#61AFEF;--shiki-dark:#61AFEF\\">helm</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> pull</span><span style=\\"color:#98C379;--shiki-dark:#98C379\\"> gitlab/gitlab-runner</span><span style=\\"color:#D19A66;--shiki-dark:#D19A66\\"> --version=0.39.1</span></span></code></pre>\\n</div>","autoDesc":true}`);export{B as comp,h as data};
